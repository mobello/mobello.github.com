<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <link rel=stylesheet href="../../code.css" type="text/css"></head><body><pre><span class='linenumber'>   1</span> <span class="COMM">/*
<span class='linenumber'>   2</span>    Copyright (c) 2012 KT Corp.
<span class='linenumber'>   3</span>   
<span class='linenumber'>   4</span>    This program is free software: you can redistribute it and/or modify
<span class='linenumber'>   5</span>    it under the terms of the GNU Lesser General Public License as published by
<span class='linenumber'>   6</span>    the Free Software Foundation, either version 3 of the License, or
<span class='linenumber'>   7</span>    (at your option) any later version.
<span class='linenumber'>   8</span> 
<span class='linenumber'>   9</span>    This program is distributed in the hope that it will be useful,
<span class='linenumber'>  10</span>    but WITHOUT ANY WARRANTY; without even the implied warranty of
<span class='linenumber'>  11</span>    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<span class='linenumber'>  12</span>    GNU Lesser General Public License for more details.
<span class='linenumber'>  13</span> 
<span class='linenumber'>  14</span>    You should have received a copy of the GNU Lesser General Public License
<span class='linenumber'>  15</span>    along with This program.  If not, see &lt;http://www.gnu.org/licenses/>.
<span class='linenumber'>  16</span> */</span><span class="WHIT">
<span class='linenumber'>  17</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">GLOBAL</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  18</span> 
<span class='linenumber'>  19</span> </span><span class="WHIT">  </span><span class="COMM">//Browser agent</span><span class="WHIT">
<span class='linenumber'>  20</span> </span><span class="WHIT">  </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_USERAGENT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  21</span> 
<span class='linenumber'>  22</span> </span><span class="WHIT">      </span><span class="COMM">// Runtime singleton instance</span><span class="WHIT">
<span class='linenumber'>  23</span> </span><span class="WHIT">      </span><span class="NAME">_RT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>  24</span> 
<span class='linenumber'>  25</span> </span><span class="WHIT">      </span><span class="COMM">// Default Mobello Icon path</span><span class="WHIT">
<span class='linenumber'>  26</span> </span><span class="WHIT">      </span><span class="NAME">_ICONPATH</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'lib/resources/tauicon.png'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  27</span> 
<span class='linenumber'>  28</span> </span><span class="WHIT">      </span><span class="COMM">// Default Splash image path</span><span class="WHIT">
<span class='linenumber'>  29</span> </span><span class="WHIT">      </span><span class="NAME">_SPLASHPATH</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'lib/resources/tausplash.png'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  30</span> 
<span class='linenumber'>  31</span> </span><span class="WHIT">      </span><span class="COMM">// Relative path for Applications</span><span class="WHIT">
<span class='linenumber'>  32</span> </span><span class="WHIT">      </span><span class="NAME">_APPSPATH</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'apps/'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  33</span> 
<span class='linenumber'>  34</span> </span><span class="WHIT">      </span><span class="COMM">// Shared folder path</span><span class="WHIT">
<span class='linenumber'>  35</span> </span><span class="WHIT">      </span><span class="NAME">_SHAREDPATH</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'shared/'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  36</span> 
<span class='linenumber'>  37</span> </span><span class="WHIT">      </span><span class="COMM">// Default Runtime configuration</span><span class="WHIT">
<span class='linenumber'>  38</span> </span><span class="WHIT">      </span><span class="NAME">_RTCONFIG</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  39</span> </span><span class="WHIT">        </span><span class="NAME">id</span><span class="WHIT">              </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Mobello_PLATFORM'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">// Platform ID</span><span class="WHIT">
<span class='linenumber'>  40</span> </span><span class="WHIT">        </span><span class="NAME">version</span><span class="WHIT">         </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.VER</span><span class="PUNC">,</span><span class="WHIT">        </span><span class="COMM">// Runtime version</span><span class="WHIT">
<span class='linenumber'>  41</span> </span><span class="WHIT">        </span><span class="NAME">timeout</span><span class="WHIT">         </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">3000</span><span class="PUNC">,</span><span class="WHIT">           </span><span class="COMM">// App timeout in ms (3 secs.)</span><span class="WHIT">
<span class='linenumber'>  42</span> </span><span class="WHIT">        </span><span class="NAME">multiInstance</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">          </span><span class="COMM">// Allows multiple same App instances</span><span class="WHIT">
<span class='linenumber'>  43</span> </span><span class="WHIT">        </span><span class="NAME">gracefulErrors</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">           </span><span class="COMM">// Logs/Throws exceptions (true/false) </span><span class="WHIT">
<span class='linenumber'>  44</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  45</span> 
<span class='linenumber'>  46</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>  47</span>    * Returns header's script URLs
<span class='linenumber'>  48</span>    * @private
<span class='linenumber'>  49</span>    * @returns {array} List of URL strings
<span class='linenumber'>  50</span>    */</span><span class="WHIT">
<span class='linenumber'>  51</span> </span><span class="WHIT">  </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_headerScriptUrls</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  52</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scripts</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  53</span> </span><span class="WHIT">        </span><span class="NAME">urls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  54</span> </span><span class="WHIT">        </span><span class="NAME">head</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">'head'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  55</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">head</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  56</span> </span><span class="WHIT">      </span><span class="NAME">scripts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">head.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">'script'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  57</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scripts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  58</span> </span><span class="WHIT">        </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scripts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">src.indexOf</span><span class="PUNC">(</span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Remove appended parameters</span><span class="WHIT">
<span class='linenumber'>  59</span> </span><span class="WHIT">        </span><span class="NAME">urls.push</span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">scripts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">scripts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">src.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  60</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>  61</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>  62</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">urls</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  63</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>  64</span> 
<span class='linenumber'>  65</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>  66</span>    * Returns a module's full name with its id.
<span class='linenumber'>  67</span>    * @private
<span class='linenumber'>  68</span>    * @param {String} m Module object
<span class='linenumber'>  69</span>    * @returns {String} Full module name
<span class='linenumber'>  70</span>    */</span><span class="WHIT">
<span class='linenumber'>  71</span> </span><span class="WHIT">  </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_appNameId</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  72</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">m</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">m.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' ('</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">m.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Undefined'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  73</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>  74</span> 
<span class='linenumber'>  75</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>  76</span>    * Returns a resolved URL for a relative (application) resource.
<span class='linenumber'>  77</span>    * &lt;p/>
<span class='linenumber'>  78</span>    * Resource path must begin with a "/", "$shared", or be a full URL.
<span class='linenumber'>  79</span>    * @private
<span class='linenumber'>  80</span>    * @param {String} path App-relative path must be '/' prefixed
<span class='linenumber'>  81</span>    * @param {String} appName Application name (optional)
<span class='linenumber'>  82</span>    * @returns {String} Resolved path for the application name 
<span class='linenumber'>  83</span>    */</span><span class="WHIT">
<span class='linenumber'>  84</span> </span><span class="WHIT">  </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_resolvePath</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">appName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  85</span> </span><span class="WHIT">    </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.trim</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  86</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.charAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'/'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  87</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'$dashboard'</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">appName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  88</span> </span><span class="WHIT">      </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">path.substring</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  89</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  90</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appName</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  91</span> </span><span class="WHIT">        </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_APPSPATH</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">appName.trim</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  92</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  93</span> </span><span class="WHIT">        </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'..'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  94</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/^\$shared\//</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  95</span> </span><span class="WHIT">        </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.replace</span><span class="PUNC">(</span><span class="REGX">/^\$shared\//</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_SHAREDPATH</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  96</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="REGX">/^(\w+:)?\/\/\/?/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  97</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Relative resource must begin with "/": '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tau.rt'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  98</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  99</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 100</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 101</span> </span><span class="WHIT">    </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 102</span> </span><span class="WHIT">    </span><span class="NAME">a.href</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 103</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.href</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 104</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 105</span> 
<span class='linenumber'> 106</span> 
<span class='linenumber'> 107</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'> 108</span>    * Runtime API appended to Mobello root namespace
<span class='linenumber'> 109</span>    */</span><span class="WHIT">
<span class='linenumber'> 110</span> </span><span class="WHIT">  </span><span class="NAME">tau.namespace</span><span class="PUNC">(</span><span class="STRN">'tau'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 111</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau */</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 112</span> </span><span class="WHIT">  </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 113</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 114</span>      * Singleton Runtime instance getter.
<span class='linenumber'> 115</span>      * @returns {Object} Singleton {@link tau.rt.Runtime} instance
<span class='linenumber'> 116</span>      */</span><span class="WHIT">
<span class='linenumber'> 117</span> </span><span class="WHIT">    </span><span class="NAME">getRuntime</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 118</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_RT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 119</span> </span><span class="WHIT">        </span><span class="NAME">_RTCONFIG.singleApp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getLauncherParam</span><span class="PUNC">(</span><span class="STRN">'app'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 120</span> </span><span class="WHIT">        </span><span class="NAME">_RTCONFIG.dev</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'true'</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">tau.getLauncherParam</span><span class="PUNC">(</span><span class="STRN">'dev'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 121</span> </span><span class="WHIT">        </span><span class="NAME">_RT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Runtime</span><span class="PUNC">(</span><span class="NAME">_RTCONFIG</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 122</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 123</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_RT</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 124</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 125</span> 
<span class='linenumber'> 126</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 127</span>      * Returns the configuration for the current module.
<span class='linenumber'> 128</span>      * &lt;p/>
<span class='linenumber'> 129</span>      * If a module name is provided, it will attempt to return the the 
<span class='linenumber'> 130</span>      * configuration for the specified name; otherwise, it will return the 
<span class='linenumber'> 131</span>      * currently running module's configuration object.
<span class='linenumber'> 132</span>      * @param {String} name Name of the module for the requested configuration 
<span class='linenumber'> 133</span>      * @returns {Object} A module's configuration object
<span class='linenumber'> 134</span>      */</span><span class="WHIT">
<span class='linenumber'> 135</span> </span><span class="WHIT">    </span><span class="NAME">getConfig</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 136</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getModuleConfig</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 137</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 138</span> 
<span class='linenumber'> 139</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 140</span>      * Returns an Application Context for the current application.
<span class='linenumber'> 141</span>      * @returns {Object} Curren't module's {@link tau.rt.ApplicationContext}
<span class='linenumber'> 142</span>      */</span><span class="WHIT">
<span class='linenumber'> 143</span> </span><span class="WHIT">    </span><span class="NAME">getCurrentContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 144</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">app</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 145</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">app</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.rt.Application</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 146</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.ApplicationContext</span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 147</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 148</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 149</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 150</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 151</span> 
<span class='linenumber'> 152</span> 
<span class='linenumber'> 153</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'> 154</span>    * @name tau.rt
<span class='linenumber'> 155</span>    * @namespace Runtime Module.
<span class='linenumber'> 156</span>    */</span><span class="WHIT">
<span class='linenumber'> 157</span> </span><span class="WHIT">  </span><span class="NAME">tau.namespace</span><span class="PUNC">(</span><span class="STRN">'tau.rt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends tau.rt */</span><span class="WHIT">
<span class='linenumber'> 158</span> </span><span class="WHIT">  </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 159</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 160</span>      * android 여부 
<span class='linenumber'> 161</span>      * @type Boolean 
<span class='linenumber'> 162</span>      */</span><span class="WHIT">
<span class='linenumber'> 163</span> </span><span class="WHIT">    </span><span class="NAME">isAndroid</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/android/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 164</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 165</span>      * android 버전 2 여부
<span class='linenumber'> 166</span>      * @type Boolean 
<span class='linenumber'> 167</span>      */</span><span class="WHIT">
<span class='linenumber'> 168</span> </span><span class="WHIT">    </span><span class="NAME">isAndroidVer2</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/android 2./i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 169</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 170</span>      * ipad 여부
<span class='linenumber'> 171</span>      * @type Boolean 
<span class='linenumber'> 172</span>      */</span><span class="WHIT">
<span class='linenumber'> 173</span> </span><span class="WHIT">    </span><span class="NAME">isIPad</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/ipad/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 174</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 175</span>      * iphone 여부
<span class='linenumber'> 176</span>      * @type Boolean 
<span class='linenumber'> 177</span>      */</span><span class="WHIT">
<span class='linenumber'> 178</span> </span><span class="WHIT">    </span><span class="NAME">isIPhone</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/iphone/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 179</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 180</span>      * webkit browser 여부
<span class='linenumber'> 181</span>      * @type Boolean 
<span class='linenumber'> 182</span>      */</span><span class="WHIT">
<span class='linenumber'> 183</span> </span><span class="WHIT">    </span><span class="NAME">isWebkit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/webkit/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 184</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 185</span>      * chrome browser 여부
<span class='linenumber'> 186</span>      * @type Boolean 
<span class='linenumber'> 187</span>      */</span><span class="WHIT">
<span class='linenumber'> 188</span> </span><span class="WHIT">    </span><span class="NAME">isChrome</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/chrome/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 189</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 190</span>      * safari browser 여부
<span class='linenumber'> 191</span>      * @type Boolean 
<span class='linenumber'> 192</span>      */</span><span class="WHIT">
<span class='linenumber'> 193</span> </span><span class="WHIT">    </span><span class="NAME">isSafari</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/safari/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 194</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 195</span>      * ie browser 여부
<span class='linenumber'> 196</span>      * @type Boolean 
<span class='linenumber'> 197</span>      */</span><span class="WHIT">
<span class='linenumber'> 198</span> </span><span class="WHIT">    </span><span class="NAME">isIE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/msie/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 199</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 200</span>      * orientationchange 지원여부
<span class='linenumber'> 201</span>      * @type Boolean 
<span class='linenumber'> 202</span>      */</span><span class="WHIT">
<span class='linenumber'> 203</span> </span><span class="WHIT">    </span><span class="NAME">hasOrientationChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'onorientationchange'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">GLOBAL</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 204</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 205</span>      * touch 지원여부
<span class='linenumber'> 206</span>      * @type Boolean 
<span class='linenumber'> 207</span>      */</span><span class="WHIT">
<span class='linenumber'> 208</span> </span><span class="WHIT">    </span><span class="NAME">hasTouch</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'ontouchstart'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">GLOBAL</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="REGX">/chrome/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">_USERAGENT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 209</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'> 210</span>      * 3D 지원여부
<span class='linenumber'> 211</span>      * @type Boolean 
<span class='linenumber'> 212</span>      */</span><span class="WHIT">
<span class='linenumber'> 213</span> </span><span class="WHIT">    </span><span class="NAME">has3D</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'WebKitCSSMatrix'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">GLOBAL</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="STRN">'m11'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">WebKitCSSMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 214</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 215</span> 
<span class='linenumber'> 216</span> 
<span class='linenumber'> 217</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Event */</span><span class="WHIT">
<span class='linenumber'> 218</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Event'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//$ tau.rt.Event</span><span class="WHIT">
<span class='linenumber'> 219</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="COMM">/** @lends tau.rt.Event */</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 220</span> </span><span class="WHIT">      </span><span class="COMM">/** 탭 이벤트 타입. 화면을 터치한 상태에서 움직이지 않고 뗄 경우 발생 */</span><span class="WHIT">
<span class='linenumber'> 221</span> </span><span class="WHIT">      </span><span class="NAME">TAP</span><span class="WHIT">           </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tap'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 222</span> </span><span class="WHIT">      </span><span class="COMM">/** 터치 시작 이벤트. 화면에 터치되는 순간 발생 */</span><span class="WHIT">
<span class='linenumber'> 223</span> </span><span class="WHIT">      </span><span class="NAME">TOUCHSTART</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'touchstart'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 224</span> </span><span class="WHIT">      </span><span class="COMM">/** 터치 이동 이벤트. 화면에 터치한 상태에서 떼지않고 이동할 경우 발생 */</span><span class="WHIT">
<span class='linenumber'> 225</span> </span><span class="WHIT">      </span><span class="NAME">TOUCHMOVE</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'touchmove'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 226</span> </span><span class="WHIT">      </span><span class="COMM">/** 터치 종료 이벤트. 터치한 다음 화면에서 뗄 경우 발생 */</span><span class="WHIT">
<span class='linenumber'> 227</span> </span><span class="WHIT">      </span><span class="NAME">TOUCHEND</span><span class="WHIT">      </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'touchend'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 228</span> </span><span class="WHIT">      </span><span class="COMM">/** 
<span class='linenumber'> 229</span>        * 터치 취소 이벤트. Runtime에서 발생하는 이벤트이며 시스템 처리를 위해
<span class='linenumber'> 230</span>        * 사용자 이벤트를 취소시키고자 할 경우 발생
<span class='linenumber'> 231</span>        */</span><span class="WHIT">
<span class='linenumber'> 232</span> </span><span class="WHIT">      </span><span class="NAME">TOUCHCANCEL</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'touchcancel'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 233</span> </span><span class="WHIT">      </span><span class="COMM">/** Gesture 시작 */</span><span class="WHIT">
<span class='linenumber'> 234</span> </span><span class="WHIT">      </span><span class="NAME">GESTURESTART</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'gesturestart'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 235</span> </span><span class="WHIT">      </span><span class="COMM">/** Gesture 이동 */</span><span class="WHIT">
<span class='linenumber'> 236</span> </span><span class="WHIT">      </span><span class="NAME">GESTUREMOVE</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'gesturechange'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 237</span> </span><span class="WHIT">      </span><span class="COMM">/** Gesture 종료 */</span><span class="WHIT">
<span class='linenumber'> 238</span> </span><span class="WHIT">      </span><span class="NAME">GESTUREEND</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'gestureend'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 239</span> </span><span class="WHIT">      </span><span class="COMM">/** css3 transition이 종료된 후 발생 */</span><span class="WHIT">
<span class='linenumber'> 240</span> </span><span class="WHIT">      </span><span class="NAME">TRANSITIONEND</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'webkitTransitionEnd'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 241</span> 
<span class='linenumber'> 242</span> </span><span class="WHIT">      </span><span class="COMM">/** Component가 Container에 추가되면 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 243</span> </span><span class="WHIT">      </span><span class="NAME">COMPADDED</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'compadded'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 244</span> </span><span class="WHIT">      </span><span class="COMM">/** Component가 Container에 제거되면 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 245</span> </span><span class="WHIT">      </span><span class="NAME">COMPREMOVED</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'compremoved'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 246</span> </span><span class="WHIT">      </span><span class="COMM">/** Component가 draw된 후 발생되는 이벤트 */</span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'> 247</span> </span><span class="WHIT">      </span><span class="NAME">COMPDRAWN</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'compdrawn'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 248</span> </span><span class="WHIT">      </span><span class="COMM">/** Component의 root DOM element가 DOM tree에서 삭제된 후 발생되는 이벤트 */</span><span class="WHIT">            </span><span class="WHIT">
<span class='linenumber'> 249</span> </span><span class="WHIT">      </span><span class="NAME">COMPCLEAR</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'compcleared'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 250</span> 
<span class='linenumber'> 251</span> </span><span class="WHIT">      </span><span class="COMM">/** Scene이 로딩된 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 252</span> </span><span class="WHIT">      </span><span class="NAME">SCENELOADED</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'sceneloaded'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 253</span> </span><span class="WHIT">      </span><span class="COMM">/** Scene이 그려진 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 254</span> </span><span class="WHIT">      </span><span class="NAME">SCENEDRAWN</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'scenedrawn'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 255</span> </span><span class="WHIT">      </span><span class="COMM">/** 값이 변경된 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 256</span> </span><span class="WHIT">      </span><span class="NAME">VALUECHANGE</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'valueChange'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 257</span> </span><span class="WHIT">      </span><span class="COMM">/** 사용자 선택이 변경된 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 258</span> </span><span class="WHIT">      </span><span class="NAME">SELECTCHANGE</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'selectChange'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 259</span> </span><span class="WHIT">      </span><span class="COMM">/** Orientation 변경 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 260</span> </span><span class="WHIT">      </span><span class="NAME">ORIENTATION</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'orientationchange'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 261</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'> 262</span> </span><span class="WHIT">      </span><span class="COMM">/** Ajax 요청이 전송된 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 263</span> </span><span class="WHIT">      </span><span class="NAME">REQ_SENT</span><span class="WHIT">      </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'requestsent'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 264</span> </span><span class="WHIT">      </span><span class="COMM">/** Ajax 결과를 받은 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 265</span> </span><span class="WHIT">      </span><span class="NAME">REQ_RECEIVED</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'requestreceived'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 266</span> </span><span class="WHIT">      </span><span class="COMM">/** Ajax 요청이 취소될 경우 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 267</span> </span><span class="WHIT">      </span><span class="NAME">REQ_ABORTED</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'requestaborted'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 268</span> 
<span class='linenumber'> 269</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 INSTALL시 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 270</span> </span><span class="WHIT">      </span><span class="NAME">RT_INSTALL</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimeinstall'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 271</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 UNINSTALL시 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 272</span> </span><span class="WHIT">      </span><span class="NAME">RT_UNINSTALL</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimeuninstall'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 273</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 특정 앱을 실행 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 274</span> </span><span class="WHIT">      </span><span class="NAME">RT_START</span><span class="WHIT">      </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimestart'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 275</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 특정 앱을 중지할 때 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 276</span> </span><span class="WHIT">      </span><span class="NAME">RT_STOP</span><span class="WHIT">       </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimestop'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 277</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 특정 앱을 시작할 때 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 278</span> </span><span class="WHIT">      </span><span class="NAME">RT_LAUNCH</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimelaunch'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 279</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 Runtime이 종료될 때 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 280</span> </span><span class="WHIT">      </span><span class="NAME">RT_TERMINATE</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimeterminate'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 281</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 설치과정을 종료한 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 282</span> </span><span class="WHIT">      </span><span class="NAME">RT_INSTALLED</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimeinstalled'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 283</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 UNINSTALL과정을 종료한 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 284</span> </span><span class="WHIT">      </span><span class="NAME">RT_UNINSTALLED</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimeuninstalled'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 285</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 theme이 load된 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 286</span> </span><span class="WHIT">      </span><span class="NAME">RT_THEME_LOADED</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimethemeloaded'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 287</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime Lifecycle에서 theme이 load가 되고 사용가능하게 된 직후 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 288</span> </span><span class="WHIT">      </span><span class="NAME">RT_THEME_ENABLED</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'runtimethemeenabled'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 289</span> </span><span class="WHIT">      </span><span class="COMM">/** Runtime에서 모듈(Module)이 foreground background로 변경될 때 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 290</span> </span><span class="WHIT">      </span><span class="NAME">RT_APP_CHANGE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'appchange'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 291</span> </span><span class="WHIT">      </span><span class="COMM">/** Controller가 foreground 또는 background로 변경될 때 발생되는 이벤트 */</span><span class="WHIT">
<span class='linenumber'> 292</span> </span><span class="WHIT">      </span><span class="NAME">RT_CTRL_CHANGE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'controllerchange'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 293</span> </span><span class="WHIT">              </span><span class="WHIT">
<span class='linenumber'> 294</span> </span><span class="WHIT">      </span><span class="COMM">/** 이벤트의 단계중 CAPTURING단계를 나타낸다. */</span><span class="WHIT">
<span class='linenumber'> 295</span> </span><span class="WHIT">      </span><span class="NAME">CAPTURING_PHASE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 296</span> </span><span class="WHIT">      </span><span class="COMM">/** 이벤트의 단계중 TARGET단계를 나타낸다. */</span><span class="WHIT">
<span class='linenumber'> 297</span> </span><span class="WHIT">      </span><span class="NAME">AT_TARGET</span><span class="WHIT">       </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 298</span> </span><span class="WHIT">      </span><span class="COMM">/** 이벤트의 단계중 BUBBLING단계를 나타낸다. */</span><span class="WHIT">
<span class='linenumber'> 299</span> </span><span class="WHIT">      </span><span class="NAME">BUBBLING_PHASE</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT">
<span class='linenumber'> 300</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 301</span> 
<span class='linenumber'> 302</span> 
<span class='linenumber'> 303</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 304</span>      * @class
<span class='linenumber'> 305</span>      * An Event is the propagating object for fired event.
<span class='linenumber'> 306</span>      * @constructs
<span class='linenumber'> 307</span>      * @param {String} name Event name
<span class='linenumber'> 308</span>      * @param {Object} source Parent {@link tau.rt.EventDelegator} instance
<span class='linenumber'> 309</span>      * @param {Array} touches Every finger currently touching the screen
<span class='linenumber'> 310</span>      * @param {Array} targetTouches Filters touches that started in same node
<span class='linenumber'> 311</span>      * @param {Array} changedTouches Only the touches that initiated the event
<span class='linenumber'> 312</span>      */</span><span class="WHIT">
<span class='linenumber'> 313</span> </span><span class="WHIT">    </span><span class="NAME">Event</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">source</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">targetTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">changedTouches</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 314</span> </span><span class="WHIT">      </span><span class="NAME">this._name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 315</span> </span><span class="WHIT">      </span><span class="NAME">this._source</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">source</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 316</span> </span><span class="WHIT">      </span><span class="NAME">this._alwaysBubble</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 317</span> </span><span class="WHIT">      </span><span class="NAME">this._stopPropagation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 318</span> </span><span class="WHIT">      </span><span class="NAME">this._preventDefault</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 319</span> </span><span class="WHIT">      </span><span class="NAME">this.timeStamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'> 320</span> </span><span class="WHIT">      </span><span class="NAME">this.eventPhase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// NONE, if user created mannually</span><span class="WHIT">
<span class='linenumber'> 321</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'> 322</span> </span><span class="WHIT">      </span><span class="COMM">// Touch Event members</span><span class="WHIT">
<span class='linenumber'> 323</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">touches</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 324</span> </span><span class="WHIT">        </span><span class="NAME">this.touches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 325</span> </span><span class="WHIT">        </span><span class="NAME">this.targetTouches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">targetTouches</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 326</span> </span><span class="WHIT">        </span><span class="NAME">this.changedTouches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">changedTouches</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 327</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 328</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 329</span> 
<span class='linenumber'> 330</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 331</span>      * Returns the event name. 
<span class='linenumber'> 332</span>      * @returns {String} Event Name
<span class='linenumber'> 333</span>      */</span><span class="WHIT">
<span class='linenumber'> 334</span> </span><span class="WHIT">    </span><span class="NAME">getName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 335</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 336</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 337</span> 
<span class='linenumber'> 338</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 339</span>      * Returns the original {@link tau.rt.EventDelegator} from which this 
<span class='linenumber'> 340</span>      * event was created.
<span class='linenumber'> 341</span>      * @returns {Object} EventDelegator object instance
<span class='linenumber'> 342</span>      */</span><span class="WHIT">
<span class='linenumber'> 343</span> </span><span class="WHIT">    </span><span class="NAME">getSource</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 344</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._source</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 345</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 346</span> 
<span class='linenumber'> 347</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 348</span>      * Stops all further event propagation by ignoring all remaining  
<span class='linenumber'> 349</span>      * listener callback functions and bubbling.
<span class='linenumber'> 350</span>      */</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 351</span> </span><span class="WHIT">    </span><span class="NAME">stopPropagation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 352</span> </span><span class="WHIT">      </span><span class="NAME">this._stopPropagation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 353</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 354</span> 
<span class='linenumber'> 355</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 356</span>      * Prevents the propagation from calling the default function.
<span class='linenumber'> 357</span>      */</span><span class="WHIT">
<span class='linenumber'> 358</span> </span><span class="WHIT">    </span><span class="NAME">preventDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 359</span> </span><span class="WHIT">      </span><span class="NAME">this._preventDefault</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 360</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 361</span> 
<span class='linenumber'> 362</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 363</span>      * By default, an event will stop propagating if it was handled by at least 
<span class='linenumber'> 364</span>      * one listener. Setting this option will cause it to continue bubbling
<span class='linenumber'> 365</span>      * even if it was processed.
<span class='linenumber'> 366</span>      * @returns {Boolean} True will cause bubbling to occur on all occasions
<span class='linenumber'> 367</span>      */</span><span class="WHIT">
<span class='linenumber'> 368</span> </span><span class="WHIT">    </span><span class="NAME">alwaysBubble</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 369</span> </span><span class="WHIT">      </span><span class="NAME">this._alwaysBubble</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 370</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 371</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 372</span> 
<span class='linenumber'> 373</span> 
<span class='linenumber'> 374</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.EventPublisher */</span><span class="WHIT">
<span class='linenumber'> 375</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.EventPublisher'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 376</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 377</span>      * @class
<span class='linenumber'> 378</span>      * EventPublisher is used to bind an interesting moment with a single, or 
<span class='linenumber'> 379</span>      * multiple, subroutine(s). Its main purpose is to maintain these functions as
<span class='linenumber'> 380</span>      * listeners to be called back when that interesting moment occurs.
<span class='linenumber'> 381</span>      * &lt;p/>
<span class='linenumber'> 382</span>      * It also manages the state, default behavior, and interruption handling  
<span class='linenumber'> 383</span>      * during event propagation. For example, a user may force an event to stop 
<span class='linenumber'> 384</span>      * propagating by calling the &lt;code>stopPropagation&lt;/code> function.
<span class='linenumber'> 385</span>      * &lt;p/> 
<span class='linenumber'> 386</span>      * An interesting moment is defined by a unique name within an object of type
<span class='linenumber'> 387</span>      * {@link tau.rt.EventDelegator}. Therefore, no two identical event name
<span class='linenumber'> 388</span>      * may exist for an EventDelegator.
<span class='linenumber'> 389</span>      * @constructs
<span class='linenumber'> 390</span>      * @param {String} name Event name
<span class='linenumber'> 391</span>      * @param {Object} source Parent {@link tau.rt.EventDelegator} instance
<span class='linenumber'> 392</span>      * @param {Object} opts Event Options
<span class='linenumber'> 393</span>      * @throws {Error} Name/source parameters must be valid
<span class='linenumber'> 394</span>      */</span><span class="WHIT">
<span class='linenumber'> 395</span> </span><span class="WHIT">    </span><span class="NAME">EventPublisher</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">source</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 396</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 397</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"tau.rt.EventPublisher: invalid parameters."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 398</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 399</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Event name */</span><span class="WHIT">
<span class='linenumber'> 400</span> </span><span class="WHIT">      </span><span class="NAME">this._name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 401</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Source EventDelegator from which the event ware fired */</span><span class="WHIT">
<span class='linenumber'> 402</span> </span><span class="WHIT">      </span><span class="NAME">this._source</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">source</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 403</span> 
<span class='linenumber'> 404</span> </span><span class="WHIT">      </span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 405</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 406</span> 
<span class='linenumber'> 407</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 408</span>      * Initializes/resets the Event.
<span class='linenumber'> 409</span>      * &lt;p/>
<span class='linenumber'> 410</span>      * Null/Undefined parameter will reset the entier event state.
<span class='linenumber'> 411</span>      * @param {Object} opts Event Options
<span class='linenumber'> 412</span>      * @param {Boolean} keepListeners True will keep all previous listeners
<span class='linenumber'> 413</span>      */</span><span class="WHIT">
<span class='linenumber'> 414</span> </span><span class="WHIT">    </span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">keepListeners</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 415</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Event Options */</span><span class="WHIT">
<span class='linenumber'> 416</span> </span><span class="WHIT">      </span><span class="NAME">this._opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 417</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 418</span>          * The foremost function that is to be called before all other 
<span class='linenumber'> 419</span>          * registered event listeners. In general, initialization/startup code 
<span class='linenumber'> 420</span>          * for a set of event listeners are implemented here.
<span class='linenumber'> 421</span>          * @param {Object} event {@link tau.rt.Event} instance
<span class='linenumber'> 422</span>          * @param {Object} payload Data object to be delivered to the listener
<span class='linenumber'> 423</span>          */</span><span class="WHIT">
<span class='linenumber'> 424</span> </span><span class="WHIT">        </span><span class="NAME">antecedentFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 425</span> 
<span class='linenumber'> 426</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 427</span>          * The final function to be called after all the registered event 
<span class='linenumber'> 428</span>          * listener callbacks have been executed. In general, cleanup 
<span class='linenumber'> 429</span>          * code for a set of event listeners are implemented here.
<span class='linenumber'> 430</span>          * &lt;p/>
<span class='linenumber'> 431</span>          * If only a single static routine is required for a particular event, 
<span class='linenumber'> 432</span>          * this routine should be implemented.
<span class='linenumber'> 433</span>          * @param {Object} event {@link tau.rt.Event} instance
<span class='linenumber'> 434</span>          * @param {Object} payload Data object to be delivered to the listener
<span class='linenumber'> 435</span>          */</span><span class="WHIT">
<span class='linenumber'> 436</span> </span><span class="WHIT">        </span><span class="NAME">defaultFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 437</span> 
<span class='linenumber'> 438</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 439</span>          * This function is called when an event's propagation have been halted 
<span class='linenumber'> 440</span>          * by calling {@link Event.stopPropagation}.
<span class='linenumber'> 441</span>          * @param {Object} event {@link tau.rt.Event} instance
<span class='linenumber'> 442</span>          * @param {Object} payload Payload instance to deliver to event handler
<span class='linenumber'> 443</span>          */</span><span class="WHIT">
<span class='linenumber'> 444</span> </span><span class="WHIT">        </span><span class="NAME">stoppedFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 445</span> 
<span class='linenumber'> 446</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 447</span>          * Disabling &lt;code>alwaysBubble&lt;/code> will prevent any further bubbling 
<span class='linenumber'> 448</span>          * up if an event listener was handled within the EventDelegator.
<span class='linenumber'> 449</span>          */</span><span class="WHIT">
<span class='linenumber'> 450</span> </span><span class="WHIT">        </span><span class="NAME">alwaysBubble</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 451</span> 
<span class='linenumber'> 452</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 453</span>          * Disabling &lt;code>alwaysDefaults&lt;/code> will prevent any calls to
<span class='linenumber'> 454</span>          * &lt;code>antecedentFn&lt;/code> & &lt;code>defaultFn&lt;/code> during bubbling 
<span class='linenumber'> 455</span>          */</span><span class="WHIT">
<span class='linenumber'> 456</span> </span><span class="WHIT">        </span><span class="NAME">alwaysDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 457</span> 
<span class='linenumber'> 458</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 459</span>          * Disabling &lt;code>gracefulErrors&lt;/code> will stop the rest of the event 
<span class='linenumber'> 460</span>          * propagation if an exception occurs within an event listener.
<span class='linenumber'> 461</span>          * @type Boolean
<span class='linenumber'> 462</span>          */</span><span class="WHIT">
<span class='linenumber'> 463</span> </span><span class="WHIT">        </span><span class="NAME">gracefulErrors</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">
<span class='linenumber'> 464</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 465</span> 
<span class='linenumber'> 466</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">keepListeners</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 467</span> </span><span class="WHIT">        </span><span class="COMM">/** @private Registered event callback functions */</span><span class="WHIT">
<span class='linenumber'> 468</span> </span><span class="WHIT">        </span><span class="NAME">this._listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// {$fn: xxx, $contexts: []}</span><span class="WHIT">
<span class='linenumber'> 469</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 470</span> 
<span class='linenumber'> 471</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 472</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 473</span> 
<span class='linenumber'> 474</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 475</span>      * Name defined for this event.
<span class='linenumber'> 476</span>      * @returns {String} Event name
<span class='linenumber'> 477</span>      */</span><span class="WHIT">
<span class='linenumber'> 478</span> </span><span class="WHIT">    </span><span class="NAME">getName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 479</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 480</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 481</span> 
<span class='linenumber'> 482</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 483</span>      * EventDelegator from which this event was originated.
<span class='linenumber'> 484</span>      * @returns {Object} EventDelegator object instance
<span class='linenumber'> 485</span>      */</span><span class="WHIT">
<span class='linenumber'> 486</span> </span><span class="WHIT">    </span><span class="NAME">getSource</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 487</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._source</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 488</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 489</span> 
<span class='linenumber'> 490</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 491</span>      * Returns all registered callback functions.
<span class='linenumber'> 492</span>      * @param {Boolean} capture if true, returns all the listeners that is
<span class='linenumber'> 493</span>      * invoked on capture phase, otherwise bubble up phase. 
<span class='linenumber'> 494</span>      * @returns {Array} Event listening callback functions
<span class='linenumber'> 495</span>      */</span><span class="WHIT">
<span class='linenumber'> 496</span> </span><span class="WHIT">    </span><span class="NAME">getListeners</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">capture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 497</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listeners</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 498</span> </span><span class="WHIT">          </span><span class="NAME">results</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 499</span> </span><span class="WHIT">          </span><span class="NAME">phase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">capture</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 500</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listeners.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 501</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">listeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">$fn.capture</span><span class="WHIT"> </span><span class="PUNC">&</span><span class="WHIT"> </span><span class="NAME">phase</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">phase</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// BIT-AND operation</span><span class="WHIT">
<span class='linenumber'> 502</span> </span><span class="WHIT">          </span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">listeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 503</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 504</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 505</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">results</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 506</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 507</span> 
<span class='linenumber'> 508</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 509</span>      * Executes the callback functions for all listeners on the Event.
<span class='linenumber'> 510</span>      * &lt;p/>
<span class='linenumber'> 511</span>      * Calling {@link Event.stopPropagation} at any time during event 
<span class='linenumber'> 512</span>      * propagation will immediately call the EventPublisher's stoppedFn 
<span class='linenumber'> 513</span>      * function; subsequently, it will interrupt, and stop, the rest of event 
<span class='linenumber'> 514</span>      * propagation.
<span class='linenumber'> 515</span>      * &lt;p/>
<span class='linenumber'> 516</span>      * Additionally, calling {@link Event.preventDefault} will prevent the 
<span class='linenumber'> 517</span>      * EventPublisher's defaultFn from being called.
<span class='linenumber'> 518</span>      * @param {Object} payload Data object to be delivered to the listener
<span class='linenumber'> 519</span>      * @return {Number} Number of event listeners called 
<span class='linenumber'> 520</span>      */</span><span class="WHIT">
<span class='linenumber'> 521</span> </span><span class="WHIT">    </span><span class="NAME">notifyListeners</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 522</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ctxs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">listeners</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 523</span> </span><span class="WHIT">          </span><span class="NAME">phase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.eventPhase</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 524</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'> 525</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">phase</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.AT_TARGET</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// retrieve both phase listeners</span><span class="WHIT">
<span class='linenumber'> 526</span> </span><span class="WHIT">        </span><span class="NAME">listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getListeners</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 527</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">add</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getListeners</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 528</span> </span><span class="WHIT">        </span><span class="NAME">listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listeners.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">listeners.concat</span><span class="PUNC">(</span><span class="NAME">add</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">add</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 529</span> </span><span class="WHIT">        </span><span class="NAME">add</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 530</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 531</span> </span><span class="WHIT">        </span><span class="NAME">listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getListeners</span><span class="PUNC">(</span><span class="NAME">phase</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.CAPTURING_PHASE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 532</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 533</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">phase</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.BUBBLING_PHASE</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._opts.alwaysDefault</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 534</span> </span><span class="WHIT">        </span><span class="COMM">// antecedentFn is invoked on capture and target phase</span><span class="WHIT">
<span class='linenumber'> 535</span> </span><span class="WHIT">        </span><span class="NAME">this._opts.antecedentFn.apply</span><span class="PUNC">(</span><span class="NAME">this._source</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 536</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 537</span> </span><span class="WHIT">      </span><span class="COMM">// Execute callback functions for all listeners</span><span class="WHIT">
<span class='linenumber'> 538</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listeners.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 539</span> </span><span class="WHIT">        </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 540</span> </span><span class="WHIT">          </span><span class="NAME">ctxs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">$contexts</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 541</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ctxlen</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ctxs.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ctxlen</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 542</span> </span><span class="WHIT">            </span><span class="NAME">listeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">$fn.apply</span><span class="PUNC">(</span><span class="NAME">ctxs</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._source</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 543</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 544</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 545</span> </span><span class="WHIT">          </span><span class="COMM">// If graceful errors is set, log error and continue event callback</span><span class="WHIT">
<span class='linenumber'> 546</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._opts.gracefulErrors</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 547</span> </span><span class="WHIT">            </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Error occured during event listener: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 548</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 549</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex.stack</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// chrome</span><span class="WHIT">
<span class='linenumber'> 550</span> </span><span class="WHIT">              </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="NAME">ex.stack</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 551</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 552</span> </span><span class="WHIT">              </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 553</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 554</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 555</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">finally</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 556</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event._stopPropagation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 557</span> </span><span class="WHIT">            </span><span class="NAME">this._opts.stoppedFn.apply</span><span class="PUNC">(</span><span class="NAME">this._source</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 558</span> </span><span class="WHIT">            </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 559</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 560</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 561</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 562</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 563</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 564</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'> 565</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 566</span>      * 
<span class='linenumber'> 567</span>      */</span><span class="WHIT">
<span class='linenumber'> 568</span> </span><span class="WHIT">    </span><span class="NAME">notifyDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 569</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.getSource</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 570</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">event._preventDefault</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 571</span> </span><span class="WHIT">          </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this._source</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._opts.alwaysDefault</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 572</span> </span><span class="WHIT">        </span><span class="NAME">this._opts.defaultFn.apply</span><span class="PUNC">(</span><span class="NAME">this._source</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 573</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 574</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 575</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'> 576</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 577</span>      * Finds listener internal object using specified &lt;code>callbackFn&lt;/code>
<span class='linenumber'> 578</span>      * function. if not found, rturns &lt;code>null&lt;/code>. The object which will
<span class='linenumber'> 579</span>      * be returned comply with &lt;code>{$fn: xxx, $contexts: []}&lt;/code>
<span class='linenumber'> 580</span>      * @param callbackFn event listener function
<span class='linenumber'> 581</span>      * @returns listener internal object
<span class='linenumber'> 582</span>      */</span><span class="WHIT">
<span class='linenumber'> 583</span> </span><span class="WHIT">    </span><span class="NAME">intern</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 584</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listeners</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 585</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listeners.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 586</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">$fn</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 587</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">listeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 588</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 589</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 590</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 591</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 592</span> 
<span class='linenumber'> 593</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 594</span>      * Attaches an event listener callback function.
<span class='linenumber'> 595</span>      * @param {Function} callbackFn Function to callback when the event occurs 
<span class='linenumber'> 596</span>      * @param {Object} context CallbackFn's 'this' context
<span class='linenumber'> 597</span>      * @param {Boolean} capture indicates event phase, if true then capturing
<span class='linenumber'> 598</span>      * phase other than that bubbling up phase 
<span class='linenumber'> 599</span>      * @returns {Boolean} true if the listener was correctly registered
<span class='linenumber'> 600</span>      */</span><span class="WHIT">
<span class='linenumber'> 601</span> </span><span class="WHIT">    </span><span class="NAME">addListener</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">capture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 602</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 603</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">'Specified event listener is not a function: '</span><span class="WHIT">
<span class='linenumber'> 604</span> </span><span class="WHIT">            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.currentStack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 605</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 606</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">tau.isObject</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 607</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">'Specified event context is not an Object type: '</span><span class="WHIT">
<span class='linenumber'> 608</span> </span><span class="WHIT">            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.currentStack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 609</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 610</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.intern</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 611</span> </span><span class="WHIT">      </span><span class="COMM">// 1(Capture), 2(Bubble), 3 (Both)</span><span class="WHIT">
<span class='linenumber'> 612</span> </span><span class="WHIT">      </span><span class="NAME">callbackFn.capture</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">capture</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// BIT-OR operation</span><span class="WHIT">
<span class='linenumber'> 613</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 614</span> </span><span class="WHIT">        </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="STRN">'$fn'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'$contexts'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 615</span> </span><span class="WHIT">        </span><span class="NAME">this._listeners.push</span><span class="PUNC">(</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 616</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 617</span> </span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 618</span> </span><span class="WHIT">      </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._source</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 619</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listener.$contexts.indexOf</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 620</span> </span><span class="WHIT">        </span><span class="NAME">listener.$contexts.push</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 621</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 622</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 623</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 624</span> 
<span class='linenumber'> 625</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 626</span>      * Remove one, or all, listening callback function(s).
<span class='linenumber'> 627</span>      * &lt;p/>
<span class='linenumber'> 628</span>      * Calling this function without a parameter will remove all listeners.
<span class='linenumber'> 629</span>      * @param {Function} callbackFn Callback function registered to be removed
<span class='linenumber'> 630</span>      * @param {Object} [context] CallbackFn's 'this' context 
<span class='linenumber'> 631</span>      * @returns {Boolean} true if the listener was correctly unregistered
<span class='linenumber'> 632</span>      */</span><span class="WHIT">
<span class='linenumber'> 633</span> </span><span class="WHIT">    </span><span class="NAME">removeListener</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 634</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 635</span> </span><span class="WHIT">        </span><span class="COMM">// Single listener remove</span><span class="WHIT">
<span class='linenumber'> 636</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.intern</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 637</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 638</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listener.$contexts.indexOf</span><span class="PUNC">(</span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._source</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 639</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 640</span> </span><span class="WHIT">            </span><span class="NAME">listener.$contexts.splice</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// remove</span><span class="WHIT">
<span class='linenumber'> 641</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 642</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listener.$contexts.length</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 643</span> </span><span class="WHIT">            </span><span class="NAME">listener.$fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 644</span> </span><span class="WHIT">            </span><span class="NAME">this._listeners.splice</span><span class="PUNC">(</span><span class="NAME">this._listeners.indexOf</span><span class="PUNC">(</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 645</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 646</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 647</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 648</span> </span><span class="WHIT">        </span><span class="COMM">// Remove all listeners & contexts</span><span class="WHIT">
<span class='linenumber'> 649</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._listeners.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 650</span> </span><span class="WHIT">          </span><span class="NAME">this._listeners.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// delete all elements</span><span class="WHIT">
<span class='linenumber'> 651</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 652</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 653</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 654</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 655</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 656</span> 
<span class='linenumber'> 657</span> 
<span class='linenumber'> 658</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.EventDelegator */</span><span class="WHIT">
<span class='linenumber'> 659</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.EventDelegator'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 660</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 661</span> </span><span class="WHIT">      </span><span class="NAME">DOM_CLASS_ID</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tau'</span><span class="WHIT"> </span><span class="COMM">// Defines a EventDelegator for a DOM node</span><span class="WHIT">
<span class='linenumber'> 662</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 663</span> 
<span class='linenumber'> 664</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 665</span>      * @class
<span class='linenumber'> 666</span>      * EventDelegator is a loosely-coupled hub for sending and receiving events
<span class='linenumber'> 667</span>      * as well as wiring bubbling relationships with other EventDelegators.
<span class='linenumber'> 668</span>      * &lt;p/>
<span class='linenumber'> 669</span>      * This class can be extended or augmented to any JavaScript object so that  
<span class='linenumber'> 670</span>      * it may publish, fire, and listen to events.
<span class='linenumber'> 671</span>      * &lt;pre>
<span class='linenumber'> 672</span>      *  tau.augment(tau.example.MyClass, tau.rt.EventDelegator);
<span class='linenumber'> 673</span>      *  
<span class='linenumber'> 674</span>      *  var myClass = new tau.example.MyClass();
<span class='linenumber'> 675</span>      *  myClass.publishEvent("interestingMoment", {
<span class='linenumber'> 676</span>      *    antecedentFn: function () {
<span class='linenumber'> 677</span>      *      this.messageIntro = 'This is an interesting message: ';
<span class='linenumber'> 678</span>      *    },
<span class='linenumber'> 679</span>      *    defaultFn: function () {
<span class='linenumber'> 680</span>      *      alert('Some default message.');
<span class='linenumber'> 681</span>      *    }
<span class='linenumber'> 682</span>      *  });
<span class='linenumber'> 683</span>      *
<span class='linenumber'> 684</span>      *  myClass.onEvent("interestingMoment", function (event, payload) {
<span class='linenumber'> 685</span>      *    // Prints 'This is an interesting message: e = mc^2'
<span class='linenumber'> 686</span>      *    alert(this.messageIntro + payload);
<span class='linenumber'> 687</span>      *  });
<span class='linenumber'> 688</span>      *
<span class='linenumber'> 689</span>      *  myClass.fireEvent("interestingMoment", "e = mc^2");
<span class='linenumber'> 690</span>      *  &lt;/pre>
<span class='linenumber'> 691</span>      * @constructs
<span class='linenumber'> 692</span>      */</span><span class="WHIT">
<span class='linenumber'> 693</span> </span><span class="WHIT">    </span><span class="NAME">EventDelegator</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//$ tau.rt.EventDelegator</span><span class="WHIT">
<span class='linenumber'> 694</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Maps event name to tau.rt.EventPublisher */</span><span class="WHIT">
<span class='linenumber'> 695</span> </span><span class="WHIT">      </span><span class="NAME">this.$publishedEvents</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 696</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Array that manages EventDelegators to bubble up */</span><span class="WHIT">
<span class='linenumber'> 697</span> </span><span class="WHIT">      </span><span class="NAME">this.$bubbleTargets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 698</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 699</span> 
<span class='linenumber'> 700</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 701</span>      * Find an event for a corresponding name.
<span class='linenumber'> 702</span>      * &lt;p/>
<span class='linenumber'> 703</span>      * If an event doesn't exist, one will be created when the 
<span class='linenumber'> 704</span>      * &lt;code>create&lt;/code> flag set as true.
<span class='linenumber'> 705</span>      * @param {String} name Event name
<span class='linenumber'> 706</span>      * @param {Boolean} create True will create the event if it doesn't exist
<span class='linenumber'> 707</span>      * @returns {Object} An event for a corresponding name, or one auto-created
<span class='linenumber'> 708</span>      */</span><span class="WHIT">
<span class='linenumber'> 709</span> </span><span class="WHIT">    </span><span class="NAME">getEventPublisher</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">create</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 710</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$publishedEvents</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 711</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">create</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 712</span> </span><span class="WHIT">        </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.EventPublisher</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 713</span> </span><span class="WHIT">        </span><span class="NAME">this.$publishedEvents</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 714</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 715</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 716</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 717</span> 
<span class='linenumber'> 718</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 719</span>      * Publishes an event to be consumed via a name and a set of options.
<span class='linenumber'> 720</span>      * &lt;p/>
<span class='linenumber'> 721</span>      * Options include a &lt;code>defaultFn&lt;/code>, which is the final function to 
<span class='linenumber'> 722</span>      * be called during an event propagation, and a &lt;code>stoppedFn&lt;/code>,
<span class='linenumber'> 723</span>      * which is called when a propagation is manually halted by the user.
<span class='linenumber'> 724</span>      * @param {String} eventName Event name
<span class='linenumber'> 725</span>      * @param {Object} opts Event Options
<span class='linenumber'> 726</span>      * @returns {Object} Published event object 
<span class='linenumber'> 727</span>      * @see tau.rt.EventDelegator.unsubscribeEvent
<span class='linenumber'> 728</span>      */</span><span class="WHIT">
<span class='linenumber'> 729</span> </span><span class="WHIT">    </span><span class="NAME">publishEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 730</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 731</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getEventPublisher</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 732</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 733</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e.init</span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 734</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 735</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 736</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 737</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 738</span> 
<span class='linenumber'> 739</span> 
<span class='linenumber'> 740</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 741</span>      * Fires an event for the corresponding event name or event object.
<span class='linenumber'> 742</span>      * &lt;p/>
<span class='linenumber'> 743</span>      * Firing an event will execute callback listeners and handle any
<span class='linenumber'> 744</span>      * capturing and further propagation required by the bubble up wiring.
<span class='linenumber'> 745</span>      * @param {String|tau.rt.Event} e Event Name or Event object
<span class='linenumber'> 746</span>      * @param {Object} payload Payload object to be carried during propagation 
<span class='linenumber'> 747</span>      * @param {Number} delay milliseconds before the actual event is fired 
<span class='linenumber'> 748</span>      * @returns {Boolean} True if the event was fired without error
<span class='linenumber'> 749</span>      * @exception {TypeError} if the source object of the event is not the same
<span class='linenumber'> 750</span>      * instance of current object.
<span class='linenumber'> 751</span>      * @see tau.rt.EventDelegator.onEvent
<span class='linenumber'> 752</span>      */</span><span class="WHIT">
<span class='linenumber'> 753</span> </span><span class="WHIT">    </span><span class="NAME">fireEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">delay</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 754</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">that</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 755</span> </span><span class="WHIT">          </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 756</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 757</span> </span><span class="WHIT">        </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">that</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 758</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 759</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'> 760</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e._stopPropagation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 761</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 762</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 763</span> </span><span class="WHIT">      </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">fire</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 764</span> </span><span class="WHIT">        </span><span class="NAME">that._capture</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 765</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_stopPropagation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 766</span> </span><span class="WHIT">          </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">eventPhase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.AT_TARGET</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// 2; target phase</span><span class="WHIT">
<span class='linenumber'> 767</span> </span><span class="WHIT">          </span><span class="NAME">that.propagateEvent.apply</span><span class="PUNC">(</span><span class="NAME">that</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 768</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 769</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 770</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">delay</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">delay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 771</span> </span><span class="WHIT">      </span><span class="PUNC">(</span><span class="NAME">delay</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">fire</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">delay</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">fire</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 772</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 773</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'> 774</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 775</span>      * process capturing phase for the specified event.
<span class='linenumber'> 776</span>      * @param {tau.rt.Event} e Event Object to handle capturing phase
<span class='linenumber'> 777</span>      * @private
<span class='linenumber'> 778</span>      */</span><span class="WHIT">
<span class='linenumber'> 779</span> </span><span class="WHIT">    </span><span class="NAME">_capture</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 780</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">publisher</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.lookupBubbles</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 781</span> </span><span class="WHIT">      </span><span class="NAME">e.eventPhase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.CAPTURING_PHASE</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 782</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'> 783</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path.length</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">e._stopPropagation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 784</span> </span><span class="WHIT">        </span><span class="NAME">publisher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getEventPublisher</span><span class="PUNC">(</span><span class="NAME">e.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 785</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 786</span> </span><span class="WHIT">          </span><span class="NAME">publisher.notifyListeners</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 787</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 788</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 789</span> </span><span class="WHIT">      </span><span class="NAME">path.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 790</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 791</span> 
<span class='linenumber'> 792</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 793</span>      * Propagates an event for the corresponding event name.
<span class='linenumber'> 794</span>      * &lt;p/>
<span class='linenumber'> 795</span>      * An event will execute callback listeners and handle any additional 
<span class='linenumber'> 796</span>      * propagation set up by bubble up wiring.
<span class='linenumber'> 797</span>      * @param {Object} Event instance
<span class='linenumber'> 798</span>      * @param {Object} payload Payload object to be carried during propagation 
<span class='linenumber'> 799</span>      * @returns {Boolean} True if the event was fired without error
<span class='linenumber'> 800</span>      * @see tau.rt.EventDelegator.fireEvent
<span class='linenumber'> 801</span>      */</span><span class="WHIT">
<span class='linenumber'> 802</span> </span><span class="WHIT">    </span><span class="NAME">propagateEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 803</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 804</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 805</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 806</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bubble</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 807</span> </span><span class="WHIT">          </span><span class="NAME">fired</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 808</span> </span><span class="WHIT">          </span><span class="NAME">publisher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getEventPublisher</span><span class="PUNC">(</span><span class="NAME">event.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 809</span> 
<span class='linenumber'> 810</span> </span><span class="WHIT">      </span><span class="COMM">// Fire the antecedent function first, then rest of the event listeners</span><span class="WHIT">
<span class='linenumber'> 811</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 812</span> </span><span class="WHIT">        </span><span class="NAME">fired</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">publisher.notifyListeners.apply</span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 813</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 814</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event.eventPhase</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.BUBBLING_PHASE</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 815</span> </span><span class="WHIT">        </span><span class="NAME">event.eventPhase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.BUBBLING_PHASE</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 816</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 817</span> </span><span class="WHIT">      </span><span class="COMM">// Continue bubbling up if it wasn't stopped or local event wasn't fired</span><span class="WHIT">
<span class='linenumber'> 818</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">event._stopPropagation</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">fired</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">event._alwaysBubble</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 819</span> </span><span class="WHIT">          </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">publisher._opts.alwaysBubble</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 820</span> </span><span class="WHIT">        </span><span class="NAME">bubble</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getBubble</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 821</span> </span><span class="WHIT">        </span><span class="NAME">fired</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">bubble</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">bubble.propagateEvent.apply</span><span class="PUNC">(</span><span class="NAME">bubble</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 822</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 823</span> </span><span class="WHIT">      </span><span class="COMM">// Call final default function if it wasn't prevented</span><span class="WHIT">
<span class='linenumber'> 824</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 825</span> </span><span class="WHIT">        </span><span class="NAME">publisher.notifyDefault.apply</span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 826</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 827</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">fired</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 828</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 829</span> 
<span class='linenumber'> 830</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 831</span>      * Subscribes to an event with a callback function.
<span class='linenumber'> 832</span>      * &lt;p/>
<span class='linenumber'> 833</span>      * The callback function will be called when &lt;code>fireEvent&lt;/code> 
<span class='linenumber'> 834</span>      * is called at a later time.
<span class='linenumber'> 835</span>      * @param {String} eventName Event name
<span class='linenumber'> 836</span>      * @param {Function} callbackFn Callback function to call on an event
<span class='linenumber'> 837</span>      * @param {Object} context CallbackFn's 'this' context
<span class='linenumber'> 838</span>      * @param {Boolean} capture indicates event phase, if true then capturing
<span class='linenumber'> 839</span>      * phase other than that bubbling up phase 
<span class='linenumber'> 840</span>      * @returns {Boolean} True if the event was registered without error
<span class='linenumber'> 841</span>      * @see tau.rt.EventDelegator.fireEvent
<span class='linenumber'> 842</span>      */</span><span class="WHIT">
<span class='linenumber'> 843</span> </span><span class="WHIT">    </span><span class="NAME">onEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">capture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 844</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getEventPublisher</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 845</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 846</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e.addListener</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">capture</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 847</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 848</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 849</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 850</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'> 851</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 852</span>      * Unsubscribes an event for a specific or a callback function.
<span class='linenumber'> 853</span>      * &lt;p/>
<span class='linenumber'> 854</span>      * Providing a &lt;code>callbackFn&lt;/code> parameter will only remove the 
<span class='linenumber'> 855</span>      * provided function reference, if it was registered to the event.
<span class='linenumber'> 856</span>      * &lt;p/>
<span class='linenumber'> 857</span>      * If no callback parameter is provided, it will remove the event and
<span class='linenumber'> 858</span>      * all of its listeners.
<span class='linenumber'> 859</span>      * @param {String} eventName Event Name
<span class='linenumber'> 860</span>      * @param {Function} callbackFn Callback function to remove
<span class='linenumber'> 861</span>      * @param {Object} context CallbackFn's 'this' context
<span class='linenumber'> 862</span>      * @returns {Boolean} True if the event was unregistered without error
<span class='linenumber'> 863</span>      * @see tau.rt.EventDelegator.onEvent
<span class='linenumber'> 864</span>      * @see tau.rt.EventDelegator.publishEvent
<span class='linenumber'> 865</span>      */</span><span class="WHIT">
<span class='linenumber'> 866</span> </span><span class="WHIT">    </span><span class="NAME">unsubscribeEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 867</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getEventPublisher</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 868</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 869</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 870</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e.removeListener</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">    </span><span class="COMM">// Just remove the callback</span><span class="WHIT">
<span class='linenumber'> 871</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 872</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ReferenceError</span><span class="PUNC">(</span><span class="STRN">'Event listener is not specified for the event:'</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 873</span> </span><span class="WHIT">              </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">eventName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.currentStack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 874</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 875</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 876</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.$publishedEvents</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 877</span> </span><span class="WHIT">          </span><span class="NAME">this.$publishedEvents</span><span class="PUNC">[</span><span class="NAME">eventName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">removeListener</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 878</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.$publishedEvents</span><span class="PUNC">[</span><span class="NAME">eventName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 879</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 880</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 881</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 882</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 883</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'> 884</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 885</span>      * returns bubbles target objects on the current object hierarchy 
<span class='linenumber'> 886</span>      * except current instance. if no bubble target is found, returns empty
<span class='linenumber'> 887</span>      * array object.
<span class='linenumber'> 888</span>      * @return {Array} it contains bubbling targets except current object
<span class='linenumber'> 889</span>      */</span><span class="WHIT">
<span class='linenumber'> 890</span> </span><span class="WHIT">    </span><span class="NAME">lookupBubbles</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 891</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">results</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 892</span> </span><span class="WHIT">          </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getBubble</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 893</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 894</span> </span><span class="WHIT">        </span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 895</span> </span><span class="WHIT">        </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target.getBubble</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 896</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 897</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">results</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 898</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 899</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'> 900</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 901</span>      * Returns the bubble target object of this instance. if no bubble target
<span class='linenumber'> 902</span>      * is set, returns null
<span class='linenumber'> 903</span>      * @return {tar.rt.EventDelegator} Bubble target object if set, 
<span class='linenumber'> 904</span>      * otherwise null
<span class='linenumber'> 905</span>      */</span><span class="WHIT">
<span class='linenumber'> 906</span> </span><span class="WHIT">    </span><span class="NAME">getBubble</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 907</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.$bubbleTargets.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.$bubbleTargets</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 908</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 909</span> 
<span class='linenumber'> 910</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 911</span>      * Adds a bubble target to propagate when an even fires.
<span class='linenumber'> 912</span>      * @param {Object} eventDelegator Event Delegator object
<span class='linenumber'> 913</span>      * @returns {Boolean} True if bubble delegator was added without error
<span class='linenumber'> 914</span>      * @see tau.rt.EventDelegator.removeBubble
<span class='linenumber'> 915</span>      */</span><span class="WHIT">
<span class='linenumber'> 916</span> </span><span class="WHIT">    </span><span class="NAME">setBubble</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventDelegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 917</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventDelegator</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.rt.EventDelegator</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'> 918</span> </span><span class="WHIT">          </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">eventDelegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 919</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this.$bubbleTargets</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pushUnique</span><span class="PUNC">(</span><span class="NAME">eventDelegator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 920</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 921</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 922</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 923</span> 
<span class='linenumber'> 924</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 925</span>      * Removes a bubble target.
<span class='linenumber'> 926</span>      * @param {Object} eventDelegator Event Delegator object
<span class='linenumber'> 927</span>      * @returns {Boolean} True if bubble delegator was removed without error
<span class='linenumber'> 928</span>      * @see tau.rt.EventDelegator.setBubble
<span class='linenumber'> 929</span>      */</span><span class="WHIT">
<span class='linenumber'> 930</span> </span><span class="WHIT">    </span><span class="NAME">removeBubble</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventDelegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 931</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventDelegator</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.rt.EventDelegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 932</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this.$bubbleTargets</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="NAME">eventDelegator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 933</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">eventDelegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 934</span> </span><span class="WHIT">        </span><span class="NAME">this.$bubbleTargets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 935</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 936</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 937</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 938</span> 
<span class='linenumber'> 939</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 940</span> 
<span class='linenumber'> 941</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Gesture */</span><span class="WHIT">
<span class='linenumber'> 942</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Gesture'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 943</span> </span><span class="WHIT">    </span><span class="COMM">// Gesture states</span><span class="WHIT">
<span class='linenumber'> 944</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="COMM">/** @lends tau.rt.Gesture */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 945</span> </span><span class="WHIT">      </span><span class="COMM">/** @type Integer */</span><span class="WHIT">
<span class='linenumber'> 946</span> </span><span class="WHIT">      </span><span class="NAME">STATE_STATIC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 947</span> </span><span class="WHIT">      </span><span class="COMM">/** @type Integer */</span><span class="WHIT">
<span class='linenumber'> 948</span> </span><span class="WHIT">      </span><span class="NAME">STATE_START</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 949</span> </span><span class="WHIT">      </span><span class="COMM">/** @type Integer */</span><span class="WHIT">
<span class='linenumber'> 950</span> </span><span class="WHIT">      </span><span class="NAME">STATE_CHANGE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 951</span> </span><span class="WHIT">      </span><span class="COMM">/** @type Integer */</span><span class="WHIT">
<span class='linenumber'> 952</span> </span><span class="WHIT">      </span><span class="NAME">STATE_END</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT">
<span class='linenumber'> 953</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 954</span> 
<span class='linenumber'> 955</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 956</span>      * @class Gesture Prototype
<span class='linenumber'> 957</span>      * @constructs
<span class='linenumber'> 958</span>      */</span><span class="WHIT">
<span class='linenumber'> 959</span> </span><span class="WHIT">    </span><span class="NAME">Gesture</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 960</span> </span><span class="WHIT">      </span><span class="NAME">this.eventMgr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">$eventMgr</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 961</span> </span><span class="WHIT">      </span><span class="NAME">this.state</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.rt.Gesture.STATE_STATIC</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 962</span> </span><span class="WHIT">      </span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'gesture'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 963</span> </span><span class="WHIT">      </span><span class="NAME">this.tsStart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 964</span> </span><span class="WHIT">      </span><span class="NAME">this.tsCurrent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 965</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 966</span> </span><span class="WHIT">    </span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 967</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 968</span> </span><span class="WHIT">    </span><span class="NAME">change</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 969</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 970</span> </span><span class="WHIT">    </span><span class="NAME">end</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 971</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 972</span> </span><span class="WHIT">    </span><span class="NAME">cancel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 973</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 974</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 975</span> 
<span class='linenumber'> 976</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.PinchGesture */</span><span class="WHIT">
<span class='linenumber'> 977</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.PinchGesture'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Gesture</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 978</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 979</span>      * @class PinchGesture class description goes here
<span class='linenumber'> 980</span>      * @constructs
<span class='linenumber'> 981</span>      */</span><span class="WHIT">
<span class='linenumber'> 982</span> </span><span class="WHIT">    </span><span class="NAME">PinchGesture</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 983</span> </span><span class="WHIT">      </span><span class="NAME">this.scale</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 984</span> </span><span class="WHIT">      </span><span class="NAME">this.velocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 985</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 986</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 987</span> 
<span class='linenumber'> 988</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.PanGesture */</span><span class="WHIT">
<span class='linenumber'> 989</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.PanGesture'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Gesture</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 990</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'> 991</span>      * @class PanGesture class description goes here
<span class='linenumber'> 992</span>      * @constructs
<span class='linenumber'> 993</span>      */</span><span class="WHIT">
<span class='linenumber'> 994</span> </span><span class="WHIT">    </span><span class="NAME">PanGesture</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">maxTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">minTouches</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 995</span> </span><span class="WHIT">      </span><span class="NAME">this.maxTouches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">maxTouches</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 996</span> </span><span class="WHIT">      </span><span class="NAME">this.minTouches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">minTouches</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 997</span> </span><span class="WHIT">      </span><span class="NAME">this.translation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0.0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 998</span> </span><span class="WHIT">      </span><span class="NAME">this.velocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 999</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1000</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1001</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>1002</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.RotationGesture */</span><span class="WHIT">
<span class='linenumber'>1003</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.RotationGesture'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Gesture</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1004</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1005</span>      * @class RotationGesture class description goes here
<span class='linenumber'>1006</span>      * @constructs
<span class='linenumber'>1007</span>      */</span><span class="WHIT">
<span class='linenumber'>1008</span> </span><span class="WHIT">    </span><span class="NAME">RotationGesture</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1009</span> </span><span class="WHIT">      </span><span class="NAME">this.rotation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1010</span> </span><span class="WHIT">      </span><span class="NAME">this.velocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1011</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1012</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1013</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>1014</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.LongPressGesture */</span><span class="WHIT">
<span class='linenumber'>1015</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.LongPressGesture'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Gesture</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1016</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1017</span>      * @class RotationGesture class description goes here
<span class='linenumber'>1018</span>      * @constructs
<span class='linenumber'>1019</span>      */</span><span class="WHIT">
<span class='linenumber'>1020</span> </span><span class="WHIT">    </span><span class="NAME">LongPressGesture</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">duration</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">numTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTreshold</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1021</span> </span><span class="WHIT">      </span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'longpress'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1022</span> </span><span class="WHIT">      </span><span class="NAME">this.duration</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">duration</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1023</span> </span><span class="WHIT">      </span><span class="NAME">this.numTouches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">numTouches</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1024</span> </span><span class="WHIT">      </span><span class="NAME">this.moveThreshold</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">moveTreshold</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1025</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1026</span> 
<span class='linenumber'>1027</span> </span><span class="WHIT">    </span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">track</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1028</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">me</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1029</span> </span><span class="WHIT">          </span><span class="NAME">gesturesArr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this.eventMgr._gestures</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1030</span> </span><span class="WHIT">      </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="STRN">' Longpress Gesture Start: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.tsCurrent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1031</span> </span><span class="WHIT">      </span><span class="NAME">gesturesArr.pushUnique</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1032</span> </span><span class="WHIT">      </span><span class="NAME">this.timeoutId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1033</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event._source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1034</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="STRN">'longpress is due, firing event!'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1035</span> </span><span class="WHIT">          </span><span class="NAME">event._source.propagateEvent</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1036</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1037</span> </span><span class="WHIT">        </span><span class="NAME">gesturesArr.remove</span><span class="PUNC">(</span><span class="NAME">me</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1038</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.duration</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1039</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1040</span> 
<span class='linenumber'>1041</span> </span><span class="WHIT">    </span><span class="NAME">change</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">track</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1042</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deltaX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">touch.pageX</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">track.pageX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1043</span> </span><span class="WHIT">          </span><span class="NAME">deltaY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">touch.pageY</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">track.pageY</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1044</span> </span><span class="WHIT">          </span><span class="NAME">absDeltaX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">deltaX</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1045</span> </span><span class="WHIT">          </span><span class="NAME">absDeltaY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">deltaY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1046</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">absDeltaX</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.moveThreshold</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">absDeltaY</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.moveThreshold</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1047</span> </span><span class="WHIT">        </span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.timeoutId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1048</span> </span><span class="WHIT">        </span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this.eventMgr._gestures</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1049</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="STRN">'MOVED touch, canceled'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1050</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1051</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1052</span> 
<span class='linenumber'>1053</span> </span><span class="WHIT">    </span><span class="NAME">end</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">track</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1054</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this.eventMgr._gestures</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1055</span> </span><span class="WHIT">        </span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.timeoutId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1056</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="STRN">'clickedup, ending Longpress callback'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1057</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1058</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1059</span> 
<span class='linenumber'>1060</span> </span><span class="WHIT">    </span><span class="NAME">cancel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">track</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1061</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1062</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1063</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1064</span> 
<span class='linenumber'>1065</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.EventManager */</span><span class="WHIT">
<span class='linenumber'>1066</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.EventManager'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1067</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1068</span>      * @class Prototype Event Manager
<span class='linenumber'>1069</span>      * @constructs
<span class='linenumber'>1070</span>      * @param {Object} opt Event Manager options
<span class='linenumber'>1071</span>      * @param {Object} root Root DOM element from which the Events are listened
<span class='linenumber'>1072</span>      */</span><span class="WHIT">
<span class='linenumber'>1073</span> </span><span class="WHIT">    </span><span class="NAME">EventManager</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//$ tau.rt.EventManager</span><span class="WHIT">
<span class='linenumber'>1074</span> 
<span class='linenumber'>1075</span> </span><span class="WHIT">      </span><span class="NAME">this._opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1076</span> </span><span class="WHIT">        </span><span class="NAME">enabled</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1077</span> </span><span class="WHIT">        </span><span class="NAME">touchMoveThreshold</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">// 5px is ideal</span><span class="WHIT">
<span class='linenumber'>1078</span> </span><span class="WHIT">        </span><span class="NAME">touchEndThreshold</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1079</span> </span><span class="WHIT">        </span><span class="NAME">tapThreshold</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1080</span> </span><span class="WHIT">        </span><span class="NAME">tapHoldInterval</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">250</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1081</span> </span><span class="WHIT">        </span><span class="NAME">tapDoubleThreshold</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">800</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1082</span> </span><span class="WHIT">        </span><span class="NAME">swipeThreshold</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">35</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1083</span> </span><span class="WHIT">        </span><span class="NAME">swipeTime</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1084</span> </span><span class="WHIT">        </span><span class="NAME">scrollThreshold</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1085</span> </span><span class="WHIT">        </span><span class="NAME">scrollResetTime</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="WHIT">
<span class='linenumber'>1086</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1087</span> 
<span class='linenumber'>1088</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Track history map by track ID */</span><span class="WHIT">
<span class='linenumber'>1089</span> </span><span class="WHIT">      </span><span class="NAME">this._history</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1090</span> </span><span class="WHIT">      </span><span class="NAME">this._gestures</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1091</span> </span><span class="WHIT">      </span><span class="NAME">this._timeStamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1092</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1093</span> </span><span class="WHIT">      </span><span class="COMM">/* this is used for preventing mouse move event on PC. There is no
<span class='linenumber'>1094</span>        * need to process mouse move event without mouse button clicking */</span><span class="WHIT">
<span class='linenumber'>1095</span> </span><span class="WHIT">      </span><span class="NAME">this.mousedown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1096</span> 
<span class='linenumber'>1097</span> </span><span class="WHIT">      </span><span class="COMM">// Registration for DOM listeners used by the Mobello Framework</span><span class="WHIT">
<span class='linenumber'>1098</span> </span><span class="WHIT">      </span><span class="COMM">// By default, document is used because it allows events to be handled</span><span class="WHIT">
<span class='linenumber'>1099</span> </span><span class="WHIT">      </span><span class="COMM">// when the mouse is moved outside the browser.</span><span class="WHIT">
<span class='linenumber'>1100</span> </span><span class="WHIT">      </span><span class="NAME">this._root</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//document.getElementById('tau');</span><span class="WHIT">
<span class='linenumber'>1101</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.hasTouch</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1102</span> </span><span class="WHIT">          </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'click,touchstart,touchmove,touchend,touchcancel,orientationchange'</span><span class="WHIT">
<span class='linenumber'>1103</span> </span><span class="WHIT">          </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'click,mousedown,mousemove,mouseup'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1104</span> </span><span class="WHIT">      </span><span class="NAME">this._listenEvents</span><span class="PUNC">(</span><span class="NAME">this._root</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">events.split</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1105</span> 
<span class='linenumber'>1106</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.rt.hasOrientationChange</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">tau.rt.isAndroid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// 'resize' event is special case on PC, Android</span><span class="WHIT">
<span class='linenumber'>1107</span> </span><span class="WHIT">        </span><span class="NAME">this._listenEvents</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'resize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1108</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1109</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1110</span> </span><span class="WHIT">      </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'keyup,keydown,keypress,blur,'</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.TRANSITIONEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1111</span> </span><span class="WHIT">      </span><span class="NAME">this._listenEvents</span><span class="PUNC">(</span><span class="NAME">this._root</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">events.split</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1112</span> 
<span class='linenumber'>1113</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.isAndroid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this._previousOrientation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1114</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1115</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1116</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1117</span>      * registers event listeners for the specified event names(array)
<span class='linenumber'>1118</span>      * @param {Object} from Object(window or DOM) from which listeners listen to
<span class='linenumber'>1119</span>      * @param {Array} names event names to listen to
<span class='linenumber'>1120</span>      * @param {Boolean} capture if true, handles event listeners 
<span class='linenumber'>1121</span>      * on capture phase of DOM event propagation process.
<span class='linenumber'>1122</span>      * @private
<span class='linenumber'>1123</span>      */</span><span class="WHIT">
<span class='linenumber'>1124</span> </span><span class="WHIT">    </span><span class="NAME">_listenEvents</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">from</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">names</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">capture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1125</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">names</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1126</span> </span><span class="WHIT">        </span><span class="NAME">names</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">names</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1127</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1128</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">names.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1129</span> </span><span class="WHIT">        </span><span class="NAME">from.addEventListener</span><span class="PUNC">(</span><span class="NAME">names</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">capture</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1130</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1131</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1132</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1133</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1134</span>      * event handler for the registered event listener. This event handler
<span class='linenumber'>1135</span>      * is a callback method from DOM Event system and handles all the events 
<span class='linenumber'>1136</span>      * registered from constructor
<span class='linenumber'>1137</span>      */</span><span class="WHIT">
<span class='linenumber'>1138</span> </span><span class="WHIT">    </span><span class="NAME">handleEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1139</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._opts.enabled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1140</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1141</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1142</span> </span><span class="WHIT">      </span><span class="COMM">//e.stopPropagation(); // stop propagating events further on</span><span class="WHIT">
<span class='linenumber'>1143</span> </span><span class="WHIT">      </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e.type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1144</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1145</span> </span><span class="WHIT">          </span><span class="NAME">this.mousedown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1146</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'touchstart'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1147</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handleTouchEvent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHSTART</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1148</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'mousemove'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1149</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.mousedown</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1150</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'touchmove'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1151</span> </span><span class="WHIT">          </span><span class="NAME">e.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// disable browser default event handler</span><span class="WHIT">
<span class='linenumber'>1152</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.timeStamp</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._timeStamp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">33</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//more than 30fps</span><span class="WHIT">
<span class='linenumber'>1153</span> </span><span class="WHIT">            </span><span class="NAME">this._timeStamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.timeStamp</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1154</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handleTouchEvent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHMOVE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1155</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1156</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1157</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'mouseup'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1158</span> </span><span class="WHIT">          </span><span class="NAME">this.mousedown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1159</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'touchend'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1160</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handleTouchEvent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1161</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'touchcancel'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1162</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handleTouchEvent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHCANCEL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1163</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'orientationchange'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1164</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'resize'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1165</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domOrientationChange</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1166</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1167</span> </span><span class="WHIT">          </span><span class="NAME">e.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// disable default browser behavior</span><span class="WHIT">
<span class='linenumber'>1168</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1169</span> </span><span class="WHIT">        </span><span class="KEYW">default</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1170</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domGenericEvent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1171</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1172</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1173</span> 
<span class='linenumber'>1174</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1175</span>      * Enable/disable event handling.
<span class='linenumber'>1176</span>      * @param {Boolean} value False will disable event handling
<span class='linenumber'>1177</span>      */</span><span class="WHIT">
<span class='linenumber'>1178</span> </span><span class="WHIT">    </span><span class="NAME">setEnable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1179</span> </span><span class="WHIT">      </span><span class="NAME">this._opts.enabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1180</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1181</span> 
<span class='linenumber'>1182</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1183</span>      * Sets the currently active
<span class='linenumber'>1184</span>      * @param {Object} module 
<span class='linenumber'>1185</span>      */</span><span class="WHIT">
<span class='linenumber'>1186</span> </span><span class="WHIT">    </span><span class="NAME">setActiveModule</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1187</span> </span><span class="WHIT">      </span><span class="NAME">this._activeModule</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1188</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1189</span> 
<span class='linenumber'>1190</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1191</span>      * Iterates up the DOM element's parent hierarchy to find a Tau object
<span class='linenumber'>1192</span>      * ID that houses the element.
<span class='linenumber'>1193</span>      * @param {Object} dom Child DOM element to begin the search
<span class='linenumber'>1194</span>      * @returns {String} If {@link tau.rt.EventDelegator} 
<span class='linenumber'>1195</span>      */</span><span class="WHIT">
<span class='linenumber'>1196</span> </span><span class="WHIT">    </span><span class="NAME">findMobelloObjId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1197</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1198</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1199</span> </span><span class="WHIT">        </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dom.id</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1200</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.util.dom.hasClass</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tau'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'tau-root'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1201</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1202</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1203</span> </span><span class="WHIT">        </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dom.parentElement</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1204</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1205</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1206</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1207</span> 
<span class='linenumber'>1208</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'>1209</span>      * Finds the corresponding {@link tau.rt.EventDelegator} that matches 
<span class='linenumber'>1210</span>      * the given id in the component hiearchy. 
<span class='linenumber'>1211</span>      * @param {Object} parent Parent EventDelegator to begin the hit test
<span class='linenumber'>1212</span>      * @param {String} id Parent EventDelegator to begin the hit test
<span class='linenumber'>1213</span>      * @returns {Object} Any delegator in the hierarchy that matches the id
<span class='linenumber'>1214</span>      */</span><span class="WHIT">
<span class='linenumber'>1215</span> </span><span class="WHIT">    </span><span class="NAME">findDelegator</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">delegator</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1216</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">children</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">id.split</span><span class="PUNC">(</span><span class="NAME">tau.ui.ID_SEPARATOR</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1217</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">delegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1218</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">delegator.getId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">delegator.getId</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1219</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">delegator</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1220</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">delegator.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">_id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1221</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">delegator</span><span class="PUNC">[</span><span class="NAME">_id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1222</span> </span><span class="WHIT">          </span><span class="WHIT">
<span class='linenumber'>1223</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1224</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>1225</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">delegator.getSubDelegators</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1226</span> </span><span class="WHIT">          </span><span class="COMM">// Recursively search children components until hit</span><span class="WHIT">
<span class='linenumber'>1227</span> </span><span class="WHIT">          </span><span class="NAME">children</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">delegator.getSubDelegators</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1228</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">children</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1229</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">children</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1230</span> </span><span class="WHIT">              </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">children.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1231</span> </span><span class="WHIT">                </span><span class="NAME">delegator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findDelegator</span><span class="PUNC">(</span><span class="NAME">children</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1232</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">delegator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1233</span> </span><span class="WHIT">                  </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">delegator</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1234</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1235</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1236</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">children.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">_id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1237</span> </span><span class="WHIT">              </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">children</span><span class="PUNC">[</span><span class="NAME">_id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1238</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1239</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1240</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1241</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1242</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1243</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1244</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1245</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1246</span>      * Hit tests for a Tau object from a given DOM element. 
<span class='linenumber'>1247</span>      * @param {Object} dom DOM element to hit test
<span class='linenumber'>1248</span>      * @returns {Object} Tau component object for the given DOM element
<span class='linenumber'>1249</span>      */</span><span class="WHIT">
<span class='linenumber'>1250</span> </span><span class="WHIT">    </span><span class="NAME">hitTarget</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1251</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">found</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1252</span> </span><span class="WHIT">          </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findMobelloObjId</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1253</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._activeModule</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1254</span> </span><span class="WHIT">          </span><span class="NAME">ctrl</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">module.getRootController</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1255</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'tau-root'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1256</span> </span><span class="WHIT">        </span><span class="NAME">found</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findDelegator</span><span class="PUNC">(</span><span class="NAME">ctrl</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1257</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">found</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">found</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1258</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>1259</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">widgets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getSystemWidgets</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1260</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">widgets.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1261</span> </span><span class="WHIT">          </span><span class="COMM">// if oid exits, searches designated UI Component</span><span class="WHIT">
<span class='linenumber'>1262</span> </span><span class="WHIT">          </span><span class="NAME">found</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findDelegator</span><span class="PUNC">(</span><span class="NAME">widgets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1263</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">found</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">found</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1264</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1265</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1266</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1267</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1268</span> 
<span class='linenumber'>1269</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1270</span>      * Receives a generic DOM event from an element and attempts to delegate it 
<span class='linenumber'>1271</span>      * with a Mobello event to the corresponding {@link tau.rt.EventDelegator}.
<span class='linenumber'>1272</span>      * @param {Object} e DOM event
<span class='linenumber'>1273</span>      * @returns {Boolean} True if the event was fired to a Tau EventDispatcher
<span class='linenumber'>1274</span>      */</span><span class="WHIT">
<span class='linenumber'>1275</span> </span><span class="WHIT">    </span><span class="NAME">domGenericEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1276</span> </span><span class="WHIT">      </span><span class="COMM">// Find the DOM node's Tau ID, then search & fire Tau-native Event</span><span class="WHIT">
<span class='linenumber'>1277</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">$eventMgr.hitTarget</span><span class="PUNC">(</span><span class="NAME">e.target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1278</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">hit</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">hit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// fallback</span><span class="WHIT">
<span class='linenumber'>1279</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">hit.fireEvent</span><span class="PUNC">(</span><span class="NAME">e.type</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e.target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1280</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1281</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1282</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1283</span>      * Receives a generic DOM event from an element and attempts to delegate it 
<span class='linenumber'>1284</span>      * with a Mobello event to the corresponding {@link tau.rt.EventDelegator}.
<span class='linenumber'>1285</span>      * @param {Object} e DOM event
<span class='linenumber'>1286</span>      * @returns {Boolean} True if the event was fired to a Tau EventDispatcher
<span class='linenumber'>1287</span>      */</span><span class="WHIT">
<span class='linenumber'>1288</span> </span><span class="WHIT">    </span><span class="NAME">domOrientationChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1289</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.target</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1290</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">window</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1291</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">orientation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.orientation</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1292</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.isAndroid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1293</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">orientation</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">this._previousOrientation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1294</span> </span><span class="WHIT">            </span><span class="NAME">this._previousOrientation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">orientation</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1295</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1296</span> </span><span class="WHIT">            </span><span class="NAME">e.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1297</span> </span><span class="WHIT">            </span><span class="NAME">e.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1298</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1299</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1300</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1301</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.ORIENTATION</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">orientation</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1302</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1303</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1304</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1305</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1306</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1307</span>      * Callback method, Handles all the event occurred on Mobello framework area
<span class='linenumber'>1308</span>      * @param {Event} e native DOM event
<span class='linenumber'>1309</span>      * @param {String} name event name translated into touch event name
<span class='linenumber'>1310</span>      */</span><span class="WHIT">
<span class='linenumber'>1311</span> </span><span class="WHIT">    </span><span class="NAME">handleTouchEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1312</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">track</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1313</span> </span><span class="WHIT">          </span><span class="NAME">touches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.rt.hasTouch</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">e.changedTouches</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this._mouseTouch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1314</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">touches.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1315</span> </span><span class="WHIT">        </span><span class="NAME">track</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.trackHistory</span><span class="PUNC">(</span><span class="NAME">touches</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1316</span> </span><span class="WHIT">        </span><span class="COMM">//if track is undefined(user hasn't touch the screen),</span><span class="WHIT">
<span class='linenumber'>1317</span> </span><span class="WHIT">        </span><span class="COMM">//no need to generate event in mobile environment</span><span class="WHIT">
<span class='linenumber'>1318</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">track</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1319</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHMOVE</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">track.move</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">track.end</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1320</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// ignore move event if don't meet moving threshold</span><span class="WHIT">
<span class='linenumber'>1321</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1322</span> </span><span class="WHIT">        </span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">track.target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1323</span> </span><span class="WHIT">            </span><span class="NAME">e.targetTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e.changedTouches</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1324</span> </span><span class="WHIT">        </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">track.target</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">track.target</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1325</span> </span><span class="WHIT">        </span><span class="NAME">target.fireEvent</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// no delay</span><span class="WHIT">
<span class='linenumber'>1326</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>1327</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">track.end</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">track.move</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1328</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner No movement meant that a component was Tapped */</span><span class="WHIT">
<span class='linenumber'>1329</span> </span><span class="WHIT">          </span><span class="NAME">target.fireEvent</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.TAP</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1330</span> </span><span class="WHIT">              </span><span class="NAME">track.target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e.targetTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e.changedTouches</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1331</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1332</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1333</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1334</span> 
<span class='linenumber'>1335</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1336</span>      * Tracks a touch point.
<span class='linenumber'>1337</span>      * @param {Object} touch Mobile/Browser TouchPoint
<span class='linenumber'>1338</span>      * @param {Object} e DOM event for the corresponding touch point
<span class='linenumber'>1339</span>      * @returns {Object} Tracked touch object
<span class='linenumber'>1340</span>      */</span><span class="WHIT">
<span class='linenumber'>1341</span> </span><span class="WHIT">    </span><span class="NAME">trackHistory</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1342</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">track</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._history</span><span class="PUNC">[</span><span class="NAME">touch.identifier</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1343</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">track</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1344</span> </span><span class="WHIT">        </span><span class="COMM">// Update current event & touch</span><span class="WHIT">
<span class='linenumber'>1345</span> </span><span class="WHIT">        </span><span class="NAME">track.event</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1346</span> </span><span class="WHIT">        </span><span class="NAME">track.touch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1347</span> </span><span class="WHIT">        </span><span class="NAME">track.end</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHEND</span><span class="WHIT">
<span class='linenumber'>1348</span> </span><span class="WHIT">                    </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHCANCEL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1349</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">track.end</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1350</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._history</span><span class="PUNC">[</span><span class="NAME">touch.identifier</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1351</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1352</span> </span><span class="WHIT">        </span><span class="COMM">// Set touch move flag by comparing its first position to the current</span><span class="WHIT">
<span class='linenumber'>1353</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">track.move</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">track.startPageX</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">touch.pageX</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1354</span> </span><span class="WHIT">                            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">track.startPageY</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">touch.pageY</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1355</span> </span><span class="WHIT">                                </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">this._opts.touchMoveThreshold</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1356</span> </span><span class="WHIT">          </span><span class="NAME">track.move</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1357</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1358</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.TOUCHSTART</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1359</span> </span><span class="WHIT">        </span><span class="COMM">// Start tracking a touch</span><span class="WHIT">
<span class='linenumber'>1360</span> </span><span class="WHIT">        </span><span class="NAME">track</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._history</span><span class="PUNC">[</span><span class="NAME">touch.identifier</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1361</span> </span><span class="WHIT">          </span><span class="NAME">startEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1362</span> </span><span class="WHIT">          </span><span class="NAME">startPageX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">touch.pageX</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1363</span> </span><span class="WHIT">          </span><span class="NAME">startPageY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">touch.pageY</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1364</span> </span><span class="WHIT">          </span><span class="NAME">event</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1365</span> </span><span class="WHIT">          </span><span class="NAME">touch</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1366</span> </span><span class="WHIT">          </span><span class="NAME">target</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.hitTarget</span><span class="PUNC">(</span><span class="NAME">e.target</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">// Find Tau component</span><span class="WHIT">
<span class='linenumber'>1367</span> </span><span class="WHIT">          </span><span class="NAME">move</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1368</span> </span><span class="WHIT">          </span><span class="NAME">end</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">
<span class='linenumber'>1369</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1370</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1371</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">track</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1372</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1373</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1374</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1375</span>      * Creates a Touch object using a generic, none-touch, DOM event.
<span class='linenumber'>1376</span>      * @private
<span class='linenumber'>1377</span>      * @param {Object} e DOM event object
<span class='linenumber'>1378</span>      * @returns {Object} Touch object
<span class='linenumber'>1379</span>      */</span><span class="WHIT">
<span class='linenumber'>1380</span> </span><span class="WHIT">    </span><span class="NAME">_mouseTouch</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1381</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1382</span> </span><span class="WHIT">        </span><span class="NAME">identifier</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'mouse'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1383</span> </span><span class="WHIT">        </span><span class="NAME">clientX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.clientX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">clientY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.clientY</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1384</span> </span><span class="WHIT">        </span><span class="NAME">screenX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.screenX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">screenY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.screenY</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1385</span> </span><span class="WHIT">        </span><span class="NAME">pageX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.pageX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pageY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.pageY</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1386</span> </span><span class="WHIT">        </span><span class="NAME">target</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.target</span><span class="WHIT">
<span class='linenumber'>1387</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1388</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1389</span> 
<span class='linenumber'>1390</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1391</span>      * Logs a DOM event's touch positions.
<span class='linenumber'>1392</span>      * @private
<span class='linenumber'>1393</span>      * @param {Object} e DOM event object
<span class='linenumber'>1394</span>      */</span><span class="WHIT">
<span class='linenumber'>1395</span> </span><span class="WHIT">    </span><span class="NAME">_logTouches</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1396</span> </span><span class="WHIT">      </span><span class="COMM">/** @inner */</span><span class="WHIT">
<span class='linenumber'>1397</span> </span><span class="WHIT">      </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">touchCoords</span><span class="PUNC">(</span><span class="NAME">touches</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1398</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1399</span> </span><span class="WHIT">            </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1400</span> </span><span class="WHIT">        </span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="NAME">touches.length</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' ['</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1401</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">touches.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1402</span> </span><span class="WHIT">          </span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="NAME">touches</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">identifier</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1403</span> </span><span class="WHIT">          </span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="STRN">':('</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">pageX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">', '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">touches</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">pageY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1404</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">touches.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1405</span> </span><span class="WHIT">            </span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="STRN">', '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1406</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1407</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1408</span> </span><span class="WHIT">        </span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="STRN">']'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1409</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result.join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1410</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1411</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.hasTouch</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1412</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="NAME">e.type</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">': touches '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">touchCoords</span><span class="PUNC">(</span><span class="NAME">e.touches</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1413</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="NAME">e.type</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">': changedTouches '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">touchCoords</span><span class="PUNC">(</span><span class="NAME">e.changedTouches</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1414</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="NAME">e.type</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">': targetTouches '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">touchCoords</span><span class="PUNC">(</span><span class="NAME">e.targetTouches</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1415</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1416</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="NAME">e.type</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' touches['</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">touchCoords</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1417</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1418</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1419</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1420</span> 
<span class='linenumber'>1421</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Runtime */</span><span class="WHIT">
<span class='linenumber'>1422</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Runtime'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.EventDelegator</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1423</span> 
<span class='linenumber'>1424</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1425</span>      * @class
<span class='linenumber'>1426</span>      * Manages module runtime.
<span class='linenumber'>1427</span>      * &lt;p/>
<span class='linenumber'>1428</span>      * System Events Handled:
<span class='linenumber'>1429</span>      * &lt;pre>
<span class='linenumber'>1430</span>      *  "runtimeinstall" (RT_INSTALL): Register module to runtime
<span class='linenumber'>1431</span>      *  "runtimeuninstall" (RT_UNINSTALL): Remove module from registry
<span class='linenumber'>1432</span>      *  "runtimestart" (RT_START): Execute a module (calls init & loadScene)
<span class='linenumber'>1433</span>      *  "runtimestop" (RT_STOP): Stops a running module
<span class='linenumber'>1434</span>      *  "runtimelaunch" (RT_LAUNCH): Automates install & start
<span class='linenumber'>1435</span>      *  "runtimeterminate" (RT_TERMINATE): Automates stop & uninstall
<span class='linenumber'>1436</span>      * &lt;/pre>
<span class='linenumber'>1437</span>      * @constructs
<span class='linenumber'>1438</span>      * @extends tau.rt.EventDelegator
<span class='linenumber'>1439</span>      * @param {Object} config Runtime configuration
<span class='linenumber'>1440</span>      */</span><span class="WHIT">
<span class='linenumber'>1441</span> </span><span class="WHIT">    </span><span class="NAME">Runtime</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//$ tau.rt.Runtime</span><span class="WHIT">
<span class='linenumber'>1442</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_RT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1443</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Runtime: Only one runtime instance may exist!'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1444</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1445</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Maps module name to a configuration */</span><span class="WHIT">
<span class='linenumber'>1446</span> </span><span class="WHIT">      </span><span class="NAME">this._registry</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1447</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Module active stack */</span><span class="WHIT">
<span class='linenumber'>1448</span> </span><span class="WHIT">      </span><span class="NAME">this._stack</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1449</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Runtime config */</span><span class="WHIT">
<span class='linenumber'>1450</span> </span><span class="WHIT">      </span><span class="NAME">this._config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1451</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Runtime queue, handled via execute() */</span><span class="WHIT">
<span class='linenumber'>1452</span> </span><span class="WHIT">      </span><span class="COMM">//this.$queue = new tau.JobQueue();</span><span class="WHIT">
<span class='linenumber'>1453</span> </span><span class="WHIT">      </span><span class="COMM">/** @private supported themes */</span><span class="WHIT">
<span class='linenumber'>1454</span> </span><span class="WHIT">      </span><span class="NAME">this.$themeMgr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.ThemeManager</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1455</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1456</span> </span><span class="WHIT">      </span><span class="NAME">this.$widgets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1457</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1458</span> </span><span class="WHIT">      </span><span class="NAME">this.$userapps</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// application names loaded from cookie value</span><span class="WHIT">
<span class='linenumber'>1459</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1460</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Runtime DOM element references */</span><span class="WHIT">
<span class='linenumber'>1461</span> </span><span class="WHIT">      </span><span class="NAME">this.$dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1462</span> </span><span class="WHIT">        </span><span class="NAME">head</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">'head'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1463</span> </span><span class="WHIT">        </span><span class="NAME">root</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="COMM">// Root runtime DOM element</span><span class="WHIT">
<span class='linenumber'>1464</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1465</span> </span><span class="WHIT">      </span><span class="NAME">this.$dom.root.setAttribute</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tau-root'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1466</span> </span><span class="WHIT">      </span><span class="NAME">tau.util.dom.appendChild</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.$dom.root</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1467</span> 
<span class='linenumber'>1468</span> </span><span class="WHIT">      </span><span class="COMM">/** @private  Event Managers handles all System Event processing */</span><span class="WHIT">
<span class='linenumber'>1469</span> </span><span class="WHIT">      </span><span class="NAME">this.$eventMgr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.EventManager</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1470</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1471</span> </span><span class="WHIT">      </span><span class="COMM">/** @private listen to update event of application cache */</span><span class="WHIT">
<span class='linenumber'>1472</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">GLOBAL.applicationCache</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">GLOBAL.navigator.onLine</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1473</span> </span><span class="WHIT">        </span><span class="NAME">GLOBAL.applicationCache.addEventListener</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>1474</span> </span><span class="WHIT">            </span><span class="STRN">'updateready'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.handleUpdateReady</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1475</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1476</span> 
<span class='linenumber'>1477</span> </span><span class="WHIT">      </span><span class="COMM">// Runtime module event handlers</span><span class="WHIT">
<span class='linenumber'>1478</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bootstrap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">tau.rt.Event.RT_INSTALL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_UNINSTALL</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1479</span> </span><span class="WHIT">                       </span><span class="NAME">tau.rt.Event.RT_START</span><span class="PUNC">,</span><span class="WHIT">   </span><span class="NAME">tau.rt.Event.RT_STOP</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1480</span> </span><span class="WHIT">                       </span><span class="NAME">tau.rt.Event.RT_TERMINATE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_INSTALLED</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1481</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">bootstrap.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1482</span> </span><span class="WHIT">        </span><span class="NAME">this.publishEvent</span><span class="PUNC">(</span><span class="NAME">bootstrap</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">defaultFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.handleBootstrap</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1483</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1484</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>1485</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">tau.rt.Event.TOUCHSTART</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1486</span> </span><span class="WHIT">                    </span><span class="NAME">tau.rt.Event.TOUCHMOVE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1487</span> </span><span class="WHIT">                    </span><span class="NAME">tau.rt.Event.TAP</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1488</span> </span><span class="WHIT">                    </span><span class="NAME">tau.rt.Event.TOUCHEND</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1489</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1490</span> </span><span class="WHIT">        </span><span class="NAME">this.publishEvent</span><span class="PUNC">(</span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1491</span> </span><span class="WHIT">          </span><span class="NAME">antecedentFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.handleCaptureEvent</span><span class="WHIT">
<span class='linenumber'>1492</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1493</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1494</span> </span><span class="WHIT">      </span><span class="COMM">// clipboard for storing DOM of background apps</span><span class="WHIT">
<span class='linenumber'>1495</span> </span><span class="WHIT">      </span><span class="NAME">this.$clipboard</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Clipboard</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1496</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1497</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1498</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1499</span>      * Returns clipboard object. Clipboard object is widely used to save DOM
<span class='linenumber'>1500</span>      * node temporarily which is cut from HTML DOM tree.
<span class='linenumber'>1501</span>      * @returns {tau.rt.Clipboard} Clipboard object
<span class='linenumber'>1502</span>      */</span><span class="WHIT">
<span class='linenumber'>1503</span> </span><span class="WHIT">    </span><span class="NAME">getClipboard</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1504</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.$clipboard</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1505</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1506</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1507</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1508</span>      * need to be concise
<span class='linenumber'>1509</span>      * @param e
<span class='linenumber'>1510</span>      * @param payload
<span class='linenumber'>1511</span>      */</span><span class="WHIT">
<span class='linenumber'>1512</span> </span><span class="WHIT">    </span><span class="NAME">handleBootstrap</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1513</span> </span><span class="WHIT">      </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1514</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_INSTALL</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1515</span> </span><span class="WHIT">          </span><span class="NAME">this.install</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1516</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1517</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_UNINSTALL</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1518</span> </span><span class="WHIT">          </span><span class="NAME">this.uninstall</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1519</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1520</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_START</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1521</span> </span><span class="WHIT">          </span><span class="NAME">this.start</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1522</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1523</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_STOP</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1524</span> </span><span class="WHIT">          </span><span class="NAME">this.stop</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1525</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1526</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_TERMINATE</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1527</span> </span><span class="WHIT">          </span><span class="NAME">this.terminate</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1528</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1529</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1530</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1531</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1532</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1533</span>      * handles default runtime events; fallback events
<span class='linenumber'>1534</span>      * @override
<span class='linenumber'>1535</span>      */</span><span class="WHIT">
<span class='linenumber'>1536</span> </span><span class="WHIT">    </span><span class="NAME">propagateEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1537</span> </span><span class="WHIT">      </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1538</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.SCENEDRAWN</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1539</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.ORIENTATION</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1540</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.isIPhone</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">// hide URL bar</span><span class="WHIT">
<span class='linenumber'>1541</span> </span><span class="WHIT">            </span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">window.scrollTo</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1542</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.isAndroid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1543</span> </span><span class="WHIT">              </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.documentElement</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1544</span> </span><span class="WHIT">                  </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.outerHeight</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">window.devicePixelRatio</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1545</span> 
<span class='linenumber'>1546</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">elem.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT">  </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1547</span> </span><span class="WHIT">                </span><span class="NAME">elem.style.height</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1548</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1549</span> </span><span class="WHIT">                </span><span class="NAME">elem.style.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1550</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1551</span> </span><span class="WHIT">              </span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">window.scrollTo</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1552</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1553</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1554</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1555</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">e._stopPropagation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// propagates events to system widgets</span><span class="WHIT">
<span class='linenumber'>1556</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">widgets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$widgets</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">widgets.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1557</span> </span><span class="WHIT">            </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1558</span> </span><span class="WHIT">          </span><span class="NAME">widgets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">propagateEvent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1559</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1560</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1561</span> </span><span class="WHIT">      </span><span class="NAME">tau.rt.Runtime.$super.propagateEvent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1562</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1563</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1564</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1565</span>      * Handles capture event. This event handler is registered as antecedentFn
<span class='linenumber'>1566</span>      * when corresponding event is publishing.
<span class='linenumber'>1567</span>      * @param {tau.rt.Event} e Event Object
<span class='linenumber'>1568</span>      * @param {Object} payload object with the event
<span class='linenumber'>1569</span>      */</span><span class="WHIT">
<span class='linenumber'>1570</span> </span><span class="WHIT">    </span><span class="NAME">handleCaptureEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1571</span> </span><span class="WHIT">     </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">publisher</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">widgets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$widgets</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">widgets.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1572</span> </span><span class="WHIT">         </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1573</span> </span><span class="WHIT">       </span><span class="NAME">publisher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">widgets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getEventPublisher</span><span class="PUNC">(</span><span class="NAME">e.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1574</span> </span><span class="WHIT">       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">publisher</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1575</span> </span><span class="WHIT">         </span><span class="NAME">publisher.notifyListeners</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1576</span> </span><span class="WHIT">       </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1577</span> </span><span class="WHIT">     </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1578</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1579</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1580</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1581</span>      * Handles application cache UPDATEREADY event.
<span class='linenumber'>1582</span>      * @param e
<span class='linenumber'>1583</span>      * @param payload
<span class='linenumber'>1584</span>      */</span><span class="WHIT">
<span class='linenumber'>1585</span> </span><span class="WHIT">    </span><span class="NAME">handleUpdateReady</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1586</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">appCache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL.applicationCache</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1587</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCache.status</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">appCache.UPDATEREADY</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1588</span> </span><span class="WHIT">        </span><span class="NAME">appCache.swapCache</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1589</span> </span><span class="WHIT">        </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="STRN">'Application cache is updated!'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1590</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1591</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1592</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1593</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1594</span>      * SystemDock 객체를 반환한다. 만약 현재 생성된 SystemDock객체가 존재하지 않으면
<span class='linenumber'>1595</span>      * 새로운 객체를 생성하여 반환한다.
<span class='linenumber'>1596</span>      * @return {tau.ui.SystemDock} 시스템 객체
<span class='linenumber'>1597</span>      */</span><span class="WHIT">
<span class='linenumber'>1598</span> </span><span class="WHIT">    </span><span class="NAME">getSystemDock</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1599</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">widget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findSystemWidget</span><span class="PUNC">(</span><span class="NAME">tau.ui.SystemDock</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1600</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">widget</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">widget</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1601</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getModuleConfig</span><span class="PUNC">(</span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1602</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.addSystemWidget</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ui.SystemDock</span><span class="PUNC">(</span><span class="NAME">config.systemdock</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1603</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1604</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1605</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1606</span>      * SystemDialog 객체를 반환한다. 만약 현재 생성된 SystemDialog객체가 존재하지 않으면
<span class='linenumber'>1607</span>      * 새로운 객체를 생성하여 반환한다.
<span class='linenumber'>1608</span>      * @return {tau.ui.SystemDialog} 시스템 다이얼로그 객체
<span class='linenumber'>1609</span>      */</span><span class="WHIT">
<span class='linenumber'>1610</span> </span><span class="WHIT">    </span><span class="NAME">getSystemDialog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1611</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">widget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findSystemWidget</span><span class="PUNC">(</span><span class="NAME">tau.ui.SystemDialog</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1612</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">widget</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">widget</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1613</span> 
<span class='linenumber'>1614</span> </span><span class="WHIT">      </span><span class="NAME">widget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ui.SystemDialog</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1615</span> </span><span class="WHIT">      </span><span class="NAME">widget.draw</span><span class="PUNC">(</span><span class="NAME">this.$dom.root</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1616</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.addSystemWidget</span><span class="PUNC">(</span><span class="NAME">widget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1617</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1618</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1619</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1620</span>      * Returns the names of cached applications as an array format
<span class='linenumber'>1621</span>      * @returns {Array} application names which is cached in local storage
<span class='linenumber'>1622</span>      */</span><span class="WHIT">
<span class='linenumber'>1623</span> </span><span class="WHIT">    </span><span class="NAME">getCached</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1624</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cookie</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1625</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.$userapps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1626</span> </span><span class="WHIT">        </span><span class="NAME">cookie</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.util.getCookie</span><span class="PUNC">(</span><span class="STRN">'$userapps'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1627</span> </span><span class="WHIT">        </span><span class="NAME">this.$userapps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cookie</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">tau.parse</span><span class="PUNC">(</span><span class="NAME">cookie</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1628</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1629</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.$userapps</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1630</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1631</span> 
<span class='linenumber'>1632</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1633</span>      * Removes specified application name from cache
<span class='linenumber'>1634</span>      * @param {String} app application name to remove from cache
<span class='linenumber'>1635</span>      */</span><span class="WHIT">
<span class='linenumber'>1636</span> </span><span class="WHIT">    </span><span class="NAME">_uncache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1637</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">apps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getCached</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1638</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">apps.indexOf</span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1639</span> </span><span class="WHIT">        </span><span class="NAME">apps.splice</span><span class="PUNC">(</span><span class="NAME">apps.indexOf</span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1640</span> </span><span class="WHIT">        </span><span class="NAME">tau.util.setCookie</span><span class="PUNC">(</span><span class="STRN">'$userapps'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.stringify</span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">365</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1641</span> </span><span class="WHIT">        </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1642</span> </span><span class="WHIT">          </span><span class="NAME">window.applicationCache.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// async processing</span><span class="WHIT">
<span class='linenumber'>1643</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1644</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>1645</span> </span><span class="WHIT">          </span><span class="STRN">'You need to go online to update application cache(uninstall): '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1646</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1647</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1648</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1649</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1650</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1651</span>      * Caches specified application name to local storage
<span class='linenumber'>1652</span>      * @param {String} app application name 
<span class='linenumber'>1653</span>      */</span><span class="WHIT">
<span class='linenumber'>1654</span> </span><span class="WHIT">    </span><span class="NAME">_cache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1655</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">apps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getCached</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1656</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">apps</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">apps.indexOf</span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1657</span> </span><span class="WHIT">        </span><span class="NAME">apps.push</span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1658</span> </span><span class="WHIT">        </span><span class="NAME">tau.util.setCookie</span><span class="PUNC">(</span><span class="STRN">'$userapps'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.stringify</span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">365</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1659</span> </span><span class="WHIT">        </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1660</span> </span><span class="WHIT">          </span><span class="NAME">window.applicationCache.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// async processing</span><span class="WHIT">
<span class='linenumber'>1661</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1662</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>1663</span> </span><span class="WHIT">            </span><span class="STRN">'You need to go online to update application cache(install): '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1664</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1665</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1666</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1667</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1668</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1669</span>      * Registers a module configurations into the Runtime.
<span class='linenumber'>1670</span>      * &lt;p/>
<span class='linenumber'>1671</span>      * If a module name is provided, it will load and register its configuration
<span class='linenumber'>1672</span>      * from the reserved application file path (appname/config.json). If a
<span class='linenumber'>1673</span>      * name isn't provided, it will attempt to the same for Dashboard. 
<span class='linenumber'>1674</span>      * &lt;p/>
<span class='linenumber'>1675</span>      * A module's configuration is required to be registered to the Runtime
<span class='linenumber'>1676</span>      * The notation of JSON object will be as follow.&lt;/p>
<span class='linenumber'>1677</span>      * {name: 'appname', sys: true|false, autostart: true|false}
<span class='linenumber'>1678</span>      * before it can be started.
<span class='linenumber'>1679</span>      * @param {Object | Array} apps module information to install 
<span class='linenumber'>1680</span>      */</span><span class="WHIT">
<span class='linenumber'>1681</span> </span><span class="WHIT">    </span><span class="NAME">install</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1682</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1683</span> </span><span class="WHIT">      </span><span class="NAME">apps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">apps</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">apps</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1684</span> </span><span class="WHIT">      </span><span class="NAME">this.resolve</span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">confs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1685</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1686</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">confs.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1687</span> </span><span class="WHIT">          </span><span class="NAME">conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">confs</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1688</span> </span><span class="WHIT">          </span><span class="NAME">rt._registry</span><span class="PUNC">[</span><span class="NAME">conf.name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// register conf</span><span class="WHIT">
<span class='linenumber'>1689</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">conf.$mutable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1690</span> </span><span class="WHIT">            </span><span class="NAME">rt._cache</span><span class="PUNC">(</span><span class="NAME">conf.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1691</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1692</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1693</span> </span><span class="WHIT">        </span><span class="PUNC">(</span><span class="NAME">rt.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_INSTALLED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">confs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1694</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rt._registry</span><span class="PUNC">[</span><span class="NAME">apps</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">apps</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">autostart</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1695</span> </span><span class="WHIT">          </span><span class="NAME">rt.start</span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1696</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1697</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1698</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1699</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1700</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1701</span>      * Resolves specified apps to appropriate configuration information
<span class='linenumber'>1702</span>      * @param {Array} apps app names to resolve
<span class='linenumber'>1703</span>      * @param {Function} callbackFn callback function notified when resolving
<span class='linenumber'>1704</span>      *    is finished. It's parameter is array of configurations resolved
<span class='linenumber'>1705</span>      */</span><span class="WHIT">
<span class='linenumber'>1706</span> </span><span class="WHIT">    </span><span class="NAME">resolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1707</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">chain</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1708</span> </span><span class="WHIT">      </span><span class="NAME">GLOBAL.config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">conf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// global wide function</span><span class="WHIT">
<span class='linenumber'>1709</span> </span><span class="WHIT">        </span><span class="NAME">GLOBAL.config.current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// refer to InstallDependency#handleResult</span><span class="WHIT">
<span class='linenumber'>1710</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1711</span> </span><span class="WHIT">      </span><span class="NAME">chain</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.DependencyChain</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1712</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">apps.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1713</span> </span><span class="WHIT">        </span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_resolvePath</span><span class="PUNC">(</span><span class="STRN">'/config.json'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1714</span> </span><span class="WHIT">        </span><span class="NAME">chain.addDependency</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>1715</span> </span><span class="WHIT">            </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.InstallDependency</span><span class="PUNC">(</span><span class="NAME">apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">sys</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1716</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1717</span> </span><span class="WHIT">      </span><span class="NAME">chain.setAutoUnloading</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1718</span> </span><span class="WHIT">      </span><span class="NAME">chain.setFallback</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1719</span> </span><span class="WHIT">        </span><span class="NAME">resolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1720</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">GLOBAL.config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1721</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">confs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dependencies</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context.getDependencies</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1722</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dependencies.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1723</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dependencies</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">$conf</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1724</span> </span><span class="WHIT">            </span><span class="NAME">confs.push</span><span class="PUNC">(</span><span class="NAME">conf</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// register conf</span><span class="WHIT">
<span class='linenumber'>1725</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1726</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1727</span> </span><span class="WHIT">            </span><span class="NAME">callbackFn</span><span class="PUNC">(</span><span class="NAME">confs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1728</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1729</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1730</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1731</span> </span><span class="WHIT">      </span><span class="NAME">chain.resolve</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1732</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1733</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1734</span> 
<span class='linenumber'>1735</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1736</span>      * Unregisters a module from the Runtime.
<span class='linenumber'>1737</span>      * &lt;p/>
<span class='linenumber'>1738</span>      * Note that a module cannot be uninstalled if it's currently active.
<span class='linenumber'>1739</span>      * Additionally, once it is unregistered, it cannot be started until it has
<span class='linenumber'>1740</span>      * been re-installed. 
<span class='linenumber'>1741</span>      * @param {String} name Module name.
<span class='linenumber'>1742</span>      */</span><span class="WHIT">
<span class='linenumber'>1743</span> </span><span class="WHIT">    </span><span class="NAME">uninstall</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1744</span> </span><span class="WHIT">      </span><span class="COMM">// Ensure that the module was installed and not active</span><span class="WHIT">
<span class='linenumber'>1745</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._registry</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1746</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1747</span> </span><span class="WHIT">        </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_STOP</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1748</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Stopping instantiated module before uninstalling: '</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1749</span> </span><span class="WHIT">            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1750</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1751</span> </span><span class="WHIT">      </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Uninstalling module: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1752</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._registry</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1753</span> </span><span class="WHIT">      </span><span class="PUNC">(</span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_UNINSTALLED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1754</span> </span><span class="WHIT">      </span><span class="NAME">this._uncache</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1755</span> </span><span class="WHIT">      </span><span class="COMM">// Recursively uninstall remaining parameters</span><span class="WHIT">
<span class='linenumber'>1756</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1757</span> </span><span class="WHIT">        </span><span class="NAME">this.uninstall.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1758</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1759</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1760</span> 
<span class='linenumber'>1761</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1762</span>      * Instantiates and runs a module by name.
<span class='linenumber'>1763</span>      * &lt;p/>
<span class='linenumber'>1764</span>      * If a module name is provided, and it was registered properly, it will 
<span class='linenumber'>1765</span>      * create a new instance and execute it. Otherwise, it will attempt to 
<span class='linenumber'>1766</span>      * reactivate the top-most module. Finally, if no active module exists, it 
<span class='linenumber'>1767</span>      * will execute the Dashboard.
<span class='linenumber'>1768</span>      * @param {String} name Module name, undefined will restart top-most module
<span class='linenumber'>1769</span>      * @throws {error} No module is active or installed
<span class='linenumber'>1770</span>      */</span><span class="WHIT">
<span class='linenumber'>1771</span> </span><span class="WHIT">    </span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1772</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stack</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cur</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1773</span> </span><span class="WHIT">          </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._registry</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1774</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1775</span> </span><span class="WHIT">      </span><span class="COMM">//!this._config.multiInstance -> not support multiInstance by default now </span><span class="WHIT">
<span class='linenumber'>1776</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1777</span> </span><span class="WHIT">        </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Dashboard</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1778</span> </span><span class="WHIT">            </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Application</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1779</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1780</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">module</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.rt.Module</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1781</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Runtime: no module active or installed!'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1782</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1783</span> </span><span class="WHIT">      </span><span class="COMM">// Always de-activate module first to properly maintain active stack.</span><span class="WHIT">
<span class='linenumber'>1784</span> </span><span class="WHIT">      </span><span class="COMM">// e.g. Some modules that restart must be moved from a lower active </span><span class="WHIT">
<span class='linenumber'>1785</span> </span><span class="WHIT">      </span><span class="COMM">// stack to the top (currently running).</span><span class="WHIT">
<span class='linenumber'>1786</span> </span><span class="WHIT">      </span><span class="COMM">// tau.arr(this._stack).remove(module);</span><span class="WHIT">
<span class='linenumber'>1787</span> </span><span class="WHIT">      </span><span class="NAME">stack</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this._stack</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1788</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cur</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">stack.peek</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// already existing module</span><span class="WHIT">
<span class='linenumber'>1789</span> </span><span class="WHIT">        </span><span class="NAME">this.$clipboard.cut</span><span class="PUNC">(</span><span class="NAME">cur.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cur.getDOM</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1790</span> </span><span class="WHIT">        </span><span class="NAME">cur.setVisible</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1791</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1792</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._stack.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1793</span> </span><span class="WHIT">        </span><span class="NAME">stack.remove</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1794</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1795</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">stack.pushUnique</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1796</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'Same module instance already exists: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1797</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1798</span> </span><span class="WHIT">      </span><span class="NAME">this.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// update system dock</span><span class="WHIT">
<span class='linenumber'>1799</span> </span><span class="WHIT">      </span><span class="COMM">// Set active module & run module</span><span class="WHIT">
<span class='linenumber'>1800</span> </span><span class="WHIT">      </span><span class="NAME">this.$eventMgr.setActiveModule</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1801</span> </span><span class="WHIT">      </span><span class="NAME">this.$themeMgr.loadTheme</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="COMM">// load theme before starting module</span><span class="WHIT">
<span class='linenumber'>1802</span> </span><span class="WHIT">          </span><span class="PUNC">{</span><span class="STRN">'config'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">module.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'module'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1803</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module.isBusy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// instance exists already</span><span class="WHIT">
<span class='linenumber'>1804</span> </span><span class="WHIT">        </span><span class="NAME">this.$clipboard.paste</span><span class="PUNC">(</span><span class="NAME">module.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.$dom.root</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1805</span> </span><span class="WHIT">        </span><span class="NAME">module.setVisible</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1806</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Switching: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_appNameId</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1807</span> </span><span class="WHIT">        </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_APP_CHANGE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1808</span> </span><span class="WHIT">            </span><span class="PUNC">{</span><span class="STRN">'fg'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'bg'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">cur</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1809</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1810</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Starting: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_appNameId</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1811</span> </span><span class="WHIT">        </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1812</span> </span><span class="WHIT">          </span><span class="NAME">module.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1813</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1814</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Starting module failed: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_appNameId</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1815</span> </span><span class="WHIT">              </span><span class="PUNC">+</span><span class="STRN">'\n\t'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1816</span> </span><span class="WHIT">          </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_STOP</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">module.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1817</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1818</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1819</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1820</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>1821</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1822</span>      * Stops and destroys a module using its registered name.
<span class='linenumber'>1823</span>      * &lt;p/>
<span class='linenumber'>1824</span>      * If a module name is provided and is found to be active, it will attempt
<span class='linenumber'>1825</span>      * to stop it. Otherwise, it will try to stop the top-most active module.
<span class='linenumber'>1826</span>      * &lt;p/>
<span class='linenumber'>1827</span>      * Once a module is stopped, it will return control to the next top most 
<span class='linenumber'>1828</span>      * module by starting it.
<span class='linenumber'>1829</span>      * @param {String} name Module name/id, undefined param stops the top module 
<span class='linenumber'>1830</span>      */</span><span class="WHIT">
<span class='linenumber'>1831</span> </span><span class="WHIT">    </span><span class="NAME">stop</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1832</span> </span><span class="WHIT">      </span><span class="COMM">// Find the running module, otherwise Stop currently running module;</span><span class="WHIT">
<span class='linenumber'>1833</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isActive</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1834</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1835</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1836</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._stack.length</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1837</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Stopping last remaining module is prohibited'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1838</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1839</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Stopping Dashboard is prohibited'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1840</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1841</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Stopping: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_appNameId</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1842</span> </span><span class="WHIT">          </span><span class="COMM">// Stop the module and fire event to start top-most active module</span><span class="WHIT">
<span class='linenumber'>1843</span> </span><span class="WHIT">          </span><span class="NAME">isActive</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._stack</span><span class="PUNC">[</span><span class="NAME">this._stack.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1844</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isActive</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1845</span> </span><span class="WHIT">            </span><span class="NAME">this.$eventMgr.setActiveModule</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Clear active module</span><span class="WHIT">
<span class='linenumber'>1846</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1847</span> </span><span class="WHIT">          </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1848</span> </span><span class="WHIT">            </span><span class="NAME">this.$clipboard.remove</span><span class="PUNC">(</span><span class="NAME">module.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1849</span> </span><span class="WHIT">            </span><span class="NAME">module.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1850</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1851</span> </span><span class="WHIT">            </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Exception occurred during Stop: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1852</span> </span><span class="WHIT">            </span><span class="COMM">// If graceful error option is not set, we re-throw exception </span><span class="WHIT">
<span class='linenumber'>1853</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._config.gracefulErrors</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1854</span> </span><span class="WHIT">              </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1855</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1856</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">finally</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1857</span> </span><span class="WHIT">            </span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this._stack</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Remove from active stack</span><span class="WHIT">
<span class='linenumber'>1858</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isActive</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1859</span> </span><span class="WHIT">              </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_START</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Restart top-most module</span><span class="WHIT">
<span class='linenumber'>1860</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1861</span> </span><span class="WHIT">              </span><span class="NAME">this.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1862</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1863</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1864</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1865</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1866</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Stopping failed for invalid module: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1867</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1868</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1869</span> 
<span class='linenumber'>1870</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1871</span>      * Installs and starts a module from a URL.
<span class='linenumber'>1872</span>      * &lt;p>
<span class='linenumber'>1873</span>      * If a URL parameter name contains &lt;code>app&lt;/code>, its value will be used
<span class='linenumber'>1874</span>      * to find and launch the app. Otherwise, it will try to find and launch
<span class='linenumber'>1875</span>      * Dashboard.
<span class='linenumber'>1876</span>      * URL format:
<span class='linenumber'>1877</span>      * &lt;pre>
<span class='linenumber'>1878</span>      *  http://&lt;domain.com>/launcher.html?app=&lt;appname>
<span class='linenumber'>1879</span>      * &lt;/pre>
<span class='linenumber'>1880</span>      */</span><span class="WHIT">
<span class='linenumber'>1881</span> </span><span class="WHIT">    </span><span class="NAME">launch</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1882</span> </span><span class="WHIT">      </span><span class="NAME">this._drawMask</span><span class="PUNC">(</span><span class="STRN">'Loading...'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1883</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">app</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">singleApp</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1884</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">app</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">app</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'$dashboard'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1885</span> </span><span class="WHIT">      </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1886</span> </span><span class="WHIT">        </span><span class="NAME">this.unsubscribeEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_INSTALLED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1887</span> </span><span class="WHIT">        </span><span class="NAME">this._clearMask</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1888</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">app</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1889</span> </span><span class="WHIT">          </span><span class="NAME">this.setTitle</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">title</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1890</span> </span><span class="WHIT">          </span><span class="NAME">this.setIcon</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">icon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1891</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">splash</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.setSplash</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">splash</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1892</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.LEVEL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loglevel</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1893</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1894</span> </span><span class="WHIT">          </span><span class="NAME">window.alert</span><span class="PUNC">(</span><span class="STRN">'앱('</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">app</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')을 실행할 수 없습니다.\n앱 이름이 정확한지 확인하십시오.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1895</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1896</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1897</span> </span><span class="WHIT">      </span><span class="NAME">this.onEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_INSTALLED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1898</span> </span><span class="WHIT">      </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_INSTALL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">name</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">app</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">autostart</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sys</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1899</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1900</span> 
<span class='linenumber'>1901</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1902</span>      * Stops and uninstalls the specified application.
<span class='linenumber'>1903</span>      * @param {String} name Module name
<span class='linenumber'>1904</span>      */</span><span class="WHIT">
<span class='linenumber'>1905</span> </span><span class="WHIT">    </span><span class="NAME">terminate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1906</span> </span><span class="WHIT">      </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Terminating: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1907</span> </span><span class="WHIT">      </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_STOP</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1908</span> </span><span class="WHIT">      </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_UNINSTALL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1909</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1910</span> 
<span class='linenumber'>1911</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1912</span>      * Upates all Runtime resources.
<span class='linenumber'>1913</span>      */</span><span class="WHIT">
<span class='linenumber'>1914</span> </span><span class="WHIT">    </span><span class="NAME">refresh</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1915</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1916</span> </span><span class="WHIT">      </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">deferRefresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1917</span> </span><span class="WHIT">        </span><span class="NAME">rt.getSystemDock</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">draw</span><span class="PUNC">(</span><span class="NAME">rt.$dom.root</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1918</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1919</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isMultiApp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Update system dock contents</span><span class="WHIT">
<span class='linenumber'>1920</span> </span><span class="WHIT">        </span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">deferRefresh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1921</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1922</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1923</span> 
<span class='linenumber'>1924</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1925</span>      * Returns the version of current runtime.
<span class='linenumber'>1926</span>      * @returns {String} Runtime version number
<span class='linenumber'>1927</span>      */</span><span class="WHIT">
<span class='linenumber'>1928</span> </span><span class="WHIT">    </span><span class="NAME">getVersion</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1929</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._config.version</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1930</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1931</span> 
<span class='linenumber'>1932</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1933</span>      * Returns Runtime's object.
<span class='linenumber'>1934</span>      * @returns {Object} Runtime configuration
<span class='linenumber'>1935</span>      */</span><span class="WHIT">
<span class='linenumber'>1936</span> </span><span class="WHIT">    </span><span class="NAME">getConfig</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1937</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1938</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1939</span> 
<span class='linenumber'>1940</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1941</span>      * Checks if the Runtime was loaded for Multi-App.
<span class='linenumber'>1942</span>      * @returns {Boolean} True if Multiple applications are running
<span class='linenumber'>1943</span>      */</span><span class="WHIT">
<span class='linenumber'>1944</span> </span><span class="WHIT">    </span><span class="NAME">isMultiApp</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1945</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this._config.singleApp</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1946</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1947</span> 
<span class='linenumber'>1948</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1949</span>      * Finds a running Module by the module's id or name.
<span class='linenumber'>1950</span>      * &lt;p/>
<span class='linenumber'>1951</span>      * Empty parameter returns the currently running module (top-most in stack).
<span class='linenumber'>1952</span>      * &lt;p/>
<span class='linenumber'>1953</span>      * "*" returns all of the running modules as an array.
<span class='linenumber'>1954</span>      * @param {String} nameId Application name or Id to search ("*" = all)
<span class='linenumber'>1955</span>      * @returns {Array|Object} Found module instance or an array
<span class='linenumber'>1956</span>      */</span><span class="WHIT">
<span class='linenumber'>1957</span> </span><span class="WHIT">    </span><span class="NAME">getModule</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nameId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1958</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">nameId</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._stack.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1959</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._stack</span><span class="PUNC">[</span><span class="NAME">this._stack.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">// Current</span><span class="WHIT">
<span class='linenumber'>1960</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nameId</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'*'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1961</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">this._stack</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1962</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nameId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1963</span> </span><span class="WHIT">        </span><span class="COMM">// Find module by name or id</span><span class="WHIT">
<span class='linenumber'>1964</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._stack.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1965</span> </span><span class="WHIT">          </span><span class="NAME">m</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._stack</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1966</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">m.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">nameId</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">m.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">nameId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1967</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1968</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1969</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1970</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>1971</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1972</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1973</span> 
<span class='linenumber'>1974</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1975</span>      * Returns the number of running modules.
<span class='linenumber'>1976</span>      * @returns {Number} Size of running modules (excludes dashboard)
<span class='linenumber'>1977</span>      */</span><span class="WHIT">
<span class='linenumber'>1978</span> </span><span class="WHIT">    </span><span class="NAME">getModuleSize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1979</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._stack.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1980</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1981</span> 
<span class='linenumber'>1982</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1983</span>      * Returns the configuration for the current module.
<span class='linenumber'>1984</span>      * &lt;p/>
<span class='linenumber'>1985</span>      * If a module name is provided, it will attempt to return the the 
<span class='linenumber'>1986</span>      * configuration for the specified name; otherwise, it will return the 
<span class='linenumber'>1987</span>      * currently running module's configuration object.
<span class='linenumber'>1988</span>      * @param {String} name Name of the app for the requested configuration 
<span class='linenumber'>1989</span>      * @returns {Object} A module's configuration object
<span class='linenumber'>1990</span>      */</span><span class="WHIT">
<span class='linenumber'>1991</span> </span><span class="WHIT">    </span><span class="NAME">getModuleConfig</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1992</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1993</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._registry</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1994</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1995</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1996</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1997</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1998</span> 
<span class='linenumber'>1999</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2000</span>      * Sets the Browser display title.
<span class='linenumber'>2001</span>      * @param {String} title Display title value
<span class='linenumber'>2002</span>      */</span><span class="WHIT">
<span class='linenumber'>2003</span> </span><span class="WHIT">    </span><span class="NAME">setTitle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">title</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2004</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.$dom.title</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2005</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'title'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2006</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.head.insertBefore</span><span class="PUNC">(</span><span class="NAME">this.$dom.title</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.$dom.head.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2007</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2008</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.title.removeChild</span><span class="PUNC">(</span><span class="NAME">this.$dom.title.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2009</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2010</span> </span><span class="WHIT">      </span><span class="NAME">this.$dom.title.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">title</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2011</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2012</span> 
<span class='linenumber'>2013</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2014</span>      * Sets the icon for the Application's platform shortcut.
<span class='linenumber'>2015</span>      * @param {String} path Directory & file location of the icon 
<span class='linenumber'>2016</span>      */</span><span class="WHIT">
<span class='linenumber'>2017</span> </span><span class="WHIT">    </span><span class="NAME">setIcon</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2018</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.$dom.icon</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2019</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.icon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'link'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2020</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.icon.setAttribute</span><span class="PUNC">(</span><span class="STRN">'rel'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'apple-touch-icon'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2021</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.head.appendChild</span><span class="PUNC">(</span><span class="NAME">this.$dom.icon</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2022</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2023</span> </span><span class="WHIT">      </span><span class="NAME">this.$dom.icon.setAttribute</span><span class="PUNC">(</span><span class="STRN">'href'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>2024</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2025</span> 
<span class='linenumber'>2026</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2027</span>      * Sets the splash image location for the Application's platform shortcut. 
<span class='linenumber'>2028</span>      * @param {String} path Directory & file location of the splash image 
<span class='linenumber'>2029</span>      */</span><span class="WHIT">
<span class='linenumber'>2030</span> </span><span class="WHIT">    </span><span class="NAME">setSplash</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2031</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.$dom.splash</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2032</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.splash</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'link'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2033</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.splash.setAttribute</span><span class="PUNC">(</span><span class="STRN">'rel'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'apple-touch-startup-image'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2034</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.head.appendChild</span><span class="PUNC">(</span><span class="NAME">this.$dom.splash</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2035</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2036</span> </span><span class="WHIT">      </span><span class="NAME">this.$dom.splash.setAttribute</span><span class="PUNC">(</span><span class="STRN">'href'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>2037</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2038</span> 
<span class='linenumber'>2039</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2040</span>      * Creatse a stroage context for a given name.
<span class='linenumber'>2041</span>      * &lt;p/>
<span class='linenumber'>2042</span>      * An application's storage context is defined by its name. If no name is 
<span class='linenumber'>2043</span>      * given, it will use the currently running application's context.
<span class='linenumber'>2044</span>      * @param {String} name Application name for the storage context
<span class='linenumber'>2045</span>      * @returns {Object} Storage context for the given name
<span class='linenumber'>2046</span>      */</span><span class="WHIT">
<span class='linenumber'>2047</span> </span><span class="WHIT">    </span><span class="NAME">createStorageCtx</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2048</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2049</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.StorageContext</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2050</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2051</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.StorageContext</span><span class="PUNC">(</span><span class="NAME">this.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2052</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2053</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2054</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2055</span> 
<span class='linenumber'>2056</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2057</span>      * Draws a mask message.
<span class='linenumber'>2058</span>      * @param {String} msg Mask message 
<span class='linenumber'>2059</span>      */</span><span class="WHIT">
<span class='linenumber'>2060</span> </span><span class="WHIT">    </span><span class="NAME">_drawMask</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2061</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.$dom.mask</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2062</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.mask</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2063</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.mask.setAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'margin-top:100px; text-align:center; font-family: sans-serif'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2064</span> </span><span class="WHIT">        </span><span class="NAME">this.$dom.root.appendChild</span><span class="PUNC">(</span><span class="NAME">this.$dom.mask</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2065</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2066</span> </span><span class="WHIT">      </span><span class="NAME">this.$dom.mask.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2067</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2068</span> 
<span class='linenumber'>2069</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2070</span>      * Clears mask.
<span class='linenumber'>2071</span>      * @private
<span class='linenumber'>2072</span>      */</span><span class="WHIT">
<span class='linenumber'>2073</span> </span><span class="WHIT">    </span><span class="NAME">_clearMask</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2074</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.$dom.mask</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.$dom.root.removeChild</span><span class="PUNC">(</span><span class="NAME">this.$dom.mask</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2075</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.$dom.mask</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2076</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2077</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2078</span> 
<span class='linenumber'>2079</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2080</span>      * 전체 default theme을 변경한다.
<span class='linenumber'>2081</span>      * &lt;p/>
<span class='linenumber'>2082</span>      * @param {String} theme Theme 텍스트
<span class='linenumber'>2083</span>      */</span><span class="WHIT">
<span class='linenumber'>2084</span> </span><span class="WHIT">    </span><span class="NAME">setTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2085</span> </span><span class="WHIT">      </span><span class="NAME">this.$themeMgr.setDefaultTheme</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2086</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2087</span> 
<span class='linenumber'>2088</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2089</span>      * config에 적용되어 있는 theme으로 초기화한다.
<span class='linenumber'>2090</span>      */</span><span class="WHIT">
<span class='linenumber'>2091</span> </span><span class="WHIT">    </span><span class="NAME">resetTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2092</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isMultiApp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// multi app</span><span class="WHIT">
<span class='linenumber'>2093</span> </span><span class="WHIT">        </span><span class="NAME">this.$themeMgr.resetTheme</span><span class="PUNC">(</span><span class="NAME">this.getModuleConfig</span><span class="PUNC">(</span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2094</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2095</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getCurrentContext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2096</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2097</span> </span><span class="WHIT">          </span><span class="NAME">context.resetTheme</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2098</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2099</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2100</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2101</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2102</span> </span><span class="WHIT">    </span><span class="NAME">addSystemWidget</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">widget</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2103</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">widget</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.rt.EventDelegator</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2104</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="NAME">widget.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>2105</span> </span><span class="WHIT">            </span><span class="STRN">' is not an instance of EventDelegator'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.currentStack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2106</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2107</span> </span><span class="WHIT">      </span><span class="COMM">// do not setBubble() with Runtime!!</span><span class="WHIT">
<span class='linenumber'>2108</span> </span><span class="WHIT">      </span><span class="NAME">this.$widgets.push</span><span class="PUNC">(</span><span class="NAME">widget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2109</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">widget</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2110</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2111</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2112</span> </span><span class="WHIT">    </span><span class="NAME">findSystemWidget</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">clazz</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2113</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">widgets</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$widgets</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2114</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">widgets.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2115</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">widgets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">clazz</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2116</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">widgets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2117</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2118</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2119</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2120</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2121</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2122</span> </span><span class="WHIT">    </span><span class="NAME">getSystemWidgets</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2123</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.$widgets</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2124</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2125</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2126</span> 
<span class='linenumber'>2127</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Module */</span><span class="WHIT">
<span class='linenumber'>2128</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Module'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.EventDelegator</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2129</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="COMM">/** @lends tau.rt.Module */</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2130</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>2131</span>        * 모듈에 Badge가 설정되었을 때 발생하는 이벤트이며, 설정된 Badge의 값은
<span class='linenumber'>2132</span>        * payload로 전달 받는다.
<span class='linenumber'>2133</span>        */</span><span class="WHIT">
<span class='linenumber'>2134</span> </span><span class="WHIT">      </span><span class="NAME">EVENT_BADGESET</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'badgeset'</span><span class="WHIT">
<span class='linenumber'>2135</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2136</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2137</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2138</span>      * @class
<span class='linenumber'>2139</span>      * Base module class extended by Application or Dashboard.
<span class='linenumber'>2140</span>      * &lt;p/>
<span class='linenumber'>2141</span>      * Contains a module's internal lifecycle initiator functions: 
<span class='linenumber'>2142</span>      * &lt;code>doLoadScene&lt;/code>, & &lt;code>doDestroy&lt;/code>
<span class='linenumber'>2143</span>      * @constructs
<span class='linenumber'>2144</span>      * @param {Object} rt Runtime instance in which the Module will run
<span class='linenumber'>2145</span>      * @param {Object} config Module configuration object
<span class='linenumber'>2146</span>      */</span><span class="WHIT">
<span class='linenumber'>2147</span> </span><span class="WHIT">    </span><span class="NAME">Module</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//$ tau.rt.Module</span><span class="WHIT">
<span class='linenumber'>2148</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">rt</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2149</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Module: invalid runtime/config'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2150</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2151</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Module configuration object */</span><span class="WHIT">
<span class='linenumber'>2152</span> </span><span class="WHIT">      </span><span class="NAME">this._config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2153</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Runtime instance */</span><span class="WHIT">
<span class='linenumber'>2154</span> </span><span class="WHIT">      </span><span class="NAME">this._rt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2155</span> 
<span class='linenumber'>2156</span> </span><span class="WHIT">      </span><span class="NAME">this.setBubble</span><span class="PUNC">(</span><span class="NAME">this._rt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2157</span> </span><span class="WHIT">      </span><span class="NAME">this._isVisible</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2158</span> </span><span class="WHIT">      </span><span class="NAME">this._isReady</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// set true when theme is loaded</span><span class="WHIT">
<span class='linenumber'>2159</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2160</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2161</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2162</span>      * 설정된 파라미터의 값에 따라 현재 모듈을 화면에 보이도록 하거나 보이지 않도록 한다.
<span class='linenumber'>2163</span>      * &lt;code>visible&lt;/code> 값이 false일 경우 현재 모듈을 화면에서 사라지며 CSS 스타일
<span class='linenumber'>2164</span>      * Proeprty인 display 값이 'none'으로 처리되어 실제 DOM Operation 도 발생하지
<span class='linenumber'>2165</span>      * 않는다.&lt;p/>
<span class='linenumber'>2166</span>      * Multi-App 모드일 경우 Runtime에서 현재 실행중인 App을 background나 foreground
<span class='linenumber'>2167</span>      * 로 처리할 때 이 메소드를 이용한다.   
<span class='linenumber'>2168</span>      * @param {Boolean} visible if true, module is rendered on screen
<span class='linenumber'>2169</span>      */</span><span class="WHIT">
<span class='linenumber'>2170</span> </span><span class="WHIT">    </span><span class="NAME">setVisible</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">visible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2171</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getDOM</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2172</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">visible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2173</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">anim</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._config.animation</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2174</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isUndefined</span><span class="PUNC">(</span><span class="NAME">anim</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">anim</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// animation</span><span class="WHIT">
<span class='linenumber'>2175</span> </span><span class="WHIT">          </span><span class="NAME">tau.fx.fadeIn</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2176</span> </span><span class="WHIT">            </span><span class="NAME">duration</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="WHIT">
<span class='linenumber'>2177</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2178</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2179</span> </span><span class="WHIT">          </span><span class="NAME">dom.style.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2180</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2181</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2182</span> </span><span class="WHIT">        </span><span class="NAME">dom.style.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'none'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2183</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2184</span> </span><span class="WHIT">      </span><span class="NAME">this._isVisible</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">visible</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2185</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2186</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2187</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2188</span>      * 이벤트 서브시스템 메소드를 Override하며 현재 SceneController에서 Scene을
<span class='linenumber'>2189</span>      * 로딩하여 Drawing이 완료됐을 때 &lt;code>tau.rt.Event.SCENEDRAWN&lt;/code> 이벤트를
<span class='linenumber'>2190</span>      * 받아 화면에 출력하는 기능을 수행한다. 
<span class='linenumber'>2191</span>      * @override
<span class='linenumber'>2192</span>      */</span><span class="WHIT">
<span class='linenumber'>2193</span> </span><span class="WHIT">    </span><span class="NAME">propagateEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2194</span> </span><span class="WHIT">      </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2195</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.SCENEDRAWN</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="COMM">// async call</span><span class="WHIT">
<span class='linenumber'>2196</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._isVisible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2197</span> </span><span class="WHIT">            </span><span class="NAME">this.setVisible</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2198</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2199</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2200</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_THEME_ENABLED</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>2201</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._isReady</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._rootController.$isStarted</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2202</span> </span><span class="WHIT">            </span><span class="NAME">this._rootController.doStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2203</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2204</span> </span><span class="WHIT">          </span><span class="NAME">this._isReady</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2205</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2206</span> </span><span class="WHIT">        </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>2207</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2208</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2209</span> </span><span class="WHIT">      </span><span class="NAME">tau.rt.Module.$super.propagateEvent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2210</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2211</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2212</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2213</span>      * Returns a unique module id.
<span class='linenumber'>2214</span>      * @returns {String} Module id
<span class='linenumber'>2215</span>      */</span><span class="WHIT">
<span class='linenumber'>2216</span> </span><span class="WHIT">    </span><span class="NAME">getId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2217</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._id</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2218</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2219</span> 
<span class='linenumber'>2220</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2221</span>      * Returns the current module name.
<span class='linenumber'>2222</span>      * @returns {String} Module name
<span class='linenumber'>2223</span>      */</span><span class="WHIT">
<span class='linenumber'>2224</span> </span><span class="WHIT">    </span><span class="NAME">getName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2225</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._config.name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2226</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2227</span> 
<span class='linenumber'>2228</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2229</span>      * Returns the current module's configuration object.
<span class='linenumber'>2230</span>      * @returns {Object} Module configuration
<span class='linenumber'>2231</span>      */</span><span class="WHIT">
<span class='linenumber'>2232</span> </span><span class="WHIT">    </span><span class="NAME">getConfig</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2233</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2234</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2235</span> 
<span class='linenumber'>2236</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2237</span>      * Returns the user-implemented root app controller.
<span class='linenumber'>2238</span>      * @returns {Object} Module's starting root controller
<span class='linenumber'>2239</span>      */</span><span class="WHIT">
<span class='linenumber'>2240</span> </span><span class="WHIT">    </span><span class="NAME">getRootController</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2241</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctrl</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.modalCtrl</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2242</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ctrl</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">ctrl.hasModals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ctrl</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._rootController</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2243</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2244</span> 
<span class='linenumber'>2245</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2246</span>      * Returns a Storage Manager for the current module used to persist data.
<span class='linenumber'>2247</span>      * @returns {Object} Curren't module's {@link tau.rt.StorageContext} object
<span class='linenumber'>2248</span>      */</span><span class="WHIT">
<span class='linenumber'>2249</span> </span><span class="WHIT">    </span><span class="NAME">getStorageCtx</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2250</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._storageCtx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2251</span> </span><span class="WHIT">        </span><span class="COMM">/** @private Storage context for the given module */</span><span class="WHIT">
<span class='linenumber'>2252</span> </span><span class="WHIT">        </span><span class="NAME">this._storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.StorageContext</span><span class="PUNC">(</span><span class="NAME">this.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2253</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2254</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._storageCtx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2255</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2256</span> 
<span class='linenumber'>2257</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2258</span>      * Persists a badge text or number for the Module.
<span class='linenumber'>2259</span>      * @param {String|Number} Badge value to set
<span class='linenumber'>2260</span>      * @returns {Boolean} True if the badge value was set
<span class='linenumber'>2261</span>      */</span><span class="WHIT">
<span class='linenumber'>2262</span> </span><span class="WHIT">    </span><span class="NAME">setBadge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2263</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getStorageCtx</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="STRN">'$badge'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2264</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">result</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2265</span> </span><span class="WHIT">        </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Module.EVENT_BADGESET</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2266</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2267</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2268</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2269</span> 
<span class='linenumber'>2270</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2271</span>      * Returns a previously set badge text or number.
<span class='linenumber'>2272</span>      * @returns {String|Number} Previously set badge value
<span class='linenumber'>2273</span>      */</span><span class="WHIT">
<span class='linenumber'>2274</span> </span><span class="WHIT">    </span><span class="NAME">getBadge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2275</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getStorageCtx</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">get</span><span class="PUNC">(</span><span class="STRN">'$badge'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2276</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2277</span> 
<span class='linenumber'>2278</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2279</span>      * Removes any previously set badges value.
<span class='linenumber'>2280</span>      * @returns {Boolean} True if the badge value was cleared
<span class='linenumber'>2281</span>      */</span><span class="WHIT">
<span class='linenumber'>2282</span> </span><span class="WHIT">    </span><span class="NAME">removeBadge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2283</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getStorageCtx</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="STRN">'$badge'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2284</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">result</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2285</span> </span><span class="WHIT">        </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Module.EVENT_BADGESET</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2286</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2287</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2288</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2289</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2290</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2291</span>      * 현재 모듈의 Lifecycle이 시작되었는지를 확인한다. 만약 &lt;code>true&lt;/code>를 반환하면
<span class='linenumber'>2292</span>      * 현재 모듈과 Controller의 Lifecycle 시작되었음을 의미한다.
<span class='linenumber'>2293</span>      * @returns {Boolean} 모듈의 Lifecycle이 시작되었으면 &lt;code>true&lt;/code>를 반환
<span class='linenumber'>2294</span>      */</span><span class="WHIT">
<span class='linenumber'>2295</span> </span><span class="WHIT">    </span><span class="NAME">isBusy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2296</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._rootController</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._rootController.$isStarted</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2297</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2298</span> 
<span class='linenumber'>2299</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2300</span>      * Module의 Lifecycle을 시작한다. 모듈의 Lifecycle이 시작되면 먼저 RootController
<span class='linenumber'>2301</span>      * 의 존재를 확인하고 설정된 RootController가 존재하면 RootController의 Lifecycle
<span class='linenumber'>2302</span>      * 도 시작한다.
<span class='linenumber'>2303</span>      * @throws {ReferenceError} RootController가 설정되지 않았을 경우
<span class='linenumber'>2304</span>      */</span><span class="WHIT">
<span class='linenumber'>2305</span> </span><span class="WHIT">    </span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2306</span> </span><span class="WHIT">      </span><span class="COMM">// load theme asynchronously, process in parallel</span><span class="WHIT">
<span class='linenumber'>2307</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getDOM</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2308</span> </span><span class="WHIT">      </span><span class="COMM">// Push module element to top of DOM stack</span><span class="WHIT">
<span class='linenumber'>2309</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dom.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2310</span> </span><span class="WHIT">        </span><span class="NAME">tau.util.dom.pushElement</span><span class="PUNC">(</span><span class="NAME">this._rt.$dom.root</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2311</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2312</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._rootController</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2313</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ReferenceError</span><span class="PUNC">(</span><span class="STRN">'RootController is not set on module: '</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2314</span> </span><span class="WHIT">            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2315</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2316</span> </span><span class="WHIT">      </span><span class="COMM">// Link Event Delegators if the app wasn't preivously started</span><span class="WHIT">
<span class='linenumber'>2317</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._rootController.$parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2318</span> </span><span class="WHIT">        </span><span class="NAME">this._rootController.setParent</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2319</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2320</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isBusy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2321</span> </span><span class="WHIT">        </span><span class="NAME">dom.style.opacity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// must retain the space!</span><span class="WHIT">
<span class='linenumber'>2322</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._isReady</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//theme is loaded asynchronously! See event handler</span><span class="WHIT">
<span class='linenumber'>2323</span> </span><span class="WHIT">          </span><span class="NAME">this._rootController.doStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2324</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2325</span> </span><span class="WHIT">        </span><span class="NAME">this._isReady</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2326</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2327</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2328</span> 
<span class='linenumber'>2329</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2330</span>      * Notifies the module that it is about to be destroyed by calling the
<span class='linenumber'>2331</span>      * &lt;code>destroy&lt;/code> callback method.
<span class='linenumber'>2332</span>      * &lt;p/>
<span class='linenumber'>2333</span>      * It also releases any outstanding component hierarchy and resources.
<span class='linenumber'>2334</span>      */</span><span class="WHIT">
<span class='linenumber'>2335</span> </span><span class="WHIT">    </span><span class="NAME">stop</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2336</span> </span><span class="WHIT">      </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2337</span> </span><span class="WHIT">        </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">$themeMgr.unloadTheme</span><span class="PUNC">(</span><span class="NAME">this.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2338</span> </span><span class="WHIT">        </span><span class="COMM">// Verify & run user implementation of destroy()</span><span class="WHIT">
<span class='linenumber'>2339</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._rootController</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.ui.Controller</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2340</span> </span><span class="WHIT">          </span><span class="NAME">this._rootController.doDestroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2341</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2342</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Destruction: \"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._config.classname</span><span class="WHIT">
<span class='linenumber'>2343</span> </span><span class="WHIT">              </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\" is an invalid controller'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2344</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2345</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">finally</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2346</span> </span><span class="WHIT">        </span><span class="COMM">// Module resource cleanup</span><span class="WHIT">
<span class='linenumber'>2347</span> </span><span class="WHIT">        </span><span class="NAME">this.removeBubble</span><span class="PUNC">(</span><span class="NAME">this._rt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2348</span> </span><span class="WHIT">        </span><span class="NAME">this._rootController.$parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2349</span> </span><span class="WHIT">        </span><span class="NAME">this._rootController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2350</span> </span><span class="WHIT">        </span><span class="NAME">this._storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2351</span> </span><span class="WHIT">        </span><span class="NAME">this._config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2352</span> </span><span class="WHIT">        </span><span class="NAME">this._rt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2353</span> </span><span class="WHIT">        </span><span class="NAME">this._id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2354</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.modalCtrl</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//terminates the lifecycle of ModalSceneController</span><span class="WHIT">
<span class='linenumber'>2355</span> </span><span class="WHIT">          </span><span class="NAME">this.modalCtrl.doDestroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2356</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.modalCtrl</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2357</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2358</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2359</span> </span><span class="WHIT">          </span><span class="NAME">tau.util.dom.removeElements</span><span class="PUNC">(</span><span class="NAME">this._dom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2360</span> </span><span class="WHIT">          </span><span class="NAME">this._dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2361</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2362</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2363</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2364</span> 
<span class='linenumber'>2365</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2366</span>      * Returns the root DOM element for the Module.
<span class='linenumber'>2367</span>      * @returns {Object} DOM element
<span class='linenumber'>2368</span>      */</span><span class="WHIT">
<span class='linenumber'>2369</span> </span><span class="WHIT">    </span><span class="NAME">getDOM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2370</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2371</span> </span><span class="WHIT">        </span><span class="COMM">/** @private Frame DOM element */</span><span class="WHIT">
<span class='linenumber'>2372</span> </span><span class="WHIT">        </span><span class="NAME">this._dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2373</span> </span><span class="WHIT">        </span><span class="NAME">this._dom.setAttribute</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Defined in App/Dashboard</span><span class="WHIT">
<span class='linenumber'>2374</span> </span><span class="WHIT">        </span><span class="NAME">tau.util.dom.addClass</span><span class="PUNC">(</span><span class="NAME">this._dom</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tau-application'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2375</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2376</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._dom</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2377</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2378</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2379</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2380</span>      * Returns the instance of &lt;code>ModalSceneController&lt;/code> assiciated 
<span class='linenumber'>2381</span>      * with this Module. 
<span class='linenumber'>2382</span>      * @returns {tau.ui.ModalSceneController} an instance of 
<span class='linenumber'>2383</span>      *  tau.ui.ModalSceneController
<span class='linenumber'>2384</span>      */</span><span class="WHIT">
<span class='linenumber'>2385</span> </span><span class="WHIT">    </span><span class="NAME">getModalController</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2386</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.modalCtrl</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// lazy construction</span><span class="WHIT">
<span class='linenumber'>2387</span> </span><span class="WHIT">        </span><span class="NAME">this.modalCtrl</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ui.ModalSceneController</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2388</span> </span><span class="WHIT">        </span><span class="NAME">this.modalCtrl.doStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2389</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2390</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.modalCtrl</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2391</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2392</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2393</span> 
<span class='linenumber'>2394</span> 
<span class='linenumber'>2395</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Application */</span><span class="WHIT">
<span class='linenumber'>2396</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Application'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Module</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2397</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2398</span> </span><span class="WHIT">      </span><span class="NAME">CONFIG</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2399</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {String} classname App's full class name (required) */</span><span class="WHIT">
<span class='linenumber'>2400</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {String} title Display name (default: App name) */</span><span class="WHIT">
<span class='linenumber'>2401</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Number} timeout Max time given for loading a scene in ms */</span><span class="WHIT">
<span class='linenumber'>2402</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {String} close "dashboard": (Default) Go to Dashboard
<span class='linenumber'>2403</span>          *                        "back": Ends the App & go to previous app
<span class='linenumber'>2404</span>          *                        "exit": Ends the App & goes to Dashboard */</span><span class="WHIT">
<span class='linenumber'>2405</span> </span><span class="WHIT">        </span><span class="NAME">require</span><span class="WHIT">       </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'/main.js'</span><span class="PUNC">,</span><span class="WHIT">   </span><span class="COMM">// Class source path (default: /main.js)</span><span class="WHIT">
<span class='linenumber'>2406</span> </span><span class="WHIT">        </span><span class="NAME">icon</span><span class="WHIT">          </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'/icon.png'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="COMM">// Icon resource path (default: /icon.png)</span><span class="WHIT">
<span class='linenumber'>2407</span> </span><span class="WHIT">        </span><span class="NAME">version</span><span class="WHIT">       </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'1.0.0'</span><span class="PUNC">,</span><span class="WHIT">      </span><span class="COMM">// Version (default: 1.0.0)</span><span class="WHIT">
<span class='linenumber'>2408</span> </span><span class="WHIT">        </span><span class="NAME">vendor</span><span class="WHIT">        </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Company'</span><span class="PUNC">,</span><span class="WHIT">    </span><span class="COMM">// Vendor name (default: Company)</span><span class="WHIT">
<span class='linenumber'>2409</span> 
<span class='linenumber'>2410</span> </span><span class="WHIT">        </span><span class="COMM">/** TODO: Currently unused */</span><span class="WHIT">
<span class='linenumber'>2411</span> </span><span class="WHIT">        </span><span class="NAME">orientation</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'portrait'</span><span class="PUNC">,</span><span class="WHIT">   </span><span class="COMM">// Sceen orientation (portrait/landscape)</span><span class="WHIT">
<span class='linenumber'>2412</span> </span><span class="WHIT">        </span><span class="NAME">language</span><span class="WHIT">      </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'ko'</span><span class="PUNC">,</span><span class="WHIT">         </span><span class="COMM">// Default language</span><span class="WHIT">
<span class='linenumber'>2413</span> </span><span class="WHIT">        </span><span class="NAME">region</span><span class="WHIT">        </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'KR'</span><span class="WHIT">          </span><span class="COMM">// Default regional settings</span><span class="WHIT">
<span class='linenumber'>2414</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2415</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2416</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2417</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2418</span>      * @class
<span class='linenumber'>2419</span>      * Application module.
<span class='linenumber'>2420</span>      * &lt;p/>
<span class='linenumber'>2421</span>      * Note that a module loads asynchronously; i.e. when the browser finishes 
<span class='linenumber'>2422</span>      * loading the main script, it will call &lt;code>loadedFn&lt;/code>. Any subsequent
<span class='linenumber'>2423</span>      * logic must be implemented in this callback function to ensure that the
<span class='linenumber'>2424</span>      * module was successfully.
<span class='linenumber'>2425</span>      * @constructs
<span class='linenumber'>2426</span>      * @extends tau.rt.Module
<span class='linenumber'>2427</span>      * @param {Object} rt Runtime instance in which the Application will run
<span class='linenumber'>2428</span>      * @param {Object} config Application configuration object
<span class='linenumber'>2429</span>      */</span><span class="WHIT">
<span class='linenumber'>2430</span> </span><span class="WHIT">    </span><span class="NAME">Application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2431</span> </span><span class="WHIT">      </span><span class="NAME">this._config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Application.CONFIG</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// override default</span><span class="WHIT">
<span class='linenumber'>2432</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isNamespace</span><span class="PUNC">(</span><span class="NAME">config.classname</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2433</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Application: invalid application class name, '</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2434</span> </span><span class="WHIT">            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">config.classname</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2435</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isNamespace</span><span class="PUNC">(</span><span class="NAME">config.name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2436</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Application: invalid module name, \"'</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2437</span> </span><span class="WHIT">            </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">config.name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2438</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2439</span> 
<span class='linenumber'>2440</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Unique module id */</span><span class="WHIT">
<span class='linenumber'>2441</span> </span><span class="WHIT">      </span><span class="NAME">this._id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.genId</span><span class="PUNC">(</span><span class="STRN">'m'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2442</span> 
<span class='linenumber'>2443</span> </span><span class="WHIT">      </span><span class="COMM">/** @private User application */</span><span class="WHIT">
<span class='linenumber'>2444</span> </span><span class="WHIT">      </span><span class="NAME">this._rootController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2445</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2446</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2447</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2448</span>      * 
<span class='linenumber'>2449</span>      */</span><span class="WHIT">
<span class='linenumber'>2450</span> </span><span class="WHIT">    </span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2451</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">app</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2452</span> </span><span class="WHIT">        </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2453</span> </span><span class="WHIT">        </span><span class="NAME">dependencies</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.DependencyChain</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2454</span> </span><span class="WHIT">      </span><span class="NAME">dependencies.setCaching</span><span class="PUNC">(</span><span class="NAME">config.dev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2455</span> </span><span class="WHIT">      </span><span class="COMM">// sets default fallback Depenedency</span><span class="WHIT">
<span class='linenumber'>2456</span> </span><span class="WHIT">      </span><span class="NAME">dependencies.setFallback</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2457</span> </span><span class="WHIT">        </span><span class="NAME">resolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2458</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">clazz</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2459</span> </span><span class="WHIT">          </span><span class="COMM">// All import completed: disable require, create class, & callback</span><span class="WHIT">
<span class='linenumber'>2460</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">$require</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2461</span> </span><span class="WHIT">          </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2462</span> </span><span class="WHIT">            </span><span class="NAME">clazz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$class.forName</span><span class="PUNC">(</span><span class="NAME">config.classname</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2463</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2464</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Application: Could not find Application'</span><span class="WHIT">
<span class='linenumber'>2465</span> </span><span class="WHIT">                </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' class definition: \"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">config.classname</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2466</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2467</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2468</span> </span><span class="WHIT">          </span><span class="COMM">// Create an instance of application implementation class</span><span class="WHIT">
<span class='linenumber'>2469</span> </span><span class="WHIT">          </span><span class="NAME">app._rootController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">clazz</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2470</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2471</span> </span><span class="WHIT">          </span><span class="COMM">// Ensure the main application extends a controller</span><span class="WHIT">
<span class='linenumber'>2472</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">app._rootController</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.ui.Controller</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2473</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Application: Main application \"'</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2474</span> </span><span class="WHIT">                </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">config.classname</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\" must extend a tau.ui.Controller'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2475</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2476</span> </span><span class="WHIT">          </span><span class="NAME">tau.rt.Application.$super.start.apply</span><span class="PUNC">(</span><span class="NAME">app</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2477</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2478</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2479</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>2480</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>2481</span>        * JavaScript dependency declaration.
<span class='linenumber'>2482</span>        * &lt;p/>
<span class='linenumber'>2483</span>        * Instructs the runtime to load an external JavaScript script file for 
<span class='linenumber'>2484</span>        * the specified URL. Any unique dependencies defined within an import
<span class='linenumber'>2485</span>        * file will be loaded recursively in a depth-first order.
<span class='linenumber'>2486</span>        * You can specify multiple libraries as argumens.
<span class='linenumber'>2487</span>        * &lt;p/>
<span class='linenumber'>2488</span>        * Note: &lt;code>$require&lt;/code> API is only available when the script is
<span class='linenumber'>2489</span>        * in the process of being loaded.
<span class='linenumber'>2490</span>        * &lt;pre>
<span class='linenumber'>2491</span>        *  // Script "lib1.js" & "lib2.js" loaded in sequence. Any $require 
<span class='linenumber'>2492</span>        *  // defintions in "lib1.js" will be loaded prior to "lib2.js"
<span class='linenumber'>2493</span>        *  $require('/lib1.js');
<span class='linenumber'>2494</span>        *  $require('/lib2.js');
<span class='linenumber'>2495</span>        *  ...
<span class='linenumber'>2496</span>        *  $class('MyClass').define({
<span class='linenumber'>2497</span>        *    MyClass() {
<span class='linenumber'>2498</span>        *      $require('/lib3.js'); // *Undefined* Not available post file load
<span class='linenumber'>2499</span>        *    }
<span class='linenumber'>2500</span>        *  });
<span class='linenumber'>2501</span>        * &lt;/pre>
<span class='linenumber'>2502</span>        * @param {String} lib JavaScript dependent source URL
<span class='linenumber'>2503</span>        * @see #$class
<span class='linenumber'>2504</span>        */</span><span class="WHIT">
<span class='linenumber'>2505</span> </span><span class="WHIT">      </span><span class="NAME">$require</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lib</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2506</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2507</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_resolvePath</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2508</span> </span><span class="WHIT">          </span><span class="NAME">dependencies.addDependency</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Dependency</span><span class="PUNC">(</span><span class="NAME">config.name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2509</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2510</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2511</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2512</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">config.require</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2513</span> </span><span class="WHIT">        </span><span class="NAME">config.require</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">config.require</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2514</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2515</span> </span><span class="WHIT">      </span><span class="NAME">$require.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config.require</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2516</span> </span><span class="WHIT">      </span><span class="NAME">dependencies.resolve</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2517</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2518</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2519</span> 
<span class='linenumber'>2520</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.DependencyChain */</span><span class="WHIT">
<span class='linenumber'>2521</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.DependencyChain'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2522</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2523</span>      * You can use DependencyChain as follows:
<span class='linenumber'>2524</span>      * &lt;pre>
<span class='linenumber'>2525</span>      * var app = // app name
<span class='linenumber'>2526</span>      * var chain = tau.rt.DependencyChain();
<span class='linenumber'>2527</span>      * chain.setFalllback({
<span class='linenumber'>2528</span>      *   resolve: function (context) {
<span class='linenumber'>2529</span>      *     // do default handling
<span class='linenumber'>2530</span>      *   }
<span class='linenumber'>2531</span>      * });
<span class='linenumber'>2532</span>      * chain.addDependency(new Dependency(app, actualfilepath));
<span class='linenumber'>2533</span>      * chain.addDependency(new Dependency(app, actualfilepath));
<span class='linenumber'>2534</span>      * ...
<span class='linenumber'>2535</span>      * chain.resolve();
<span class='linenumber'>2536</span>      * &lt;/pre>
<span class='linenumber'>2537</span>      * @class
<span class='linenumber'>2538</span>      * Class definition for importing libraries that have dependency. This
<span class='linenumber'>2539</span>      * class guarantees that files which is added as a &lt;code>Dependency&lt;/code>
<span class='linenumber'>2540</span>      * load in the same order as added
<span class='linenumber'>2541</span>      * @constructs
<span class='linenumber'>2542</span>      */</span><span class="WHIT">
<span class='linenumber'>2543</span> </span><span class="WHIT">    </span><span class="NAME">DependencyChain</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2544</span> </span><span class="WHIT">      </span><span class="NAME">this._offset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// track current resolve position</span><span class="WHIT">
<span class='linenumber'>2545</span> </span><span class="WHIT">      </span><span class="NAME">this._fb</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// fallback dependency</span><span class="WHIT">
<span class='linenumber'>2546</span> </span><span class="WHIT">      </span><span class="NAME">this._dependencies</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2547</span> </span><span class="WHIT">      </span><span class="NAME">this.$opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2548</span> </span><span class="WHIT">          </span><span class="NAME">noCache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2549</span> </span><span class="WHIT">          </span><span class="NAME">autoUnlaod</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2550</span> </span><span class="WHIT">          </span><span class="NAME">timeout</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">30000</span><span class="WHIT"> </span><span class="COMM">// 30 seconds</span><span class="WHIT">
<span class='linenumber'>2551</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2552</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2553</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2554</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2555</span>      * Sets the default Dependency Object whick is invoked when all the 
<span class='linenumber'>2556</span>      * Dependencies are resolved and there are no more dependencies to resolve.
<span class='linenumber'>2557</span>      * In default fallback Dependency, you can handle default behavior.
<span class='linenumber'>2558</span>      * @param {tau.rt.Dependency} fb default fallback Dependency object
<span class='linenumber'>2559</span>      */</span><span class="WHIT">
<span class='linenumber'>2560</span> </span><span class="WHIT">    </span><span class="NAME">setFallback</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fb</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2561</span> </span><span class="WHIT">      </span><span class="NAME">this._fb</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fb</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2562</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2563</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2564</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2565</span>      * Enable or disable caching the javascript libraries which has been loaded.
<span class='linenumber'>2566</span>      * Default value is true.
<span class='linenumber'>2567</span>      * @param {Boolean} state specifies the flag whether to cache or not
<span class='linenumber'>2568</span>      *  libraries need to be cached
<span class='linenumber'>2569</span>      */</span><span class="WHIT">
<span class='linenumber'>2570</span> </span><span class="WHIT">    </span><span class="NAME">setCaching</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">state</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2571</span> </span><span class="WHIT">      </span><span class="NAME">this.$opts.noCache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">state</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2572</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2573</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2574</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2575</span>      * 
<span class='linenumber'>2576</span>      * @param state
<span class='linenumber'>2577</span>      */</span><span class="WHIT">
<span class='linenumber'>2578</span> </span><span class="WHIT">    </span><span class="NAME">setAutoUnloading</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">state</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2579</span> </span><span class="WHIT">      </span><span class="NAME">this.$opts.autoUnload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">state</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2580</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2581</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2582</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2583</span>      * 
<span class='linenumber'>2584</span>      * @param timeout
<span class='linenumber'>2585</span>      */</span><span class="WHIT">
<span class='linenumber'>2586</span> </span><span class="WHIT">    </span><span class="NAME">setTimeout</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">timeout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2587</span> </span><span class="WHIT">      </span><span class="NAME">this.$opts.timeout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">timeout</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2588</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2589</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2590</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2591</span>      * Adds Dependency object. The Dependencis which are added to this 
<span class='linenumber'>2592</span>      * DependencyChain are resolved in the order. You can add 
<span class='linenumber'>2593</span>      * &lt;code>Dependency&lt;/code> object into this &lt;code>DependencyChain&lt;/code>
<span class='linenumber'>2594</span>      * dynamically at rumtime.
<span class='linenumber'>2595</span>      * @param {tau.rt.Dependency} dependency Dependency object to add
<span class='linenumber'>2596</span>      * @see tau.rt.Dependency
<span class='linenumber'>2597</span>      */</span><span class="WHIT">
<span class='linenumber'>2598</span> </span><span class="WHIT">    </span><span class="NAME">addDependency</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dependency</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2599</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">suffix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._dependencies.splice</span><span class="PUNC">(</span><span class="NAME">this._offset</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._index</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2600</span> </span><span class="WHIT">      </span><span class="NAME">this._dependencies.push</span><span class="PUNC">(</span><span class="NAME">dependency</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2601</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">suffix.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2602</span> </span><span class="WHIT">        </span><span class="NAME">this._dependencies.push</span><span class="PUNC">(</span><span class="NAME">suffix</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2603</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2604</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2605</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2606</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2607</span>      * Resolves the Dependency object that add added so far.
<span class='linenumber'>2608</span>      */</span><span class="WHIT">
<span class='linenumber'>2609</span> </span><span class="WHIT">    </span><span class="NAME">resolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2610</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">that</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2611</span> </span><span class="WHIT">      </span><span class="COMM">// context object should have &lt;code>resolveNext&lt;/code> method!!! </span><span class="WHIT">
<span class='linenumber'>2612</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// context object which is created on the fly</span><span class="WHIT">
<span class='linenumber'>2613</span> </span><span class="WHIT">        </span><span class="NAME">getDependencies</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// returns all the dependency objects</span><span class="WHIT">
<span class='linenumber'>2614</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">that._dependencies</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2615</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2616</span> </span><span class="WHIT">        </span><span class="NAME">resolveNext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// resolves next dependency object</span><span class="WHIT">
<span class='linenumber'>2617</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">that._offset</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2618</span> </span><span class="WHIT">          </span><span class="NAME">that._index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// reset index</span><span class="WHIT">
<span class='linenumber'>2619</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">that._dependencies.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2620</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dependency</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">that._dependencies</span><span class="PUNC">[</span><span class="NAME">current</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2621</span> </span><span class="WHIT">            </span><span class="NAME">dependency.resolve</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2622</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">that._fb</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">that._dependencies.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2623</span> </span><span class="WHIT">            </span><span class="NAME">that._fb.resolve</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2624</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2625</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2626</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.$opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2627</span> </span><span class="WHIT">      </span><span class="NAME">context.resolveNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2628</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2629</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2630</span> 
<span class='linenumber'>2631</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Dependency */</span><span class="WHIT">
<span class='linenumber'>2632</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Dependency'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2633</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2634</span>      * @class
<span class='linenumber'>2635</span>      * This class represents external library file that has dependency on active
<span class='linenumber'>2636</span>      * &lt;code>Application&lt;/code>. The instance of this class can be added to 
<span class='linenumber'>2637</span>      * &lt;code>tau.rt.DependencyChain&lt;/code> object.
<span class='linenumber'>2638</span>      * @constructs
<span class='linenumber'>2639</span>      * @param {String} name application name
<span class='linenumber'>2640</span>      * @param {String} src library file that has dependency on the specified app
<span class='linenumber'>2641</span>      * @see tau.rt.DependencyChain
<span class='linenumber'>2642</span>      */</span><span class="WHIT">
<span class='linenumber'>2643</span> </span><span class="WHIT">    </span><span class="NAME">Dependency</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2644</span> </span><span class="WHIT">      </span><span class="NAME">this._name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2645</span> </span><span class="WHIT">      </span><span class="NAME">this._src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2646</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2647</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2648</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2649</span>      * Check to see if current Dependency needs to resolve. If current 
<span class='linenumber'>2650</span>      * Dependency(library file) is loaded already returns &lt;code>false&lt;/code>
<span class='linenumber'>2651</span>      * @returns {Boolean} true if current dependency is loaded already
<span class='linenumber'>2652</span>      */</span><span class="WHIT">
<span class='linenumber'>2653</span> </span><span class="WHIT">    </span><span class="NAME">needToResolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2654</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._src</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">_headerScriptUrls</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">this._src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2655</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2656</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2657</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2658</span>      * Handles the result of resolve process.
<span class='linenumber'>2659</span>      * @param {Object} context Dependency Context
<span class='linenumber'>2660</span>      * @param {Boolean|null} success the status of result. 
<span class='linenumber'>2661</span>      *        If null, the resolution is bypassed.
<span class='linenumber'>2662</span>      * @private
<span class='linenumber'>2663</span>      */</span><span class="WHIT">
<span class='linenumber'>2664</span> </span><span class="WHIT">    </span><span class="NAME">handleResult</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">success</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2665</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">success</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">' ignores importing: '</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2666</span> </span><span class="WHIT">            </span><span class="PUNC">(</span><span class="NAME">success</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">' imported: '</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">' FAILED to import: '</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2667</span> </span><span class="WHIT">      </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="NAME">this._name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._src</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\"'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2668</span> </span><span class="WHIT">      </span><span class="NAME">context.resolveNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2669</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2670</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2671</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2672</span>      * Do the actual resolution process.
<span class='linenumber'>2673</span>      * @param {Object} context Dependency Context
<span class='linenumber'>2674</span>      */</span><span class="WHIT">
<span class='linenumber'>2675</span> </span><span class="WHIT">    </span><span class="NAME">resolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2676</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">$require</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2677</span> </span><span class="WHIT">        </span><span class="NAME">$require.path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._src</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// remember current file path</span><span class="WHIT">
<span class='linenumber'>2678</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2679</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.needToResolve</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2680</span> </span><span class="WHIT">        </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ScriptHelper</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// proceeds asynchronously</span><span class="WHIT">
<span class='linenumber'>2681</span> </span><span class="WHIT">          </span><span class="NAME">noCache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">context.noCache</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2682</span> </span><span class="WHIT">          </span><span class="NAME">timeout</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">context.timeout</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2683</span> </span><span class="WHIT">          </span><span class="NAME">autoUnload</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">context.autoUnload</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2684</span> </span><span class="WHIT">          </span><span class="NAME">callbackFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.curry</span><span class="PUNC">(</span><span class="NAME">this.handleResult</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2685</span> </span><span class="WHIT">          </span><span class="NAME">timeoutFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.curry</span><span class="PUNC">(</span><span class="NAME">this.handleResult</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>2686</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">load</span><span class="PUNC">(</span><span class="NAME">this._src</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2687</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2688</span> </span><span class="WHIT">        </span><span class="NAME">this.handleResult</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// notice second paramter is null</span><span class="WHIT">
<span class='linenumber'>2689</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2690</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2691</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2692</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>2693</span> </span><span class="WHIT">   </span><span class="COMM">/** @lends tau.rt.InstallDependency */</span><span class="WHIT">
<span class='linenumber'>2694</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.InstallDependency'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Dependency</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2695</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2696</span>      * @class
<span class='linenumber'>2697</span>      * This class represents module configuration file that is required to
<span class='linenumber'>2698</span>      * install Module object on Runtime. The instance of this class can be
<span class='linenumber'>2699</span>      * added to &lt;code>tau.rt.DependencyChain&lt;/code> object.
<span class='linenumber'>2700</span>      * @constructs
<span class='linenumber'>2701</span>      * @param {String} name application name
<span class='linenumber'>2702</span>      * @param {String} src config file that Module needs to install
<span class='linenumber'>2703</span>      * @param {boolean} isSys if true current module is system module
<span class='linenumber'>2704</span>      * @see tau.rt.DependencyChain
<span class='linenumber'>2705</span>      */</span><span class="WHIT">
<span class='linenumber'>2706</span> </span><span class="WHIT">    </span><span class="NAME">InstallDependency</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isSys</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2707</span> </span><span class="WHIT">      </span><span class="NAME">this._isSys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">isSys</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2708</span> </span><span class="WHIT">      </span><span class="NAME">this.$conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2709</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2710</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>2711</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2712</span>      * @override
<span class='linenumber'>2713</span>      * @private
<span class='linenumber'>2714</span>      */</span><span class="WHIT">
<span class='linenumber'>2715</span> </span><span class="WHIT">    </span><span class="NAME">handleResult</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">success</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2716</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">success</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2717</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL.config.current</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2718</span> </span><span class="WHIT">        </span><span class="NAME">conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">conf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">tau.parse</span><span class="PUNC">(</span><span class="NAME">conf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2719</span> </span><span class="WHIT">        </span><span class="NAME">conf.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2720</span> </span><span class="WHIT">        </span><span class="NAME">conf.$mutable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._isSys</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// need to fix!!</span><span class="WHIT">
<span class='linenumber'>2721</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">conf.icon</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2722</span> </span><span class="WHIT">          </span><span class="NAME">conf.icon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf.apps</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">_ICONPATH</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'/icon.png'</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// if dashboard</span><span class="WHIT">
<span class='linenumber'>2723</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2724</span> </span><span class="WHIT">        </span><span class="NAME">conf.icon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_resolvePath</span><span class="PUNC">(</span><span class="NAME">conf.icon</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">conf.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2725</span> </span><span class="WHIT">        </span><span class="NAME">conf.splash</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf.splash</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">_resolvePath</span><span class="PUNC">(</span><span class="NAME">conf.splash</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">conf.name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2726</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">conf.title</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// if not specified, use app name instead</span><span class="WHIT">
<span class='linenumber'>2727</span> </span><span class="WHIT">          </span><span class="NAME">conf.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf.name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2728</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2729</span> </span><span class="WHIT">        </span><span class="NAME">this.$conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2730</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2731</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Unable to INSTALL module: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2732</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2733</span> </span><span class="WHIT">      </span><span class="NAME">tau.rt.InstallDependency.$super.handleResult.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2734</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2735</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2736</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>2737</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Dashboard */</span><span class="WHIT">
<span class='linenumber'>2738</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Dashboard'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">tau.rt.Module</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2739</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2740</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2741</span> </span><span class="WHIT">      </span><span class="NAME">CONFIG</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2742</span> </span><span class="WHIT">        </span><span class="NAME">version</span><span class="WHIT">       </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'1.0.0'</span><span class="PUNC">,</span><span class="WHIT">      </span><span class="COMM">// Dashboard version (required)</span><span class="WHIT">
<span class='linenumber'>2743</span> </span><span class="WHIT">        </span><span class="NAME">vendor</span><span class="WHIT">        </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'KT'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="COMM">// Vendor name</span><span class="WHIT">
<span class='linenumber'>2744</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>2745</span> </span><span class="WHIT">        </span><span class="COMM">/** TODO: Currently unused */</span><span class="WHIT">
<span class='linenumber'>2746</span> </span><span class="WHIT">        </span><span class="NAME">language</span><span class="WHIT">      </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'ko'</span><span class="PUNC">,</span><span class="WHIT">         </span><span class="COMM">// Default language</span><span class="WHIT">
<span class='linenumber'>2747</span> </span><span class="WHIT">        </span><span class="NAME">region</span><span class="WHIT">        </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'KR'</span><span class="WHIT">          </span><span class="COMM">// Default regional settings</span><span class="WHIT">
<span class='linenumber'>2748</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2749</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2750</span> 
<span class='linenumber'>2751</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2752</span>      * @class
<span class='linenumber'>2753</span>      * Dashboard module.
<span class='linenumber'>2754</span>      * &lt;p/>
<span class='linenumber'>2755</span>      * Note that a module loads asynchronously; i.e. when the browser finishes 
<span class='linenumber'>2756</span>      * loading the main script, it will call &lt;code>loadedFn&lt;/code>. Any subsequent
<span class='linenumber'>2757</span>      * logic must be implemented in this callback function to ensure that the
<span class='linenumber'>2758</span>      * module was successfully.
<span class='linenumber'>2759</span>      * @constructs Creates new Dashboard instance  
<span class='linenumber'>2760</span>      * @extends tau.rt.Module
<span class='linenumber'>2761</span>      * @param {Object} rt Runtime instance in which the Dashboard will run
<span class='linenumber'>2762</span>      * @param {Object} config Dashboard configuration object
<span class='linenumber'>2763</span>      */</span><span class="WHIT">
<span class='linenumber'>2764</span> </span><span class="WHIT">    </span><span class="NAME">Dashboard</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//$ tau.rt.Dashboard</span><span class="WHIT">
<span class='linenumber'>2765</span> </span><span class="WHIT">      </span><span class="NAME">this._config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.rt.Dashboard.CONFIG</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// override default</span><span class="WHIT">
<span class='linenumber'>2766</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Unique module id */</span><span class="WHIT">
<span class='linenumber'>2767</span> </span><span class="WHIT">      </span><span class="NAME">this._id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"tau-dashboard"</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2768</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>2769</span> </span><span class="WHIT">      </span><span class="COMM">/** @private reference for DashboardPanel */</span><span class="WHIT">
<span class='linenumber'>2770</span> </span><span class="WHIT">      </span><span class="NAME">this.panel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2771</span> 
<span class='linenumber'>2772</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Applications that are visible to the user */</span><span class="WHIT">
<span class='linenumber'>2773</span> </span><span class="WHIT">      </span><span class="NAME">this._shortcuts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2774</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>2775</span> </span><span class="WHIT">      </span><span class="COMM">/** @private RootController that creates Dashboard screen */</span><span class="WHIT">
<span class='linenumber'>2776</span> </span><span class="WHIT">      </span><span class="NAME">this._rootController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._newController</span><span class="PUNC">(</span><span class="NAME">config.dashboard</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2777</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2778</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2779</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2780</span>      * Overrides parent class's method. takes appropriate actions
<span class='linenumber'>2781</span>      * @param {tau.rt.Event} e Runtime event
<span class='linenumber'>2782</span>      * @param payload paylaod object
<span class='linenumber'>2783</span>      */</span><span class="WHIT">
<span class='linenumber'>2784</span> </span><span class="WHIT">    </span><span class="NAME">propagateEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">payload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2785</span> </span><span class="WHIT">      </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2786</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_INSTALLED</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>2787</span> </span><span class="WHIT">          </span><span class="NAME">this._rootController.addShortcuts</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2788</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2789</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">tau.rt.Event.RT_UNINSTALLED</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>2790</span> </span><span class="WHIT">          </span><span class="NAME">this._rootController.removeShortcut</span><span class="PUNC">(</span><span class="NAME">payload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2791</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2792</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2793</span> </span><span class="WHIT">      </span><span class="NAME">tau.rt.Dashboard.$super.propagateEvent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2794</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2795</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2796</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2797</span>      * Dashboard화면을 구성하기 위한 SceneController 객체를 로딩한다. 사용자가 설정한
<span class='linenumber'>2798</span>      * Custom SceneController 클래스가 설정되어 있다면 이 클래스를 로딩하여 
<span class='linenumber'>2799</span>      * SceneController로 사용한다. 만약 설정된 Custom SceneController클래스가 없다면
<span class='linenumber'>2800</span>      * Default SceneController인 &lt;code>tau.ui.DashboardController&lt;/code>의 
<span class='linenumber'>2801</span>      * 객체를 반환한다. Custom SceneController 클래스는 환경설정파일인 
<span class='linenumber'>2802</span>      * &lt;code>config.json&lt;/code>에서 설정한다. 이때 키는 다음과 같이 사용한다.
<span class='linenumber'>2803</span>      * &lt;p/>
<span class='linenumber'>2804</span>      * 사용자가 Custom SceneController를 만들기 위해서는 반드시 
<span class='linenumber'>2805</span>      * &lt;code>tau.ui.DashboardController&lt;/code>를 상속받아 작성해야 한다. 
<span class='linenumber'>2806</span>      * &lt;pre>
<span class='linenumber'>2807</span>      * config({
<span class='linenumber'>2808</span>      *   ...
<span class='linenumber'>2809</span>      *   dashboard    : {columns: 4, controller: ''}
<span class='linenumber'>2810</span>      *   ...
<span class='linenumber'>2811</span>      * });
<span class='linenumber'>2812</span>      * &lt;/pre>
<span class='linenumber'>2813</span>      * @param {Object} cofig global configuration object
<span class='linenumber'>2814</span>      * @returns {tau.ui.DashboardController} Dashboard화면 구성을 위해 사용할 
<span class='linenumber'>2815</span>      * SceneController 객체
<span class='linenumber'>2816</span>      * @throws {TypeError} 사용자가 작성한 SceneController 클래스가
<span class='linenumber'>2817</span>      * &lt;code>tau.ui.DashboardController&lt;/code>을 상속받지 않았을 경우
<span class='linenumber'>2818</span>      * @private
<span class='linenumber'>2819</span>      */</span><span class="WHIT">
<span class='linenumber'>2820</span> </span><span class="WHIT">    </span><span class="NAME">_newController</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2821</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">usrclazz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">config.controller</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2822</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">usrclazz</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2823</span> </span><span class="WHIT">        </span><span class="NAME">usrclazz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$class.forName</span><span class="PUNC">(</span><span class="NAME">usrclazz</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2824</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">instance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">usrclazz</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2825</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">instance</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">tau.ui.DashboardController</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2826</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="NAME">instance.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>2827</span> </span><span class="WHIT">              </span><span class="STRN">' is not an instance of DashboardController'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.currentStack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2828</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2829</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">instance</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2830</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2831</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ui.DashboardController</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// fallback controller</span><span class="WHIT">
<span class='linenumber'>2832</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2833</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2834</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2835</span>      * Returns normal columns count. If columns count is not specified in global
<span class='linenumber'>2836</span>      * configuration file(config.json), default value will be 4. 
<span class='linenumber'>2837</span>      * @returns {Number} Column size
<span class='linenumber'>2838</span>      */</span><span class="WHIT">
<span class='linenumber'>2839</span> </span><span class="WHIT">    </span><span class="NAME">getCols</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2840</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._config.dashboard.cols</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2841</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2842</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2843</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2844</span>      * Returns maximum columns count. If columns count is not specified in global
<span class='linenumber'>2845</span>      * configuration file(config.json), default value will be 5. 
<span class='linenumber'>2846</span>      * @returns {Number} Column size
<span class='linenumber'>2847</span>      */</span><span class="WHIT">
<span class='linenumber'>2848</span> </span><span class="WHIT">    </span><span class="NAME">getMaxCols</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2849</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._config.dashboard.maxcols</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2850</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2851</span> 
<span class='linenumber'>2852</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2853</span>      * Returns current Dashboard {@link tau.ui.Shortcut} objects as an Array. If
<span class='linenumber'>2854</span>      * no {@link tau.ui.Shortcut} object has been set, returns empty array object
<span class='linenumber'>2855</span>      * @returns {Array} {@link tau.ui.Shortcut} objects
<span class='linenumber'>2856</span>      * @see tau.ui.Shortcut
<span class='linenumber'>2857</span>      */</span><span class="WHIT">
<span class='linenumber'>2858</span> </span><span class="WHIT">    </span><span class="NAME">getShortcuts</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2859</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._shortcuts</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2860</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2861</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2862</span>      * Dashboard에 출력할 Shortcut 객체를 추가한다. 이때 추가할 &lt;code>shortcut&lt;/code>
<span class='linenumber'>2863</span>      * 는 &lt;code>tau.ui.Shortcut&lt;/code> 객체이어야 하며 독립 객체 또는 배열에 저장된
<span class='linenumber'>2864</span>      * 형태이어야 한다.
<span class='linenumber'>2865</span>      * @param {tau.ui.Shortcut | Array} Dashboard에 추가할 tau.ui.Shortcut 객체
<span class='linenumber'>2866</span>      * @see tau.ui.Shortcut
<span class='linenumber'>2867</span>      */</span><span class="WHIT">
<span class='linenumber'>2868</span> </span><span class="WHIT">    </span><span class="NAME">addShortcut</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">shortcut</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2869</span> </span><span class="WHIT">        </span><span class="NAME">this._shortcuts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._shortcuts.concat</span><span class="PUNC">(</span><span class="NAME">shortcut</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2870</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2871</span> 
<span class='linenumber'>2872</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2873</span>      * Removes one or more Dashboard shortcut.
<span class='linenumber'>2874</span>      * @param {Object} args config(shortcut) to be removed
<span class='linenumber'>2875</span>      * @see tau.ui.Shortcut
<span class='linenumber'>2876</span>      */</span><span class="WHIT">
<span class='linenumber'>2877</span> </span><span class="WHIT">    </span><span class="NAME">removeShortcut</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2878</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2879</span> </span><span class="WHIT">          </span><span class="NAME">curModuleConf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">module.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2880</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2881</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">curModuleConf</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Cannot remove running app</span><span class="WHIT">
<span class='linenumber'>2882</span> </span><span class="WHIT">          </span><span class="NAME">tau.arr</span><span class="PUNC">(</span><span class="NAME">this._shortcuts</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2883</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2884</span> </span><span class="WHIT">          </span><span class="NAME">tau.log.info</span><span class="PUNC">(</span><span class="STRN">'Cannot remove active module: '</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>2885</span> </span><span class="WHIT">              </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2886</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2887</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2888</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2889</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>2890</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2891</span>      * Finds specified shortcut is stalled already. if installed, this method
<span class='linenumber'>2892</span>      * returns &lt;code>true&lt;/code>. Otherwise returns &lt;code>false&lt;/cdoe>
<span class='linenumber'>2893</span>      * @param {String} name shortcut name to find
<span class='linenumber'>2894</span>      * @returns {Boolean} if specified Shortcut is installed, 
<span class='linenumber'>2895</span>      * returns &lt;code>true&lt;/code>
<span class='linenumber'>2896</span>      */</span><span class="WHIT">
<span class='linenumber'>2897</span> </span><span class="WHIT">    </span><span class="NAME">hasShortcut</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2898</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">shortcuts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getShortcuts</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2899</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">shortcuts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2900</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">shortcuts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// compare class name ??</span><span class="WHIT">
<span class='linenumber'>2901</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2902</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2903</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2904</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2905</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2906</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2907</span> 
<span class='linenumber'>2908</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.StorageContext */</span><span class="WHIT">
<span class='linenumber'>2909</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.StorageContext'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2910</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2911</span>      * @class
<span class='linenumber'>2912</span>      * Handles simple persistent data storage for a given context (id).
<span class='linenumber'>2913</span>      * &lt;p/>
<span class='linenumber'>2914</span>      * A context string (tau.&lt;PlatformID>.&lt;context>') is used to index into
<span class='linenumber'>2915</span>      * the localStorage for saving and retrieving data. Since localStorage does
<span class='linenumber'>2916</span>      * not support objects we use a proxy object to stored &lt;code>put&lt;/code> data
<span class='linenumber'>2917</span>      * which is then flushed to localStorage via JSON stringify marshaller.
<span class='linenumber'>2918</span>      * @constructs
<span class='linenumber'>2919</span>      * @param {String} name Storage context, identical IDs will share data
<span class='linenumber'>2920</span>      * @param {Boolean} reloadOnRead Will refresh localStorage data on each get
<span class='linenumber'>2921</span>      * @param {String} platformId Unique id for Tau platform ID
<span class='linenumber'>2922</span>      * @throws {error} Web engine does not support localStorage
<span class='linenumber'>2923</span>      */</span><span class="WHIT">
<span class='linenumber'>2924</span> </span><span class="WHIT">    </span><span class="NAME">StorageContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reloadOnRead</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">platformId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2925</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">localStorage</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2926</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.StorageContext: Web localStorage unsupported'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2927</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2928</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Platform ID must be unique to the device application */</span><span class="WHIT">
<span class='linenumber'>2929</span> </span><span class="WHIT">      </span><span class="NAME">this._platformId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">platformId</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">_RTCONFIG.id</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2930</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Reloads data from localStorage for each _getStorage call */</span><span class="WHIT">
<span class='linenumber'>2931</span> </span><span class="WHIT">      </span><span class="NAME">this._reloadOnRead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">reloadOnRead</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2932</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.setContextName</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2933</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.StorageContext: invalid context name: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2934</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2935</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2936</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2937</span> 
<span class='linenumber'>2938</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2939</span>      * If the storage instance was not initialized, it will fetch the context
<span class='linenumber'>2940</span>      * indexed localStorage value.
<span class='linenumber'>2941</span>      * @private
<span class='linenumber'>2942</span>      * @returns {Object} Contexted localStorage object
<span class='linenumber'>2943</span>      */</span><span class="WHIT">
<span class='linenumber'>2944</span> </span><span class="WHIT">    </span><span class="NAME">_getStorageObj</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2945</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._storage</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._reloadOnRead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2946</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">localStorage</span><span class="PUNC">[</span><span class="NAME">this._ctxKey</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2947</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">storage</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2948</span> </span><span class="WHIT">          </span><span class="NAME">this._storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.parse</span><span class="PUNC">(</span><span class="NAME">storage</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2949</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2950</span> </span><span class="WHIT">          </span><span class="NAME">this._storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2951</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2952</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2953</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._storage</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2954</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2955</span> 
<span class='linenumber'>2956</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2957</span>      * Returns the context name.
<span class='linenumber'>2958</span>      * @returns {String} Returns the context name
<span class='linenumber'>2959</span>      */</span><span class="WHIT">
<span class='linenumber'>2960</span> </span><span class="WHIT">    </span><span class="NAME">getContextName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2961</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2962</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2963</span> 
<span class='linenumber'>2964</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2965</span>      * Sets the key name for the Storage Context.
<span class='linenumber'>2966</span>      * @param {String} name Storage context, identical IDs will share data
<span class='linenumber'>2967</span>      * @returns {Boolean} True if the context was changed properly
<span class='linenumber'>2968</span>      */</span><span class="WHIT">
<span class='linenumber'>2969</span> </span><span class="WHIT">    </span><span class="NAME">setContextName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2970</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2971</span> </span><span class="WHIT">        </span><span class="COMM">/** @private Name used for localStorage: 'tau.&lt;PlatformID>.&lt;ctxName>' */</span><span class="WHIT">
<span class='linenumber'>2972</span> </span><span class="WHIT">        </span><span class="NAME">this._name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2973</span> </span><span class="WHIT">        </span><span class="COMM">/** @private LocalStorage key: 'tau.&lt;PlatformID>.&lt;name>' */</span><span class="WHIT">
<span class='linenumber'>2974</span> </span><span class="WHIT">        </span><span class="NAME">this._ctxKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'tau.'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._platformId</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'.'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2975</span> </span><span class="WHIT">        </span><span class="NAME">this._storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Remove previously set storage</span><span class="WHIT">
<span class='linenumber'>2976</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2977</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2978</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2979</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2980</span> 
<span class='linenumber'>2981</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2982</span>      * Returns a stored value that was previously &lt;code>set&lt;/code> to this
<span class='linenumber'>2983</span>      * storage context.
<span class='linenumber'>2984</span>      * @param {String} key Previously &lt;code>set&lt;/code> stored value
<span class='linenumber'>2985</span>      * @returns {Object} Matching object value from the key
<span class='linenumber'>2986</span>      */</span><span class="WHIT">
<span class='linenumber'>2987</span> </span><span class="WHIT">    </span><span class="NAME">get</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2988</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._getStorageObj</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2989</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2990</span> 
<span class='linenumber'>2991</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2992</span>      * Stores a value to this storage context for the corresponding key.
<span class='linenumber'>2993</span>      * @param {String} key A string to be used for finding the matching value 
<span class='linenumber'>2994</span>      * @param {Object} value Object value to store (cannot be functions)
<span class='linenumber'>2995</span>      * @returns {Boolean} True if the value was set properly
<span class='linenumber'>2996</span>      */</span><span class="WHIT">
<span class='linenumber'>2997</span> </span><span class="WHIT">    </span><span class="NAME">set</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2998</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isValue</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2999</span> </span><span class="WHIT">        </span><span class="COMM">// Set respective storage data key/value, then flush to localStorage</span><span class="WHIT">
<span class='linenumber'>3000</span> </span><span class="WHIT">        </span><span class="NAME">this._getStorageObj</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3001</span> </span><span class="WHIT">        </span><span class="NAME">this.flush</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3002</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3003</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3004</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3005</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3006</span> 
<span class='linenumber'>3007</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3008</span>      * Removes a previously saved value from this storage context.
<span class='linenumber'>3009</span>      * @param {String} key Key for the value to be removed
<span class='linenumber'>3010</span>      * @returns {Boolean} True if the value was removed properly
<span class='linenumber'>3011</span>      */</span><span class="WHIT">
<span class='linenumber'>3012</span> </span><span class="WHIT">    </span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3013</span> </span><span class="WHIT">      </span><span class="COMM">// Set respective storage data from key, then flush to localStorage</span><span class="WHIT">
<span class='linenumber'>3014</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._getStorageObj</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3015</span> </span><span class="WHIT">        </span><span class="NAME">this.flush</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3016</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3017</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3018</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3019</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3020</span> 
<span class='linenumber'>3021</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3022</span>      * Returns the key string for the index in this storage context.
<span class='linenumber'>3023</span>      * @param {Number} index Index to search for the key in the storage context
<span class='linenumber'>3024</span>      * @returns {String} Key string for corresponding index
<span class='linenumber'>3025</span>      */</span><span class="WHIT">
<span class='linenumber'>3026</span> </span><span class="WHIT">    </span><span class="NAME">key</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3027</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>3028</span> </span><span class="WHIT">          </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3029</span> </span><span class="WHIT">          </span><span class="NAME">storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getStorageObj</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3030</span> </span><span class="WHIT">      </span><span class="COMM">// Search index key value</span><span class="WHIT">
<span class='linenumber'>3031</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">k</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">storage</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3032</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">storage.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3033</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">index</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3034</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3035</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3036</span> </span><span class="WHIT">          </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3037</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3038</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3039</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3040</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3041</span> 
<span class='linenumber'>3042</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3043</span>      * Clears all stored key/values from this storage context.
<span class='linenumber'>3044</span>      */</span><span class="WHIT">
<span class='linenumber'>3045</span> </span><span class="WHIT">    </span><span class="NAME">clear</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3046</span> </span><span class="WHIT">      </span><span class="COMM">// Clear entire storage, then remove the respective key from localStorage</span><span class="WHIT">
<span class='linenumber'>3047</span> </span><span class="WHIT">      </span><span class="NAME">this._storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3048</span> </span><span class="WHIT">      </span><span class="NAME">localStorage.removeItem</span><span class="PUNC">(</span><span class="NAME">this._ctxKey</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3049</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3050</span> 
<span class='linenumber'>3051</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3052</span>      * Flush out any remaining data to storage.
<span class='linenumber'>3053</span>      */</span><span class="WHIT">
<span class='linenumber'>3054</span> </span><span class="WHIT">    </span><span class="NAME">flush</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3055</span> </span><span class="WHIT">      </span><span class="NAME">localStorage</span><span class="PUNC">[</span><span class="NAME">this._ctxKey</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.stringify</span><span class="PUNC">(</span><span class="NAME">this._getStorageObj</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3056</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3057</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3058</span> 
<span class='linenumber'>3059</span> 
<span class='linenumber'>3060</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.ApplicationContext */</span><span class="WHIT">
<span class='linenumber'>3061</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.ApplicationContext'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3062</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3063</span>      * @class
<span class='linenumber'>3064</span>      * Context class that offers access to application resources such as ID, 
<span class='linenumber'>3065</span>      * local storage, resource path resolver, etc.
<span class='linenumber'>3066</span>      * @constructs
<span class='linenumber'>3067</span>      * @param {Object} module Application's {@linek tau.rt.Module} instance
<span class='linenumber'>3068</span>      */</span><span class="WHIT">
<span class='linenumber'>3069</span> </span><span class="WHIT">    </span><span class="NAME">ApplicationContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3070</span> </span><span class="WHIT">      </span><span class="NAME">this._module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3071</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3072</span> 
<span class='linenumber'>3073</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3074</span>      * Returns a Storage Manager for the current module used to get/set data.
<span class='linenumber'>3075</span>      * @returns {String} Curren't module's ID
<span class='linenumber'>3076</span>      */</span><span class="WHIT">
<span class='linenumber'>3077</span> </span><span class="WHIT">    </span><span class="NAME">getId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3078</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._module.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3079</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3080</span> 
<span class='linenumber'>3081</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3082</span>      * Returns an absolute path for a given application resource path.
<span class='linenumber'>3083</span>      * &lt;p/>
<span class='linenumber'>3084</span>      * Resource path must begin with a "/", "$shared", or be a full URL.
<span class='linenumber'>3085</span>      * @param {String} path Relative resource path in the application context
<span class='linenumber'>3086</span>      * @returns {String} Full path for the given relative path
<span class='linenumber'>3087</span>      */</span><span class="WHIT">
<span class='linenumber'>3088</span> </span><span class="WHIT">    </span><span class="NAME">getRealPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3089</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_resolvePath</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._module.getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3090</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3091</span> 
<span class='linenumber'>3092</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3093</span>      * Returns the configuration for the application
<span class='linenumber'>3094</span>      */</span><span class="WHIT">
<span class='linenumber'>3095</span> </span><span class="WHIT">    </span><span class="NAME">getConfig</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3096</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._module.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3097</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3098</span> 
<span class='linenumber'>3099</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3100</span>      * Returns an object value for the corresponding key and scope.
<span class='linenumber'>3101</span>      * @param {String} key String key value
<span class='linenumber'>3102</span>      * @param {String} scope Name of the storage scope
<span class='linenumber'>3103</span>      * @return {Object} Instance value for the corresponding key
<span class='linenumber'>3104</span>      */</span><span class="WHIT">
<span class='linenumber'>3105</span> </span><span class="WHIT">    </span><span class="NAME">getStorage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3106</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._getStorageCtx</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">get</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3107</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3108</span> 
<span class='linenumber'>3109</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3110</span>      * Stores an object value for the corresponding key and scope.
<span class='linenumber'>3111</span>      * @param {String} key String key value
<span class='linenumber'>3112</span>      * @param {String} value Corresponding key's value
<span class='linenumber'>3113</span>      * @param {String} scope Name of the storage scope
<span class='linenumber'>3114</span>      * @returns {Boolean} True if the value was set properly
<span class='linenumber'>3115</span>      */</span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>3116</span> </span><span class="WHIT">    </span><span class="NAME">setStorage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3117</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._getStorageCtx</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3118</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3119</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>3120</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3121</span>      * Removes any value set for the corresponding key and scope.
<span class='linenumber'>3122</span>      * @param {String} key String key value
<span class='linenumber'>3123</span>      * @param {String} scope Name of the storage scope
<span class='linenumber'>3124</span>      */</span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>3125</span> </span><span class="WHIT">    </span><span class="NAME">removeStorage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3126</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._getStorageCtx</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">remove</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3127</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3128</span> 
<span class='linenumber'>3129</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3130</span>      * Returns the key for the corresponding index and scope.
<span class='linenumber'>3131</span>      * @param {Number} index Numerical index of the key
<span class='linenumber'>3132</span>      * @param {String} scope Name of the storage scope
<span class='linenumber'>3133</span>      */</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>3134</span> </span><span class="WHIT">    </span><span class="NAME">storageKey</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3135</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._getStorageCtx</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">key</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3136</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3137</span> 
<span class='linenumber'>3138</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3139</span>      * Clears all key/value stored for the corresponding scope.
<span class='linenumber'>3140</span>      * @param {String} scope Name of the storage scope
<span class='linenumber'>3141</span>      */</span><span class="WHIT">
<span class='linenumber'>3142</span> </span><span class="WHIT">    </span><span class="NAME">clearStorage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3143</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._getStorageCtx</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3144</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3145</span> 
<span class='linenumber'>3146</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3147</span>      * Persists a badge text or number for the Module.
<span class='linenumber'>3148</span>      * @param {String|Number} Badge value to set
<span class='linenumber'>3149</span>      * @returns {Boolean} True if the badge value was set
<span class='linenumber'>3150</span>      */</span><span class="WHIT">
<span class='linenumber'>3151</span> </span><span class="WHIT">    </span><span class="NAME">setBadge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3152</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._module.setBadge</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3153</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3154</span> 
<span class='linenumber'>3155</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3156</span>      * Returns a previously set badge text or number.
<span class='linenumber'>3157</span>      * @returns {String|Number} Previously set badge value
<span class='linenumber'>3158</span>      */</span><span class="WHIT">
<span class='linenumber'>3159</span> </span><span class="WHIT">    </span><span class="NAME">getBadge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3160</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._module.getBadge</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3161</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3162</span> 
<span class='linenumber'>3163</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3164</span>      * Removes any previously set badges value.
<span class='linenumber'>3165</span>      * @returns {Boolean} True if the badge value was cleared
<span class='linenumber'>3166</span>      */</span><span class="WHIT">
<span class='linenumber'>3167</span> </span><span class="WHIT">    </span><span class="NAME">removeBadge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3168</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._module.removeBadge</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3169</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3170</span> 
<span class='linenumber'>3171</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3172</span>      * Returns a storage object for the context scope. If a scope isn't provided
<span class='linenumber'>3173</span>      * the default current module's scope will be used.  
<span class='linenumber'>3174</span>      * @param {String} scope Name of the storage scope
<span class='linenumber'>3175</span>      * @private
<span class='linenumber'>3176</span>      */</span><span class="WHIT">
<span class='linenumber'>3177</span> </span><span class="WHIT">    </span><span class="NAME">_getStorageCtx</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3178</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3179</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._module.getStorageCtx</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3180</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isNamespace</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3181</span> </span><span class="WHIT">        </span><span class="NAME">scope</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'$'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">scope</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Append $ to the scope name for uniqueness</span><span class="WHIT">
<span class='linenumber'>3182</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._ctx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3183</span> </span><span class="WHIT">          </span><span class="NAME">this._ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3184</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3185</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._ctx</span><span class="PUNC">[</span><span class="NAME">scope</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3186</span> </span><span class="WHIT">          </span><span class="NAME">this._ctx</span><span class="PUNC">[</span><span class="NAME">scope</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.StorageContext</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3187</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3188</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._ctx</span><span class="PUNC">[</span><span class="NAME">scope</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3189</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3190</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.rt.ApplicationContext: Invalid scope namespace, \"'</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>3191</span> </span><span class="WHIT">          </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">scope</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3192</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3193</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3194</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3195</span>      * 현재 application의 theme을 변경한다.
<span class='linenumber'>3196</span>      * &lt;p/>
<span class='linenumber'>3197</span>      * @param {String} theme Theme 텍스트
<span class='linenumber'>3198</span>      */</span><span class="WHIT">
<span class='linenumber'>3199</span> </span><span class="WHIT">    </span><span class="NAME">setTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3200</span> </span><span class="WHIT">      </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">$themeMgr.setTheme</span><span class="PUNC">(</span><span class="NAME">this.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3201</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3202</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3203</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3204</span>      * config에 설정된 default theme로 초기화한다.
<span class='linenumber'>3205</span>      */</span><span class="WHIT">
<span class='linenumber'>3206</span> </span><span class="WHIT">    </span><span class="NAME">resetTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3207</span> </span><span class="WHIT">      </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">$themeMgr.resetTheme</span><span class="PUNC">(</span><span class="NAME">this.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3208</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3209</span> 
<span class='linenumber'>3210</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3211</span> 
<span class='linenumber'>3212</span> 
<span class='linenumber'>3213</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.Theme */</span><span class="WHIT">
<span class='linenumber'>3214</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Theme'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3215</span> 
<span class='linenumber'>3216</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3217</span>      * @class
<span class='linenumber'>3218</span>      * 테마에 해당하는 css파일을 동적으로 로드하고 언로드해 주는 class
<span class='linenumber'>3219</span>      * @constructs
<span class='linenumber'>3220</span>      * @param {String} themeName theme 텍스트
<span class='linenumber'>3221</span>      */</span><span class="WHIT">
<span class='linenumber'>3222</span> </span><span class="WHIT">    </span><span class="NAME">Theme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3223</span> </span><span class="WHIT">      </span><span class="NAME">this._themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3224</span> </span><span class="WHIT">      </span><span class="NAME">this._loaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3225</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3226</span> 
<span class='linenumber'>3227</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3228</span>      * theme을 로드한다.
<span class='linenumber'>3229</span>      * &lt;p/>
<span class='linenumber'>3230</span>      * @param {Boolean} enable theme 활성화 여부
<span class='linenumber'>3231</span>      * @param {Function} callbackfn 
<span class='linenumber'>3232</span>      */</span><span class="WHIT">
<span class='linenumber'>3233</span> </span><span class="WHIT">    </span><span class="NAME">load</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">enable</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackfn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3234</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">theme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3235</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">theme.isLoded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3236</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">theme._css</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3237</span> </span><span class="WHIT">          </span><span class="NAME">theme._css</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ScriptHelper</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3238</span> </span><span class="WHIT">            </span><span class="NAME">type</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'css'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3239</span> </span><span class="WHIT">            </span><span class="NAME">url</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'lib/resources/themes/'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">theme._themeName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'/tau.css'</span><span class="WHIT">
<span class='linenumber'>3240</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3241</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3242</span> </span><span class="WHIT">        </span><span class="NAME">theme._css.load</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3243</span> </span><span class="WHIT">          </span><span class="NAME">theme._loaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3244</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">callbackfn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">callbackfn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3245</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3246</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3247</span> </span><span class="WHIT">        </span><span class="NAME">theme._loaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3248</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">callbackfn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">callbackfn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3249</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3250</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">enable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3251</span> </span><span class="WHIT">        </span><span class="NAME">theme._css.enable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3252</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3253</span> </span><span class="WHIT">        </span><span class="NAME">theme._css.unload</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3254</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3255</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3256</span> 
<span class='linenumber'>3257</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3258</span>      * theme을 언로드한다.
<span class='linenumber'>3259</span>      * @param {Boolean} disabled &lt;code>true&lt;/code>이면 link diabled attribute를 diabled로 설정하고 
<span class='linenumber'>3260</span>      * _loaded property는 그대로 true로 유지한다.  
<span class='linenumber'>3261</span>      */</span><span class="WHIT">
<span class='linenumber'>3262</span> </span><span class="WHIT">    </span><span class="NAME">unload</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">disabled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3263</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isLoded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3264</span> </span><span class="WHIT">        </span><span class="NAME">this._css.unload</span><span class="PUNC">(</span><span class="NAME">disabled</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3265</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3266</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">disabled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3267</span> </span><span class="WHIT">        </span><span class="NAME">this._loaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3268</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3269</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3270</span> 
<span class='linenumber'>3271</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3272</span>      * theme이 로드되어 있는지 여부를 체크한다.
<span class='linenumber'>3273</span>      * @return {Boolean} theme 로드 여부
<span class='linenumber'>3274</span>      */</span><span class="WHIT">
<span class='linenumber'>3275</span> </span><span class="WHIT">    </span><span class="NAME">isLoded</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3276</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._loaded</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3277</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3278</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3279</span> </span><span class="WHIT">  </span><span class="WHIT">
<span class='linenumber'>3280</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.rt.ThemeManager */</span><span class="WHIT">
<span class='linenumber'>3281</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.ThemeManager'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3282</span> 
<span class='linenumber'>3283</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="COMM">/** @lends tau.rt.ThemeManager */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3284</span> </span><span class="WHIT">      </span><span class="NAME">DEFAUT_THEME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'default'</span><span class="WHIT">
<span class='linenumber'>3285</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3286</span> 
<span class='linenumber'>3287</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3288</span>      * @class
<span class='linenumber'>3289</span>      * default, app의theme을 등록하고, default, app의 theme을 변경해 주는 class.
<span class='linenumber'>3290</span>      * @constructs
<span class='linenumber'>3291</span>      * @param {String} themeName theme 텍스트
<span class='linenumber'>3292</span>      */</span><span class="WHIT">
<span class='linenumber'>3293</span> </span><span class="WHIT">    </span><span class="NAME">ThemeManager</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3294</span> </span><span class="WHIT">      </span><span class="COMM">/** @private Runtime instance */</span><span class="WHIT">
<span class='linenumber'>3295</span> </span><span class="WHIT">      </span><span class="NAME">this._rt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3296</span> </span><span class="WHIT">      </span><span class="COMM">/** @private supported themes */</span><span class="WHIT">
<span class='linenumber'>3297</span> </span><span class="WHIT">      </span><span class="NAME">this._themes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3298</span> </span><span class="WHIT">      </span><span class="NAME">this._currentTheme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3299</span> </span><span class="WHIT">      </span><span class="NAME">this._defaultThemeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3300</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3301</span> 
<span class='linenumber'>3302</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3303</span>      * default theme의 이름을 반환한다.
<span class='linenumber'>3304</span>      * @return {String} default theme 이름
<span class='linenumber'>3305</span>      * @private
<span class='linenumber'>3306</span>      */</span><span class="WHIT">
<span class='linenumber'>3307</span> </span><span class="WHIT">    </span><span class="NAME">_getDefaultThemeName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3308</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._defaultThemeName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3309</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._rt.isMultiApp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// multi app</span><span class="WHIT">
<span class='linenumber'>3310</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='linenumber'>3311</span> </span><span class="WHIT">              </span><span class="NAME">storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.createStorageCtx</span><span class="PUNC">(</span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3312</span> </span><span class="WHIT">              </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.getModuleConfig</span><span class="PUNC">(</span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3313</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">storageCtx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3314</span> </span><span class="WHIT">              </span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">storageCtx.get</span><span class="PUNC">(</span><span class="STRN">'$theme'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3315</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3316</span> </span><span class="WHIT">          </span><span class="NAME">this._defaultThemeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">config.theme</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3317</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3318</span> </span><span class="WHIT">        </span><span class="NAME">this._defaultThemeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._defaultThemeName</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">tau.rt.ThemeManager.DEFAUT_THEME</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3319</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3320</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._defaultThemeName</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3321</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3322</span> 
<span class='linenumber'>3323</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3324</span>      * application의 theme의 이름을 반환한다.
<span class='linenumber'>3325</span>      * @param {Object} config application의 configuration object
<span class='linenumber'>3326</span>      * @return {String} theme 이름
<span class='linenumber'>3327</span>      * @private
<span class='linenumber'>3328</span>      */</span><span class="WHIT">
<span class='linenumber'>3329</span> </span><span class="WHIT">    </span><span class="NAME">_getThemeName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3330</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.createStorageCtx</span><span class="PUNC">(</span><span class="NAME">config.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3331</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">storageCtx.get</span><span class="PUNC">(</span><span class="STRN">'$theme'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">config.theme</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._getDefaultThemeName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3332</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3333</span> 
<span class='linenumber'>3334</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3335</span>      * {@link tau.rt.Theme} instance를 반환한다.
<span class='linenumber'>3336</span>      * &lt;p/>
<span class='linenumber'>3337</span>      * 키에 해당하는 {@link tau.rt.Theme} instance가 존재하지 않은 경우에는
<span class='linenumber'>3338</span>      * {@link tau.rt.Theme} instance을 생성해서 반환한다.
<span class='linenumber'>3339</span>      * @param {String} themeName theme 객체를 가져오기 위한 theme 이름
<span class='linenumber'>3340</span>      * @return {tau.rt.Theme} theme {@link tau.rt.Theme} instance
<span class='linenumber'>3341</span>      * @private
<span class='linenumber'>3342</span>      */</span><span class="WHIT">
<span class='linenumber'>3343</span> </span><span class="WHIT">    </span><span class="NAME">_getTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3344</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3345</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3346</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3347</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._themes.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3348</span> </span><span class="WHIT">        </span><span class="NAME">this._themes</span><span class="PUNC">[</span><span class="NAME">themeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.rt.Theme</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3349</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3350</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._themes</span><span class="PUNC">[</span><span class="NAME">themeName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3351</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3352</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3353</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3354</span>      * application의 theme의 이름을 설정하고 
<span class='linenumber'>3355</span>      * 새로운 theme을 로드하고 이전에 적용되어 있는 theme을 언로드한다.
<span class='linenumber'>3356</span>      * @param {Object} config application의 configuration object
<span class='linenumber'>3357</span>      * @param {String} themeName 설정할 theme 이름
<span class='linenumber'>3358</span>      */</span><span class="WHIT">
<span class='linenumber'>3359</span> </span><span class="WHIT">    </span><span class="NAME">setTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3360</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">manager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3361</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>3362</span> </span><span class="WHIT">      </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">themeloaded</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3363</span> </span><span class="WHIT">        </span><span class="NAME">this.loadTheme</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">config</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3364</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.createStorageCtx</span><span class="PUNC">(</span><span class="NAME">config.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3365</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">storageCtx</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3366</span> </span><span class="WHIT">          </span><span class="NAME">storageCtx.set</span><span class="PUNC">(</span><span class="STRN">'$theme'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3367</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3368</span> </span><span class="WHIT">        </span><span class="NAME">this._rt.unsubscribeEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_LOADED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeloaded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3369</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3370</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>3371</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.register</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3372</span> </span><span class="WHIT">        </span><span class="NAME">themeloaded.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3373</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3374</span> </span><span class="WHIT">        </span><span class="NAME">this._rt.onEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_LOADED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeloaded</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">manager</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3375</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3376</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3377</span> 
<span class='linenumber'>3378</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3379</span>      * default {tau.rt.Theme}의 이름을 설정하고, 
<span class='linenumber'>3380</span>      * 현재 application이 default theme으로 설정되어 있는 경우
<span class='linenumber'>3381</span>      * default {tau.rt.Theme}을 load하고 이전에 적용되어 있는 {tau.rt.Theme}은 언로드한다.
<span class='linenumber'>3382</span>      * @param {String} themeName 설정할 theme 이름
<span class='linenumber'>3383</span>      */</span><span class="WHIT">
<span class='linenumber'>3384</span> </span><span class="WHIT">    </span><span class="NAME">setDefaultTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3385</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3386</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>3387</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this._defaultThemeName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3388</span> </span><span class="WHIT">        </span><span class="NAME">this._defaultThemeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3389</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>3390</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._rt.isMultiApp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// multi app</span><span class="WHIT">
<span class='linenumber'>3391</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.createStorageCtx</span><span class="PUNC">(</span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3392</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3393</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3394</span> </span><span class="WHIT">            </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3395</span> </span><span class="WHIT">            </span><span class="WHIT">
<span class='linenumber'>3396</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">storageCtx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3397</span> </span><span class="WHIT">              </span><span class="NAME">storageCtx.set</span><span class="PUNC">(</span><span class="STRN">'$theme'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3398</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3399</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._getThemeName</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3400</span> </span><span class="WHIT">              </span><span class="NAME">this.loadTheme</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3401</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3402</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3403</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// single app</span><span class="WHIT">
<span class='linenumber'>3404</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3405</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3406</span> </span><span class="WHIT">            </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3407</span> </span><span class="WHIT">            </span><span class="NAME">this.setTheme</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3408</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3409</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3410</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3411</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3412</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3413</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3414</span>      * application에 설정된 theme을 등록한다.
<span class='linenumber'>3415</span>      * @param {Object} config application의 configuration object
<span class='linenumber'>3416</span>      * @param {String} themeName 등록할 theme 이름
<span class='linenumber'>3417</span>      */</span><span class="WHIT">
<span class='linenumber'>3418</span> </span><span class="WHIT">    </span><span class="NAME">register</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3419</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">theme</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">manager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3420</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isUndefined</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3421</span> </span><span class="WHIT">        </span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getThemeName</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3422</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3423</span> </span><span class="WHIT">      </span><span class="NAME">theme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getTheme</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3424</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">theme</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3425</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">theme.isLoded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3426</span> </span><span class="WHIT">          </span><span class="NAME">theme.load</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3427</span> </span><span class="WHIT">            </span><span class="NAME">manager._rt.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_LOADED</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3428</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3429</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3430</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3431</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3432</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3433</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3434</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3435</span> </span><span class="WHIT">    </span><span class="NAME">unregister</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3436</span> </span><span class="WHIT">      </span><span class="COMM">//TODO</span><span class="WHIT">
<span class='linenumber'>3437</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3438</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3439</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3440</span>      * 새로운 theme을 로드하고 이전에 적용되어 있는 theme은 언로드한다.
<span class='linenumber'>3441</span>      * &lt;p/>
<span class='linenumber'>3442</span>      * themeName이 없는 경우에는 현재 application에 설정되어 있는 theme을 로드한다.
<span class='linenumber'>3443</span>      * @param {Object} opts 
<span class='linenumber'>3444</span>      * @param {Object} [opts.config] Module config
<span class='linenumber'>3445</span>      * @param {String} [opts.themeName] Loading할 theme 이름
<span class='linenumber'>3446</span>      * @param {tau.rt.Module} [opts.module] 
<span class='linenumber'>3447</span>      */</span><span class="WHIT">
<span class='linenumber'>3448</span> </span><span class="WHIT">    </span><span class="NAME">loadTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3449</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">manager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3450</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">themeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">newTheme</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3451</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>3452</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3453</span> </span><span class="WHIT">        </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">opts.config</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3454</span> </span><span class="WHIT">        </span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">opts.themeName</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3455</span> </span><span class="WHIT">        </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">opts.module</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3456</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3457</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>3458</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3459</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3460</span> </span><span class="WHIT">          </span><span class="NAME">module</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">manager._rt.getModule</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3461</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3462</span> </span><span class="WHIT">            </span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">module.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3463</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3464</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3465</span> </span><span class="WHIT">        </span><span class="NAME">themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getThemeName</span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3466</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3467</span> </span><span class="WHIT">      </span><span class="WHIT">
<span class='linenumber'>3468</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3469</span> </span><span class="WHIT">        </span><span class="NAME">newTheme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getTheme</span><span class="PUNC">(</span><span class="NAME">themeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3470</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>3471</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">newTheme</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3472</span> </span><span class="WHIT">          </span><span class="NAME">newTheme.load</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3473</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">manager._currentTheme</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">manager._currentTheme</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">newTheme</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3474</span> </span><span class="WHIT">              </span><span class="NAME">manager._currentTheme.unload</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3475</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3476</span> </span><span class="WHIT">            </span><span class="NAME">manager._currentTheme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newTheme</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3477</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3478</span> </span><span class="WHIT">              </span><span class="NAME">module.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_ENABLED</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3479</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3480</span> </span><span class="WHIT">              </span><span class="NAME">manager._rt.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_ENABLED</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3481</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3482</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3483</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3484</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3485</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3486</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3487</span> </span><span class="WHIT">        </span><span class="NAME">module.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_ENABLED</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3488</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3489</span> </span><span class="WHIT">        </span><span class="NAME">manager._rt.fireEvent</span><span class="PUNC">(</span><span class="NAME">tau.rt.Event.RT_THEME_ENABLED</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3490</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3491</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3492</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3493</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3494</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3495</span>      * appplication에 적용되어 있는 theme을 언로드한다.
<span class='linenumber'>3496</span>      * &lt;p/>
<span class='linenumber'>3497</span>      * @param {Object} config application의 configuration object
<span class='linenumber'>3498</span>      */</span><span class="WHIT">
<span class='linenumber'>3499</span> </span><span class="WHIT">    </span><span class="NAME">unloadTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3500</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">theme</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">defaultTheme</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3501</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3502</span> </span><span class="WHIT">        </span><span class="NAME">theme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getTheme</span><span class="PUNC">(</span><span class="NAME">config.theme</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3503</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">theme</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3504</span> </span><span class="WHIT">          </span><span class="NAME">defaultTheme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getTheme</span><span class="PUNC">(</span><span class="NAME">this._getDefaultThemeName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3505</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">defaultTheme</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">defaultTheme.load</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3506</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3507</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3508</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3509</span> 
<span class='linenumber'>3510</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3511</span>      * appplication의 config에 적용되어 있는 theme으로 초기화한다.
<span class='linenumber'>3512</span>      * &lt;p/>
<span class='linenumber'>3513</span>      * @param {Object} config application의 configuration object
<span class='linenumber'>3514</span>      */</span><span class="WHIT">
<span class='linenumber'>3515</span> </span><span class="WHIT">    </span><span class="NAME">resetTheme</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3516</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">storageCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rt.createStorageCtx</span><span class="PUNC">(</span><span class="NAME">config.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3517</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">storageCtx</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3518</span> </span><span class="WHIT">        </span><span class="NAME">storageCtx.remove</span><span class="PUNC">(</span><span class="STRN">'$theme'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3519</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3520</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">config.name</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'$dashboard'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3521</span> </span><span class="WHIT">        </span><span class="NAME">this._defaultThemeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3522</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3523</span> </span><span class="WHIT">      </span><span class="NAME">this.loadTheme</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">config</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">config</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3524</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3525</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3526</span> 
<span class='linenumber'>3527</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>3528</span>    * This class defines methods required to mimic clipboard operations
<span class='linenumber'>3529</span>    *  @lends tau.ui.TableSceneController
<span class='linenumber'>3530</span>    */</span><span class="WHIT">
<span class='linenumber'>3531</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.rt.Clipboard'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3532</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3533</span>      * Instantiate new Clipboard object. Usually this object maintained by 
<span class='linenumber'>3534</span>      * Runtime object
<span class='linenumber'>3535</span>      * @class
<span class='linenumber'>3536</span>      */</span><span class="WHIT">
<span class='linenumber'>3537</span> </span><span class="WHIT">    </span><span class="NAME">Clipboard</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3538</span> </span><span class="WHIT">      </span><span class="NAME">this._buf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3539</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3540</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3541</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3542</span>      * Cut the specified node from the html DOM tree and holds it's reference
<span class='linenumber'>3543</span>      * in the clipboad object using specified key. Usually the key is the id of
<span class='linenumber'>3544</span>      * specified node
<span class='linenumber'>3545</span>      * @param {String} key the key string to be used to identify the dom
<span class='linenumber'>3546</span>      * @param {Node} node DOM node to be cut from HTML DOM tree
<span class='linenumber'>3547</span>      */</span><span class="WHIT">
<span class='linenumber'>3548</span> </span><span class="WHIT">    </span><span class="NAME">cut</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">node</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3549</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">node.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3550</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3551</span> </span><span class="WHIT">          </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">node.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.genId</span><span class="PUNC">(</span><span class="STRN">'clip'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3552</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3553</span> </span><span class="WHIT">        </span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">node.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3554</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3555</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3556</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3557</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3558</span>      * Paste DOM node identified by the key as a child of specified container
<span class='linenumber'>3559</span>      * node.
<span class='linenumber'>3560</span>      * @param {String} key the key string to be used to identify the dom
<span class='linenumber'>3561</span>      * @param {Node} container Parent DOM node to where the node specified by
<span class='linenumber'>3562</span>      * the key is appended.
<span class='linenumber'>3563</span>      */</span><span class="WHIT">
<span class='linenumber'>3564</span> </span><span class="WHIT">    </span><span class="NAME">paste</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">container</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3565</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3566</span> </span><span class="WHIT">        </span><span class="NAME">container.appendChild</span><span class="PUNC">(</span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3567</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3568</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3569</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3570</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3571</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3572</span>      * Removes node specifified by the key from the clipboard object.
<span class='linenumber'>3573</span>      * @param {String } key the key string to be used to identify the dom
<span class='linenumber'>3574</span>      */</span><span class="WHIT">
<span class='linenumber'>3575</span> </span><span class="WHIT">    </span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3576</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3577</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3578</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3579</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3580</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='linenumber'>3581</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3582</span>      * Removes all the DOM nodes maintained by this clipboard object
<span class='linenumber'>3583</span>      */</span><span class="WHIT">
<span class='linenumber'>3584</span> </span><span class="WHIT">    </span><span class="NAME">clear</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3585</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._buf</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3586</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">buf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3587</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">buf.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3588</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._buf</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">          </span><span class="WHIT">
<span class='linenumber'>3589</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3590</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3591</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3592</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3593</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3594</span> </span></pre></body></html>